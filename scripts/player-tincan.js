 
"0.50.0";
var CryptoJS=CryptoJS||function(e,a){var b={},c=b.lib={},d=function(){},f=c.Base={extend:function(a){d.prototype=this;var b=new d;return a&&b.mixIn(a),b.hasOwnProperty("init")||(b.init=function(){b.$super.init.apply(this,arguments)}),b.init.prototype=b,b.$super=this,b},create:function(){var a=this.extend();return a.init.apply(a,arguments),a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},g=
c.WordArray=f.extend({init:function(b,c){b=this.words=b||[];this.sigBytes=c!=a?c:4*b.length},toString:function(a){return(a||l).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes;if(a=a.sigBytes,this.clamp(),d%4)for(var f=0;f<a;f++)b[d+f>>>2]|=(c[f>>>2]>>>24-f%4*8&255)<<24-(d+f)%4*8;else if(65535<c.length)for(f=0;f<a;f+=4)b[d+f>>>2]=c[f>>>2];else b.push.apply(b,c);return this.sigBytes+=a,this},clamp:function(){var a=this.words,b=this.sigBytes;a[b>>>2]&=4294967295<<32-b%
4*8;a.length=e.ceil(b/4)},clone:function(){var a=f.clone.call(this);return a.words=this.words.slice(0),a},random:function(a){for(var b=[],c=0;c<a;c+=4)b.push(4294967296*e.random()|0);return new g.init(b,a)}}),k=b.enc={},l=k.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++){var f=b[d>>>2]>>>24-d%4*8&255;c.push((f>>>4).toString(16));c.push((15&f).toString(16))}return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<
24-d%8*4;return new g.init(c,b/2)}},m=k.Latin1={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++)c.push(String.fromCharCode(b[d>>>2]>>>24-d%4*8&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d++)c[d>>>2]|=(255&a.charCodeAt(d))<<24-d%4*8;return new g.init(c,b)}},q=k.Utf8={stringify:function(a){try{return decodeURIComponent(escape(m.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data");}},parse:function(a){return m.parse(unescape(encodeURIComponent(a)))}},
u=c.BufferedBlockAlgorithm=f.extend({reset:function(){this._data=new g.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=q.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var b=this._data,c=b.words,d=b.sigBytes,f=this.blockSize,k=d/(4*f),k=a?e.ceil(k):e.max((0|k)-this._minBufferSize,0);if(a=k*f,d=e.min(4*a,d),a){for(var l=0;l<a;l+=f)this._doProcessBlock(c,l);l=c.splice(0,a);b.sigBytes-=d}return new g.init(l,d)},clone:function(){var a=f.clone.call(this);
return a._data=this._data.clone(),a},_minBufferSize:0});c.Hasher=u.extend({cfg:f.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){u.reset.call(this);this._doReset()},update:function(a){return this._append(a),this._process(),this},finalize:function(a){return a&&this._append(a),this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return(new a.init(c)).finalize(b)}},_createHmacHelper:function(a){return function(b,c){return(new t.HMAC.init(a,
c)).finalize(b)}}});var t=b.algo={};return b}(Math);
!function(){var e=CryptoJS,a=e.lib,b=a.WordArray,c=a.Hasher,d=[],a=e.algo.SHA1=c.extend({_doReset:function(){this._hash=new b.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(a,b){for(var c=this._hash.words,e=c[0],m=c[1],q=c[2],u=c[3],t=c[4],w=0;80>w;w++){if(16>w)d[w]=0|a[b+w];else{var A=d[w-3]^d[w-8]^d[w-14]^d[w-16];d[w]=A<<1|A>>>31}A=(e<<5|e>>>27)+t+d[w];A=20>w?A+((m&q|~m&u)+1518500249):40>w?A+((m^q^u)+1859775393):60>w?A+((m&q|m&u|q&u)-1894007588):A+((m^q^
u)-899497514);t=u;u=q;q=m<<30|m>>>2;m=e;e=A}c[0]=c[0]+e|0;c[1]=c[1]+m|0;c[2]=c[2]+q|0;c[3]=c[3]+u|0;c[4]=c[4]+t|0},_doFinalize:function(){var a=this._data,b=a.words,c=8*this._nDataBytes,d=8*a.sigBytes;return b[d>>>5]|=128<<24-d%32,b[(d+64>>>9<<4)+14]=Math.floor(c/4294967296),b[(d+64>>>9<<4)+15]=c,a.sigBytes=4*b.length,this._process(),this._hash},clone:function(){var a=c.clone.call(this);return a._hash=this._hash.clone(),a}});e.SHA1=c._createHelper(a);e.HmacSHA1=c._createHmacHelper(a)}();
CryptoJS=CryptoJS||function(e,a){var b={},c=b.lib={},d=function(){},f=c.Base={extend:function(a){d.prototype=this;var b=new d;return a&&b.mixIn(a),b.hasOwnProperty("init")||(b.init=function(){b.$super.init.apply(this,arguments)}),b.init.prototype=b,b.$super=this,b},create:function(){var a=this.extend();return a.init.apply(a,arguments),a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},
g=c.WordArray=f.extend({init:function(b,c){b=this.words=b||[];this.sigBytes=c!=a?c:4*b.length},toString:function(a){return(a||l).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes;if(a=a.sigBytes,this.clamp(),d%4)for(var f=0;f<a;f++)b[d+f>>>2]|=(c[f>>>2]>>>24-f%4*8&255)<<24-(d+f)%4*8;else if(65535<c.length)for(f=0;f<a;f+=4)b[d+f>>>2]=c[f>>>2];else b.push.apply(b,c);return this.sigBytes+=a,this},clamp:function(){var a=this.words,b=this.sigBytes;a[b>>>2]&=4294967295<<32-
b%4*8;a.length=e.ceil(b/4)},clone:function(){var a=f.clone.call(this);return a.words=this.words.slice(0),a},random:function(a){for(var b=[],c=0;c<a;c+=4)b.push(4294967296*e.random()|0);return new g.init(b,a)}}),k=b.enc={},l=k.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++){var f=b[d>>>2]>>>24-d%4*8&255;c.push((f>>>4).toString(16));c.push((15&f).toString(16))}return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<
24-d%8*4;return new g.init(c,b/2)}},m=k.Latin1={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++)c.push(String.fromCharCode(b[d>>>2]>>>24-d%4*8&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d++)c[d>>>2]|=(255&a.charCodeAt(d))<<24-d%4*8;return new g.init(c,b)}},q=k.Utf8={stringify:function(a){try{return decodeURIComponent(escape(m.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data");}},parse:function(a){return m.parse(unescape(encodeURIComponent(a)))}},
u=c.BufferedBlockAlgorithm=f.extend({reset:function(){this._data=new g.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=q.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var b=this._data,c=b.words,d=b.sigBytes,f=this.blockSize,k=d/(4*f),k=a?e.ceil(k):e.max((0|k)-this._minBufferSize,0);if(a=k*f,d=e.min(4*a,d),a){for(var l=0;l<a;l+=f)this._doProcessBlock(c,l);l=c.splice(0,a);b.sigBytes-=d}return new g.init(l,d)},clone:function(){var a=f.clone.call(this);
return a._data=this._data.clone(),a},_minBufferSize:0});c.Hasher=u.extend({cfg:f.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){u.reset.call(this);this._doReset()},update:function(a){return this._append(a),this._process(),this},finalize:function(a){return a&&this._append(a),this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return(new a.init(c)).finalize(b)}},_createHmacHelper:function(a){return function(b,c){return(new t.HMAC.init(a,
c)).finalize(b)}}});var t=b.algo={};return b}(Math);
!function(e){for(var a=CryptoJS,b=a.lib,c=b.WordArray,d=b.Hasher,b=a.algo,f=[],g=[],k=function(a){return 4294967296*(a-(0|a))|0},l=2,m=0;64>m;){var q;a:{q=l;for(var u=e.sqrt(q),t=2;t<=u;t++)if(!(q%t)){q=!1;break a}q=!0}q&&(8>m&&(f[m]=k(e.pow(l,.5))),g[m]=k(e.pow(l,1/3)),m++);l++}var w=[],b=b.SHA256=d.extend({_doReset:function(){this._hash=new c.init(f.slice(0))},_doProcessBlock:function(a,b){for(var c=this._hash.words,d=c[0],f=c[1],e=c[2],k=c[3],l=c[4],q=c[5],m=c[6],u=c[7],t=0;64>t;t++){if(16>t)w[t]=
0|a[b+t];else{var D=w[t-15],v=w[t-2];w[t]=((D<<25|D>>>7)^(D<<14|D>>>18)^D>>>3)+w[t-7]+((v<<15|v>>>17)^(v<<13|v>>>19)^v>>>10)+w[t-16]}D=u+((l<<26|l>>>6)^(l<<21|l>>>11)^(l<<7|l>>>25))+(l&q^~l&m)+g[t]+w[t];v=((d<<30|d>>>2)^(d<<19|d>>>13)^(d<<10|d>>>22))+(d&f^d&e^f&e);u=m;m=q;q=l;l=k+D|0;k=e;e=f;f=d;d=D+v|0}c[0]=c[0]+d|0;c[1]=c[1]+f|0;c[2]=c[2]+e|0;c[3]=c[3]+k|0;c[4]=c[4]+l|0;c[5]=c[5]+q|0;c[6]=c[6]+m|0;c[7]=c[7]+u|0},_doFinalize:function(){var a=this._data,b=a.words,c=8*this._nDataBytes,d=8*a.sigBytes;
return b[d>>>5]|=128<<24-d%32,b[(d+64>>>9<<4)+14]=e.floor(c/4294967296),b[(d+64>>>9<<4)+15]=c,a.sigBytes=4*b.length,this._process(),this._hash},clone:function(){var a=d.clone.call(this);return a._hash=this._hash.clone(),a}});a.SHA256=d._createHelper(b);a.HmacSHA256=d._createHmacHelper(b)}(Math);
(function(){var e=CryptoJS,a=e.lib.WordArray;e.enc.Base64={stringify:function(a){var c=a.words,d=a.sigBytes,f=this._map;a.clamp();a=[];for(var g=0;g<d;g+=3)for(var e=(c[g>>>2]>>>24-g%4*8&255)<<16|(c[g+1>>>2]>>>24-(g+1)%4*8&255)<<8|c[g+2>>>2]>>>24-(g+2)%4*8&255,l=0;4>l&&g+.75*l<d;l++)a.push(f.charAt(e>>>6*(3-l)&63));if(c=f.charAt(64))for(;a.length%4;)a.push(c);return a.join("")},parse:function(b){var c=b.length,d=this._map,f=d.charAt(64);f&&(f=b.indexOf(f),-1!=f&&(c=f));for(var f=[],g=0,e=0;e<c;e++)if(e%
4){var l=d.indexOf(b.charAt(e-1))<<e%4*2,m=d.indexOf(b.charAt(e))>>>6-e%4*2;f[g>>>2]|=(l|m)<<24-g%4*8;g++}return a.create(f,g)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"}})();
(function(){if("function"==typeof ArrayBuffer){var e=CryptoJS.lib.WordArray,a=e.init;(e.init=function(b){if(b instanceof ArrayBuffer&&(b=new Uint8Array(b)),(b instanceof Int8Array||b instanceof Uint8ClampedArray||b instanceof Int16Array||b instanceof Uint16Array||b instanceof Int32Array||b instanceof Uint32Array||b instanceof Float32Array||b instanceof Float64Array)&&(b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength)),b instanceof Uint8Array){for(var c=b.byteLength,d=[],f=0;f<c;f++)d[f>>>2]|=b[f]<<
24-f%4*8;a.call(this,d,c)}else a.apply(this,arguments)}).prototype=e}})();var TinCan;
!function(){var e={statementId:!0,voidedStatementId:!0,verb:!0,object:!0,registration:!0,context:!0,actor:!0,since:!0,until:!0,limit:!0,authoritative:!0,sparse:!0,instructor:!0,ascending:!0,continueToken:!0,agent:!0,activityId:!0,stateId:!0,profileId:!0,activity_platform:!0,grouping:!0,"Accept-Language":!0};TinCan=function(a){this.log("constructor");this.recordStores=[];this.context=this.registration=this.activity=this.actor=null;this.init(a)};TinCan.prototype={LOG_SRC:"TinCan",log:function(a,b){},
init:function(a){this.log("init");var b;if(a=a||{},a.hasOwnProperty("url")&&""!==a.url&&this._initFromQueryString(a.url),a.hasOwnProperty("recordStores")&&void 0!==a.recordStores)for(b=0;b<a.recordStores.length;b+=1)this.addRecordStore(a.recordStores[b]);a.hasOwnProperty("activity")&&(a.activity instanceof TinCan.Activity?this.activity=a.activity:this.activity=new TinCan.Activity(a.activity));a.hasOwnProperty("actor")&&(a.actor instanceof TinCan.Agent?this.actor=a.actor:this.actor=new TinCan.Agent(a.actor));
a.hasOwnProperty("context")&&(a.context instanceof TinCan.Context?this.context=a.context:this.context=new TinCan.Context(a.context));a.hasOwnProperty("registration")&&(this.registration=a.registration)},_initFromQueryString:function(a){this.log("_initFromQueryString");var b,c;a=TinCan.Utils.parseURL(a).params;var d=["endpoint","auth"],f={},g=null;if(a.hasOwnProperty("actor")){this.log("_initFromQueryString - found actor: "+a.actor);try{this.actor=TinCan.Agent.fromJSON(a.actor),delete a.actor}catch(k){this.log("_initFromQueryString - failed to set actor: "+
k)}}if(a.hasOwnProperty("activity_id")&&(this.activity=new TinCan.Activity({id:a.activity_id}),delete a.activity_id),(a.hasOwnProperty("activity_platform")||a.hasOwnProperty("registration")||a.hasOwnProperty("grouping"))&&(b={},a.hasOwnProperty("activity_platform")&&(b.platform=a.activity_platform,delete a.activity_platform),a.hasOwnProperty("registration")&&(b.registration=this.registration=a.registration,delete a.registration),a.hasOwnProperty("grouping")&&(b.contextActivities={},b.contextActivities.grouping=
a.grouping,delete a.grouping),this.context=new TinCan.Context(b)),a.hasOwnProperty("endpoint")){for(b=0;b<d.length;b+=1)c=d[b],a.hasOwnProperty(c)&&(f[c]=a[c],delete a[c]);for(b in a)a.hasOwnProperty(b)&&(e.hasOwnProperty(b)?delete a[b]:(g=g||{},g[b]=a[b]));null!==g&&(f.extended=g);f.allowFail=!1;this.addRecordStore(f)}},addRecordStore:function(a){this.log("addRecordStore");a=a instanceof TinCan.LRS?a:new TinCan.LRS(a);this.recordStores.push(a)},prepareStatement:function(a){return this.log("prepareStatement"),
a instanceof TinCan.Statement||(a=new TinCan.Statement(a)),null===a.actor&&null!==this.actor&&(a.actor=this.actor),null===a.target&&null!==this.activity&&(a.target=this.activity),null!==this.context&&(null===a.context?a.context=this.context:(null===a.context.registration&&(a.context.registration=this.context.registration),null===a.context.platform&&(a.context.platform=this.context.platform),null!==this.context.contextActivities&&(null===a.context.contextActivities?a.context.contextActivities=this.context.contextActivities:
(null!==this.context.contextActivities.grouping&&null===a.context.contextActivities.grouping&&(a.context.contextActivities.grouping=this.context.contextActivities.grouping),null!==this.context.contextActivities.parent&&null===a.context.contextActivities.parent&&(a.context.contextActivities.parent=this.context.contextActivities.parent),null!==this.context.contextActivities.other&&null===a.context.contextActivities.other&&(a.context.contextActivities.other=this.context.contextActivities.other))))),
a},sendStatement:function(a,b){this.log("sendStatement");var c,d,f=this,g=this.prepareStatement(a),e=this.recordStores.length,l=[],m=[];if(0<e)for("function"==typeof b&&(d=function(a,c){var d;f.log("sendStatement - callbackWrapper: "+e);1<e?(--e,m.push({err:a,xhr:c})):1===e?(m.push({err:a,xhr:c}),d=[m,g],b.apply(this,d)):f.log("sendStatement - unexpected record store count: "+e)}),c=0;c<e;c+=1)a=this.recordStores[c],l.push(a.saveStatement(g,{callback:d}));else this.log("[warning] sendStatement: No LRSs added yet (statement not sent)"),
"function"==typeof b&&b.apply(this,[null,g]);return{statement:g,results:l}},getStatement:function(a,b,c){this.log("getStatement");var d;return c=c||{},c.params=c.params||{},0<this.recordStores.length?(d=this.recordStores[0],d.retrieveStatement(a,{callback:b,params:c.params})):void this.log("[warning] getStatement: No LRSs added yet (statement not retrieved)")},voidStatement:function(a,b,c){this.log("voidStatement");var d,f,e,k=this,l=this.recordStores.length,m=[],q=[];if(a instanceof TinCan.Statement&&
(a=a.id),"undefined"!=typeof c.actor?d=c.actor:null!==this.actor&&(d=this.actor),f=new TinCan.Statement({actor:d,verb:{id:"http://adlnet.gov/expapi/verbs/voided"},target:{objectType:"StatementRef",id:a}}),0<l)for("function"==typeof b&&(e=function(a,c){var d;k.log("voidStatement - callbackWrapper: "+l);1<l?(--l,q.push({err:a,xhr:c})):1===l?(q.push({err:a,xhr:c}),d=[q,f],b.apply(this,d)):k.log("voidStatement - unexpected record store count: "+l)}),c=0;c<l;c+=1)a=this.recordStores[c],m.push(a.saveStatement(f,
{callback:e}));else this.log("[warning] voidStatement: No LRSs added yet (statement not sent)"),"function"==typeof b&&b.apply(this,[null,f]);return{statement:f,results:m}},getVoidedStatement:function(a,b){this.log("getVoidedStatement");var c;return 0<this.recordStores.length?(c=this.recordStores[0],c.retrieveVoidedStatement(a,{callback:b})):void this.log("[warning] getVoidedStatement: No LRSs added yet (statement not retrieved)")},sendStatements:function(a,b){this.log("sendStatements");var c,d,f=
this,e=[],k=this.recordStores.length,l=[],m=[];if(0===a.length)"function"==typeof b&&b.apply(this,[null,e]);else{for(c=0;c<a.length;c+=1)e.push(this.prepareStatement(a[c]));if(0<k)for("function"==typeof b&&(d=function(a,c){var d;f.log("sendStatements - callbackWrapper: "+k);1<k?(--k,m.push({err:a,xhr:c})):1===k?(m.push({err:a,xhr:c}),d=[m,e],b.apply(this,d)):f.log("sendStatements - unexpected record store count: "+k)}),c=0;c<k;c+=1)a=this.recordStores[c],l.push(a.saveStatements(e,{callback:d}));else this.log("[warning] sendStatements: No LRSs added yet (statements not sent)"),
"function"==typeof b&&b.apply(this,[null,e])}return{statements:e,results:l}},getStatements:function(a){this.log("getStatements");var b,c,d={};return 0<this.recordStores.length?(b=this.recordStores[0],a=a||{},c=a.params||{},a.sendActor&&null!==this.actor&&("0.9"===b.version||"0.95"===b.version?c.actor=this.actor:c.agent=this.actor),a.sendActivity&&null!==this.activity&&("0.9"===b.version||"0.95"===b.version?c.target=this.activity:c.activity=this.activity),"undefined"==typeof c.registration&&null!==
this.registration&&(c.registration=this.registration),d={params:c},"undefined"!=typeof a.callback&&(d.callback=a.callback),b.queryStatements(d)):void this.log("[warning] getStatements: No LRSs added yet (statements not read)")},getState:function(a,b){this.log("getState");var c,d;return 0<this.recordStores.length?(d=this.recordStores[0],b=b||{},c={agent:"undefined"!=typeof b.agent?b.agent:this.actor,activity:"undefined"!=typeof b.activity?b.activity:this.activity},"undefined"!=typeof b.registration?
c.registration=b.registration:null!==this.registration&&(c.registration=this.registration),"undefined"!=typeof b.callback&&(c.callback=b.callback),d.retrieveState(a,c)):void this.log("[warning] getState: No LRSs added yet (state not retrieved)")},setState:function(a,b,c){this.log("setState");var d,f;return 0<this.recordStores.length?(f=this.recordStores[0],c=c||{},d={agent:"undefined"!=typeof c.agent?c.agent:this.actor,activity:"undefined"!=typeof c.activity?c.activity:this.activity},"undefined"!=
typeof c.registration?d.registration=c.registration:null!==this.registration&&(d.registration=this.registration),"undefined"!=typeof c.lastSHA1&&(d.lastSHA1=c.lastSHA1),"undefined"!=typeof c.contentType&&(d.contentType=c.contentType,"undefined"!=typeof c.overwriteJSON&&!c.overwriteJSON&&TinCan.Utils.isApplicationJSON(c.contentType)&&(d.method="POST")),"undefined"!=typeof c.callback&&(d.callback=c.callback),f.saveState(a,b,d)):void this.log("[warning] setState: No LRSs added yet (state not saved)")},
deleteState:function(a,b){this.log("deleteState");var c,d;return 0<this.recordStores.length?(d=this.recordStores[0],b=b||{},c={agent:"undefined"!=typeof b.agent?b.agent:this.actor,activity:"undefined"!=typeof b.activity?b.activity:this.activity},"undefined"!=typeof b.registration?c.registration=b.registration:null!==this.registration&&(c.registration=this.registration),"undefined"!=typeof b.callback&&(c.callback=b.callback),d.dropState(a,c)):void this.log("[warning] deleteState: No LRSs added yet (state not deleted)")},
getActivityProfile:function(a,b){this.log("getActivityProfile");var c,d;return 0<this.recordStores.length?(d=this.recordStores[0],b=b||{},c={activity:"undefined"!=typeof b.activity?b.activity:this.activity},"undefined"!=typeof b.callback&&(c.callback=b.callback),d.retrieveActivityProfile(a,c)):void this.log("[warning] getActivityProfile: No LRSs added yet (activity profile not retrieved)")},setActivityProfile:function(a,b,c){this.log("setActivityProfile");var d,f;return 0<this.recordStores.length?
(f=this.recordStores[0],c=c||{},d={activity:"undefined"!=typeof c.activity?c.activity:this.activity},"undefined"!=typeof c.callback&&(d.callback=c.callback),"undefined"!=typeof c.lastSHA1&&(d.lastSHA1=c.lastSHA1),"undefined"!=typeof c.contentType&&(d.contentType=c.contentType,"undefined"!=typeof c.overwriteJSON&&!c.overwriteJSON&&TinCan.Utils.isApplicationJSON(c.contentType)&&(d.method="POST")),f.saveActivityProfile(a,b,d)):void this.log("[warning] setActivityProfile: No LRSs added yet (activity profile not saved)")},
deleteActivityProfile:function(a,b){this.log("deleteActivityProfile");var c,d;return 0<this.recordStores.length?(d=this.recordStores[0],b=b||{},c={activity:"undefined"!=typeof b.activity?b.activity:this.activity},"undefined"!=typeof b.callback&&(c.callback=b.callback),d.dropActivityProfile(a,c)):void this.log("[warning] deleteActivityProfile: No LRSs added yet (activity profile not deleted)")},getAgentProfile:function(a,b){this.log("getAgentProfile");var c,d;return 0<this.recordStores.length?(d=this.recordStores[0],
b=b||{},c={agent:"undefined"!=typeof b.agent?b.agent:this.actor},"undefined"!=typeof b.callback&&(c.callback=b.callback),d.retrieveAgentProfile(a,c)):void this.log("[warning] getAgentProfile: No LRSs added yet (agent profile not retrieved)")},setAgentProfile:function(a,b,c){this.log("setAgentProfile");var d,f;return 0<this.recordStores.length?(f=this.recordStores[0],c=c||{},d={agent:"undefined"!=typeof c.agent?c.agent:this.actor},"undefined"!=typeof c.callback&&(d.callback=c.callback),"undefined"!=
typeof c.lastSHA1&&(d.lastSHA1=c.lastSHA1),"undefined"!=typeof c.contentType&&(d.contentType=c.contentType,"undefined"!=typeof c.overwriteJSON&&!c.overwriteJSON&&TinCan.Utils.isApplicationJSON(c.contentType)&&(d.method="POST")),f.saveAgentProfile(a,b,d)):void this.log("[warning] setAgentProfile: No LRSs added yet (agent profile not saved)")},deleteAgentProfile:function(a,b){this.log("deleteAgentProfile");var c,d;return 0<this.recordStores.length?(d=this.recordStores[0],b=b||{},c={agent:"undefined"!=
typeof b.agent?b.agent:this.actor},"undefined"!=typeof b.callback&&(c.callback=b.callback),d.dropAgentProfile(a,c)):void this.log("[warning] deleteAgentProfile: No LRSs added yet (agent profile not deleted)")}};TinCan.DEBUG=!1;TinCan.enableDebug=function(){TinCan.DEBUG=!0};TinCan.disableDebug=function(){TinCan.DEBUG=!1};TinCan.versions=function(){return["1.0.2","1.0.1","1.0.0","0.95","0.9"]};"object"==typeof module&&(module.exports=TinCan)}();
(function(){TinCan.Utils={defaultEncoding:"utf8",getUUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var a=16*Math.random()|0;return("x"==e?a:3&a|8).toString(16)})},getISODateString:function(e){function a(a,c){var d;"undefined"!=typeof a&&null!==a||(a=0);"undefined"!=typeof c&&null!==c||(c=2);c=Math.pow(10,c-1);for(d=a.toString();a<c&&1<c;)d="0"+d,c/=10;return d}return e.getUTCFullYear()+"-"+a(e.getUTCMonth()+1)+"-"+a(e.getUTCDate())+"T"+a(e.getUTCHours())+
":"+a(e.getUTCMinutes())+":"+a(e.getUTCSeconds())+"."+a(e.getUTCMilliseconds(),3)+"Z"},convertISO8601DurationToMilliseconds:function(e){var a,b,c,d,f=0<=e.indexOf("-"),g=e.indexOf("T"),k=e.indexOf("H"),l=e.indexOf("M"),m=e.indexOf("S");if(-1===g||-1!==l&&l<g||-1!==e.indexOf("D")||-1!==e.indexOf("Y"))throw Error("ISO 8601 timestamps including years, months and/or days are not currently supported");return-1===k?(k=g,a=0):a=parseInt(e.slice(g+1,k),10),-1===l?(l=g,b=0):b=parseInt(e.slice(k+1,l),10),c=
parseFloat(e.slice(l+1,m)),d=parseInt(1E3*(60*(60*a+b)+c),10),isNaN(d)&&(d=0),f&&(d*=-1),d},convertMillisecondsToISO8601Duration:function(e){var a,b,c,d;e=parseInt(e,10);var f="",g="";return d=Math.round(e/10),0>d&&(f="-",d*=-1),a=parseInt(d/36E4,10),b=parseInt(d%36E4/6E3,10),c=d%36E4%6E3/100,g=f+"PT",0<a&&(g+=a+"H"),0<b&&(g+=b+"M"),g+(c+"S")},getSHA1String:function(e){return CryptoJS.SHA1(e).toString(CryptoJS.enc.Hex)},getSHA256String:function(e){return"[object ArrayBuffer]"===Object.prototype.toString.call(e)&&
(e=CryptoJS.lib.WordArray.create(e)),CryptoJS.SHA256(e).toString(CryptoJS.enc.Hex)},getBase64String:function(e){return CryptoJS.enc.Base64.stringify(CryptoJS.enc.Latin1.parse(e))},getLangDictionaryValue:function(e,a){var b;e=this[e];if("undefined"!=typeof a&&"undefined"!=typeof e[a])return e[a];if("undefined"!=typeof e.und)return e.und;if("undefined"!=typeof e["en-US"])return e["en-US"];for(b in e)if(e.hasOwnProperty(b))return e[b];return""},parseURL:function(e,a){var b,c,d,f="/"===e.charAt(0),g=
["(/[^?#]*)","(\\?[^#]*|)","(#.*|)$"],k=/\+/g,l=/([^&=]+)=?([^&]*)/g;if(a=a||{},f){if("undefined"==typeof a.allowRelative||!a.allowRelative)throw Error("Refusing to parse relative URL without 'allowRelative' option");}else g.unshift("^(https?:)//","(([^:/?#]*)(?::([0-9]+))?)"),-1===e.indexOf("/",8)&&(e+="/");if(b=new RegExp(g.join("")),c=e.match(b),null===c)throw Error("Unable to parse URL regular expression did not match: '"+e+"'");if(f?(d={protocol:null,host:null,hostname:null,port:null,path:null,
pathname:c[1],search:c[2],hash:c[3],params:{}},d.path=d.pathname):(d={protocol:c[1],host:c[2],hostname:c[3],port:c[4],pathname:c[5],search:c[6],hash:c[7],params:{}},d.path=d.protocol+"//"+d.host+d.pathname),""!==d.search)for(;e=l.exec(d.search.substring(1));)d.params[decodeURIComponent(e[1].replace(k," "))]=decodeURIComponent(e[2].replace(k," "));return d},getServerRoot:function(e){e=e.split("/");return e[0]+"//"+e[2]},getContentTypeFromHeader:function(e){return String(e).split(";")[0]},isApplicationJSON:function(e){return 0===
TinCan.Utils.getContentTypeFromHeader(e).toLowerCase().indexOf("application/json")},stringToArrayBuffer:function(){TinCan.prototype.log("stringToArrayBuffer not overloaded - no environment loaded?")},stringFromArrayBuffer:function(){TinCan.prototype.log("stringFromArrayBuffer not overloaded - no environment loaded?")}}})();
(function(){var e=TinCan.LRS=function(a){this.log("constructor");this.auth=this.version=this.endpoint=null;this.allowFail=!0;this.extended=null;this.init(a)};e.prototype={LOG_SRC:"LRS",log:TinCan.prototype.log,init:function(a){this.log("init");var b,c=TinCan.versions(),d=!1;if(a=a||{},a.hasOwnProperty("alertOnRequestFailure")&&this.log("'alertOnRequestFailure' is deprecated (alerts have been removed) no need to set it now"),!a.hasOwnProperty("endpoint")||null===a.endpoint||""===a.endpoint)throw this.log("[error] LRS invalid: no endpoint"),
{code:3,mesg:"LRS invalid: no endpoint"};if(this.endpoint=String(a.endpoint),"/"!==this.endpoint.slice(-1)&&(this.log("adding trailing slash to endpoint"),this.endpoint+="/"),a.hasOwnProperty("allowFail")&&(this.allowFail=a.allowFail),a.hasOwnProperty("auth")?this.auth=a.auth:a.hasOwnProperty("username")&&a.hasOwnProperty("password")&&(this.auth="Basic "+TinCan.Utils.getBase64String(a.username+":"+a.password)),a.hasOwnProperty("extended")&&(this.extended=a.extended),this._initByEnvironment(a),"undefined"!=
typeof a.version){this.log("version: "+a.version);for(b=0;b<c.length;b+=1)if(c[b]===a.version){d=!0;break}if(!d)throw this.log("[error] LRS invalid: version not supported ("+a.version+")"),{code:5,mesg:"LRS invalid: version not supported ("+a.version+")"};this.version=a.version}else this.version=c[0]},_getBoundary:function(){return TinCan.Utils.getUUID().replace(/-/g,"")},_initByEnvironment:function(){this.log("_initByEnvironment not overloaded - no environment loaded?")},_makeRequest:function(){this.log("_makeRequest not overloaded - no environment loaded?")},
_getMultipartRequestData:function(){this.log("_getMultipartRequestData not overloaded - no environment loaded?")},_IEModeConversion:function(){this.log("_IEModeConversion not overloaded - browser environment not loaded.")},_processGetStatementResult:function(a,b){var c,d={};if(!b.attachments)return TinCan.Statement.fromJSON(a.responseText);b=a.getResponseHeader("Content-Type").split("boundary\x3d")[1];a=this._parseMultipart(b,a.response);b=JSON.parse(a[0].body);for(c=1;c<a.length;c+=1)d[a[c].headers["X-Experience-API-Hash"]]=
a[c].body;return this._assignAttachmentContent([b],d),new TinCan.Statement(b)},sendRequest:function(a){this.log("sendRequest");var b,c=this.endpoint+a.url,d={};if(0===a.url.indexOf("http")&&(c=a.url),null!==this.extended)for(b in a.params=a.params||{},this.extended)this.extended.hasOwnProperty(b)&&(a.params.hasOwnProperty(b)||null!==this.extended[b]&&(a.params[b]=this.extended[b]));d.Authorization=this.auth;"0.9"!==this.version&&(d["X-Experience-API-Version"]=this.version);for(b in a.headers)a.headers.hasOwnProperty(b)&&
(d[b]=a.headers[b]);return this._makeRequest(c,d,a)},about:function(a){this.log("about");var b,c,d;if(a=a||{},b={url:"about",method:"GET",params:{}},"undefined"!=typeof a.callback&&(d=function(b,c){var d=c;null===b&&(d=TinCan.About.fromJSON(c.responseText));a.callback(b,d)},b.callback=d),c=this.sendRequest(b),!d)return null===c.err&&(c.xhr=TinCan.About.fromJSON(c.xhr.responseText)),c},saveStatement:function(a,b){this.log("saveStatement");var c,d,f,e={url:"statements",headers:{}},k=[];b=b||{};try{c=
a.asVersion(this.version)}catch(l){return this.allowFail?(this.log("[warning] statement could not be serialized in version ("+this.version+"): "+l),"undefined"!=typeof b.callback?void b.callback(null,null):{err:null,xhr:null}):(this.log("[error] statement could not be serialized in version ("+this.version+"): "+l),"undefined"!=typeof b.callback?void b.callback(l,null):{err:l,xhr:null})}if(c.hasOwnProperty("attachments")&&a.hasAttachmentWithContent()){d=this._getBoundary();e.headers["Content-Type"]=
"multipart/mixed; boundary\x3d"+d;for(f=0;f<a.attachments.length;f+=1)null!==a.attachments[f].content&&k.push(a.attachments[f]);try{e.data=this._getMultipartRequestData(d,c,k)}catch(l){return this.allowFail?(this.log("[warning] multipart request data could not be created (attachments probably not supported): "+l),"undefined"!=typeof b.callback?void b.callback(null,null):{err:null,xhr:null}):(this.log("[error] multipart request data could not be created (attachments probably not supported): "+l),"undefined"!=
typeof b.callback?void b.callback(l,null):{err:l,xhr:null})}}else e.headers["Content-Type"]="application/json",e.data=JSON.stringify(c);return null!==a.id?(e.method="PUT",e.params={statementId:a.id}):e.method="POST","undefined"!=typeof b.callback&&(e.callback=b.callback),this.sendRequest(e)},retrieveStatement:function(a,b){this.log("retrieveStatement");var c,d,f,e=this;return b=b||{},b.params=b.params||{},c={url:"statements",method:"GET",params:{statementId:a}},b.params.attachments&&(c.params.attachments=
!0,c.expectMultipart=!0),"undefined"!=typeof b.callback&&(f=function(a,c){var d=c;null===a&&(d=e._processGetStatementResult(c,b.params));b.callback(a,d)},c.callback=f),d=this.sendRequest(c),f||(d.statement=null,null===d.err&&(d.statement=e._processGetStatementResult(d.xhr,b.params))),d},retrieveVoidedStatement:function(a,b){this.log("retrieveVoidedStatement");var c,d,f,e=this;return b=b||{},b.params=b.params||{},c={url:"statements",method:"GET",params:{}},"0.9"===this.version||"0.95"===this.version?
c.params.statementId=a:(c.params.voidedStatementId=a,b.params.attachments&&(c.params.attachments=!0,c.expectMultipart=!0)),"undefined"!=typeof b.callback&&(f=function(a,c){var d=c;null===a&&(d=e._processGetStatementResult(c,b.params));b.callback(a,d)},c.callback=f),d=this.sendRequest(c),f||(d.statement=null,null===d.err&&(d.statement=e._processGetStatementResult(d.xhr,b.params))),d},saveStatements:function(a,b){this.log("saveStatements");var c,d,f,e={url:"statements",method:"POST",headers:{}},k=[],
l=[];if(b=b||{},0===a.length)return"undefined"!=typeof b.callback?void b.callback(Error("no statements"),null):{err:Error("no statements"),xhr:null};for(d=0;d<a.length;d+=1){try{c=a[d].asVersion(this.version)}catch(m){return this.allowFail?(this.log("[warning] statement could not be serialized in version ("+this.version+"): "+m),"undefined"!=typeof b.callback?void b.callback(null,null):{err:null,xhr:null}):(this.log("[error] statement could not be serialized in version ("+this.version+"): "+m),"undefined"!=
typeof b.callback?void b.callback(m,null):{err:m,xhr:null})}if(a[d].hasAttachmentWithContent())for(f=0;f<a[d].attachments.length;f+=1)null!==a[d].attachments[f].content&&l.push(a[d].attachments[f]);k.push(c)}if(0!==l.length){a=this._getBoundary();e.headers["Content-Type"]="multipart/mixed; boundary\x3d"+a;try{e.data=this._getMultipartRequestData(a,k,l)}catch(m){return this.allowFail?(this.log("[warning] multipart request data could not be created (attachments probably not supported): "+m),"undefined"!=
typeof b.callback?void b.callback(null,null):{err:null,xhr:null}):(this.log("[error] multipart request data could not be created (attachments probably not supported): "+m),"undefined"!=typeof b.callback?void b.callback(m,null):{err:m,xhr:null})}}else e.headers["Content-Type"]="application/json",e.data=JSON.stringify(k);return"undefined"!=typeof b.callback&&(e.callback=b.callback),this.sendRequest(e)},queryStatements:function(a){this.log("queryStatements");var b,c,d,f=this;a=a||{};a.params=a.params||
{};try{b=this._queryStatementsRequestCfg(a),a.params.attachments&&(b.expectMultipart=!0)}catch(e){return this.log("[error] Query statements failed - "+e),"undefined"!=typeof a.callback&&a.callback(e,{}),{err:e,statementsResult:null}}return"undefined"!=typeof a.callback&&(d=function(b,c){var d,e;d=c;var q={};if(null===b)if(a.params.attachments){d=c.getResponseHeader("Content-Type").split("boundary\x3d")[1];d=f._parseMultipart(d,c.response);e=JSON.parse(d[0].body);for(c=1;c<d.length;c+=1)q[d[c].headers["X-Experience-API-Hash"]]=
d[c].body;f._assignAttachmentContent(e.statements,q);d=new TinCan.StatementsResult({statements:e.statements});for(c=0;c<d.statements.length;c+=1)d.statements[c]instanceof TinCan.Statement||(d.statements[c]=new TinCan.Statement(d.statements[c]))}else d=TinCan.StatementsResult.fromJSON(c.responseText);a.callback(b,d)},b.callback=d),c=this.sendRequest(b),c.config=b,d||(c.statementsResult=null,null===c.err&&(c.statementsResult=TinCan.StatementsResult.fromJSON(c.xhr.responseText))),c},_queryStatementsRequestCfg:function(a){this.log("_queryStatementsRequestCfg");
var b,c={},d={url:"statements",method:"GET",params:c},f=["agent","actor","object","instructor"],e=["verb","activity"],k="registration context since until limit authoritative sparse ascending related_activities related_agents format attachments".split(" "),l={verb:!0,registration:!0,since:!0,until:!0,limit:!0,ascending:!0},m={"0.9":{supported:{actor:!0,instructor:!0,target:!0,object:!0,context:!0,authoritative:!0,sparse:!0}},"1.0.0":{supported:{agent:!0,activity:!0,related_activities:!0,related_agents:!0,
format:!0,attachments:!0}}};m[.95]=m[.9];m["1.0.1"]=m["1.0.0"];m["1.0.2"]=m["1.0.0"];a.params.hasOwnProperty("target")&&(a.params.object=a.params.target);for(b in a.params)if(a.params.hasOwnProperty(b)&&"undefined"==typeof l[b]&&"undefined"==typeof m[this.version].supported[b])throw"Unrecognized query parameter configured: "+b;for(b=0;b<f.length;b+=1)"undefined"!=typeof a.params[f[b]]&&(c[f[b]]=JSON.stringify(a.params[f[b]].asVersion(this.version)));for(b=0;b<e.length;b+=1)"undefined"!=typeof a.params[e[b]]&&
("undefined"==typeof a.params[e[b]].id?c[e[b]]=a.params[e[b]]:c[e[b]]=a.params[e[b]].id);for(b=0;b<k.length;b+=1)"undefined"!=typeof a.params[k[b]]&&null!==a.params[k[b]]&&(c[k[b]]=a.params[k[b]]);return d},_assignAttachmentContent:function(a,b){var c,d;for(c=0;c<a.length;c+=1)if(a[c].hasOwnProperty("attachments")&&null!==a[c].attachments)for(d=0;d<a[c].attachments.length;d+=1)b.hasOwnProperty(a[c].attachments[d].sha2)&&(a[c].attachments[d].content=b[a[c].attachments[d].sha2])},_parseMultipart:function(a,
b){var c,d,f,e,k,l,m;a="--"+a;var q=[];c=new Uint8Array(b);c=this.__uint8ToString(c);d=c.indexOf(a+"--");for(f=c.indexOf(a);-1!==f;)e=c.indexOf(a,f+a.length),k=f+a.length+2,l=c.indexOf("\r\n\r\n",f),f=l+2+2,m=e-2,k=this._parseHeaders(this.__uint8ToString(new Uint8Array(b.slice(k,l)))),f=b.slice(f,m),0===q.length&&(f=TinCan.Utils.stringFromArrayBuffer(f)),q.push({headers:k,body:f}),f=e===d?-1:e;return q},__uint8ToString:function(a){var b,c="",d=a.byteLength;for(b=0;b<d;b+=1)c+=String.fromCharCode(a[b]);
return c},_parseHeaders:function(a){var b,c,d={};a=a.split("\n");for(c=0;c<a.length;c+=1)b=a[c].split(":",2),null!==b[1]?d[b[0]]=b[1].replace(/^\s+|\s+$/g,""):"\t"===b[0].substring(0,1)&&(d[b[0]]=b[1].replace(/^\s+|\s+$/g,""));return d},moreStatements:function(a){this.log("moreStatements: "+a.url);var b,c,d,f,e;return a=a||{},f=TinCan.Utils.parseURL(a.url,{allowRelative:!0}),e=TinCan.Utils.getServerRoot(this.endpoint),0===f.path.indexOf("/statements")&&(f.path=this.endpoint.replace(e,"")+f.path,this.log("converting non-standard more URL to "+
f.path)),0!==f.path.indexOf("/")&&(f.path="/"+f.path),b={method:"GET",url:e+f.path,params:f.params},"undefined"!=typeof a.callback&&(d=function(b,c){var d=c;null===b&&(d=TinCan.StatementsResult.fromJSON(c.responseText));a.callback(b,d)},b.callback=d),c=this.sendRequest(b),c.config=b,d||(c.statementsResult=null,null===c.err&&(c.statementsResult=TinCan.StatementsResult.fromJSON(c.xhr.responseText))),c},retrieveState:function(a,b){this.log("retrieveState");var c,d,f,e={},k={},l=this;if(f=b.requestHeaders||
{},e={stateId:a,activityId:b.activity.id},"0.9"===this.version?e.actor=JSON.stringify(b.agent.asVersion(this.version)):e.agent=JSON.stringify(b.agent.asVersion(this.version)),"undefined"!=typeof b.registration&&null!==b.registration&&("0.9"===this.version?e.registrationId=b.registration:e.registration=b.registration),k={url:"activities/state",method:"GET",params:e,ignore404:!0,headers:f},"undefined"!=typeof b.callback&&(d=function(c,d){var e=d;if(null===c)if(404===d.status)e=null;else if(e=new TinCan.State({id:a,
contents:d.responseText}),"undefined"!=typeof d.getResponseHeader&&null!==d.getResponseHeader("ETag")&&""!==d.getResponseHeader("ETag")?e.etag=d.getResponseHeader("ETag"):e.etag='"'+TinCan.Utils.getSHA1String(d.responseText)+'"',"undefined"!=typeof d.contentType?e.contentType=d.contentType:"undefined"!=typeof d.getResponseHeader&&null!==d.getResponseHeader("Content-Type")&&""!==d.getResponseHeader("Content-Type")&&(e.contentType=d.getResponseHeader("Content-Type")),TinCan.Utils.isApplicationJSON(e.contentType))try{e.contents=
JSON.parse(e.contents)}catch(f){l.log("retrieveState - failed to deserialize JSON: "+f)}b.callback(c,e)},k.callback=d),c=this.sendRequest(k),!d&&(c.state=null,null===c.err&&404!==c.xhr.status&&(c.state=new TinCan.State({id:a,contents:c.xhr.responseText}),"undefined"!=typeof c.xhr.getResponseHeader&&null!==c.xhr.getResponseHeader("ETag")&&""!==c.xhr.getResponseHeader("ETag")?c.state.etag=c.xhr.getResponseHeader("ETag"):c.state.etag='"'+TinCan.Utils.getSHA1String(c.xhr.responseText)+'"',"undefined"!=
typeof c.xhr.contentType?c.state.contentType=c.xhr.contentType:"undefined"!=typeof c.xhr.getResponseHeader&&null!==c.xhr.getResponseHeader("Content-Type")&&""!==c.xhr.getResponseHeader("Content-Type")&&(c.state.contentType=c.xhr.getResponseHeader("Content-Type")),TinCan.Utils.isApplicationJSON(c.state.contentType))))try{c.state.contents=JSON.parse(c.state.contents)}catch(m){this.log("retrieveState - failed to deserialize JSON: "+m)}return c},retrieveStateIds:function(a){this.log("retrieveStateIds");
var b,c,d,e;d={};if(a=a||{},c=a.requestHeaders||{},d.activityId=a.activity.id,"0.9"===this.version?d.actor=JSON.stringify(a.agent.asVersion(this.version)):d.agent=JSON.stringify(a.agent.asVersion(this.version)),"undefined"!=typeof a.registration&&null!==a.registration&&("0.9"===this.version?d.registrationId=a.registration:d.registration=a.registration),b={url:"activities/state",method:"GET",params:d,headers:c,ignore404:!0},"undefined"!=typeof a.callback&&(e=function(b,c){var d=c;if(null!==b)return void a.callback(b,
d);if(404===c.status)d=[];else try{d=JSON.parse(c.responseText)}catch(e){b="Response JSON parse error: "+e}a.callback(b,d)},b.callback=e),"undefined"!=typeof a.since&&(b.params.since=a.since),d=this.sendRequest(b),!e){if(d.profileIds=null,null!==d.err)return d;if(404===d.xhr.status)d.profileIds=[];else try{d.profileIds=JSON.parse(d.xhr.responseText)}catch(g){d.err="retrieveStateIds - JSON parse error: "+g}}return d},saveState:function(a,b,c){this.log("saveState");var d,e,g;return g=c.requestHeaders||
{},"undefined"==typeof c.contentType&&(c.contentType="application/octet-stream"),g["Content-Type"]=c.contentType,"object"==typeof b&&TinCan.Utils.isApplicationJSON(c.contentType)&&(b=JSON.stringify(b)),"undefined"!=typeof c.method&&"POST"===c.method||(c.method="PUT"),d={stateId:a,activityId:c.activity.id},"0.9"===this.version?d.actor=JSON.stringify(c.agent.asVersion(this.version)):d.agent=JSON.stringify(c.agent.asVersion(this.version)),"undefined"!=typeof c.registration&&null!==c.registration&&("0.9"===
this.version?d.registrationId=c.registration:d.registration=c.registration),e={url:"activities/state",method:c.method,params:d,data:b,headers:g},"undefined"!=typeof c.callback&&(e.callback=c.callback),"undefined"!=typeof c.lastSHA1&&null!==c.lastSHA1&&(e.headers["If-Match"]=c.lastSHA1),this.sendRequest(e)},dropState:function(a,b){this.log("dropState");var c,d,e;return e=b.requestHeaders||{},c={activityId:b.activity.id},"0.9"===this.version?c.actor=JSON.stringify(b.agent.asVersion(this.version)):c.agent=
JSON.stringify(b.agent.asVersion(this.version)),null!==a&&(c.stateId=a),"undefined"!=typeof b.registration&&null!==b.registration&&("0.9"===this.version?c.registrationId=b.registration:c.registration=b.registration),d={url:"activities/state",method:"DELETE",params:c,headers:e},"undefined"!=typeof b.callback&&(d.callback=b.callback),this.sendRequest(d)},retrieveActivity:function(a,b){this.log("retrieveActivity");var c,d,e,g={};return e=b.requestHeaders||{},g={url:"activities",method:"GET",params:{activityId:a},
ignore404:!0,headers:e},"undefined"!=typeof b.callback&&(d=function(c,d){var e=d;null===c&&(e=404===d.status?new TinCan.Activity({id:a}):TinCan.Activity.fromJSON(d.responseText));b.callback(c,e)},g.callback=d),c=this.sendRequest(g),d||(c.activity=null,null===c.err&&(404===c.xhr.status?c.activity=new TinCan.Activity({id:a}):c.activity=TinCan.Activity.fromJSON(c.xhr.responseText))),c},retrieveActivityProfile:function(a,b){this.log("retrieveActivityProfile");var c,d,e,g={},k=this;if(e=b.requestHeaders||
{},g={url:"activities/profile",method:"GET",params:{profileId:a,activityId:b.activity.id},ignore404:!0,headers:e},"undefined"!=typeof b.callback&&(d=function(c,d){var e=d;if(null===c)if(404===d.status)e=null;else if(e=new TinCan.ActivityProfile({id:a,activity:b.activity,contents:d.responseText}),"undefined"!=typeof d.getResponseHeader&&null!==d.getResponseHeader("ETag")&&""!==d.getResponseHeader("ETag")?e.etag=d.getResponseHeader("ETag"):e.etag='"'+TinCan.Utils.getSHA1String(d.responseText)+'"',"undefined"!=
typeof d.contentType?e.contentType=d.contentType:"undefined"!=typeof d.getResponseHeader&&null!==d.getResponseHeader("Content-Type")&&""!==d.getResponseHeader("Content-Type")&&(e.contentType=d.getResponseHeader("Content-Type")),TinCan.Utils.isApplicationJSON(e.contentType))try{e.contents=JSON.parse(e.contents)}catch(f){k.log("retrieveActivityProfile - failed to deserialize JSON: "+f)}b.callback(c,e)},g.callback=d),c=this.sendRequest(g),!d&&(c.profile=null,null===c.err&&404!==c.xhr.status&&(c.profile=
new TinCan.ActivityProfile({id:a,activity:b.activity,contents:c.xhr.responseText}),"undefined"!=typeof c.xhr.getResponseHeader&&null!==c.xhr.getResponseHeader("ETag")&&""!==c.xhr.getResponseHeader("ETag")?c.profile.etag=c.xhr.getResponseHeader("ETag"):c.profile.etag='"'+TinCan.Utils.getSHA1String(c.xhr.responseText)+'"',"undefined"!=typeof c.xhr.contentType?c.profile.contentType=c.xhr.contentType:"undefined"!=typeof c.xhr.getResponseHeader&&null!==c.xhr.getResponseHeader("Content-Type")&&""!==c.xhr.getResponseHeader("Content-Type")&&
(c.profile.contentType=c.xhr.getResponseHeader("Content-Type")),TinCan.Utils.isApplicationJSON(c.profile.contentType))))try{c.profile.contents=JSON.parse(c.profile.contents)}catch(l){this.log("retrieveActivityProfile - failed to deserialize JSON: "+l)}return c},retrieveActivityProfileIds:function(a){this.log("retrieveActivityProfileIds");var b,c,d,e;if(a=a||{},c=a.requestHeaders||{},b={url:"activities/profile",method:"GET",params:{activityId:a.activity.id},headers:c,ignore404:!0},"undefined"!=typeof a.callback&&
(e=function(b,c){var d=c;if(null!==b)return void a.callback(b,d);if(404===c.status)d=[];else try{d=JSON.parse(c.responseText)}catch(e){b="Response JSON parse error: "+e}a.callback(b,d)},b.callback=e),"undefined"!=typeof a.since&&(b.params.since=a.since),d=this.sendRequest(b),!e){if(d.profileIds=null,null!==d.err)return d;if(404===d.xhr.status)d.profileIds=[];else try{d.profileIds=JSON.parse(d.xhr.responseText)}catch(g){d.err="retrieveActivityProfileIds - JSON parse error: "+g}}return d},saveActivityProfile:function(a,
b,c){this.log("saveActivityProfile");var d,e;return e=c.requestHeaders||{},"undefined"==typeof c.contentType&&(c.contentType="application/octet-stream"),e["Content-Type"]=c.contentType,"undefined"!=typeof c.method&&"POST"===c.method||(c.method="PUT"),"object"==typeof b&&TinCan.Utils.isApplicationJSON(c.contentType)&&(b=JSON.stringify(b)),d={url:"activities/profile",method:c.method,params:{profileId:a,activityId:c.activity.id},data:b,headers:e},"undefined"!=typeof c.callback&&(d.callback=c.callback),
"undefined"!=typeof c.lastSHA1&&null!==c.lastSHA1?d.headers["If-Match"]=c.lastSHA1:d.headers["If-None-Match"]="*",this.sendRequest(d)},dropActivityProfile:function(a,b){this.log("dropActivityProfile");var c,d,e;return e=b.requestHeaders||{},c={profileId:a,activityId:b.activity.id},d={url:"activities/profile",method:"DELETE",params:c,headers:e},"undefined"!=typeof b.callback&&(d.callback=b.callback),this.sendRequest(d)},retrieveAgentProfile:function(a,b){this.log("retrieveAgentProfile");var c,d,e,
g={},k=this;if(e=b.requestHeaders||{},g={method:"GET",params:{profileId:a},ignore404:!0,headers:e},"0.9"===this.version?(g.url="actors/profile",g.params.actor=JSON.stringify(b.agent.asVersion(this.version))):(g.url="agents/profile",g.params.agent=JSON.stringify(b.agent.asVersion(this.version))),"undefined"!=typeof b.callback&&(d=function(c,d){var e=d;if(null===c)if(404===d.status)e=null;else if(e=new TinCan.AgentProfile({id:a,agent:b.agent,contents:d.responseText}),"undefined"!=typeof d.getResponseHeader&&
null!==d.getResponseHeader("ETag")&&""!==d.getResponseHeader("ETag")?e.etag=d.getResponseHeader("ETag"):e.etag='"'+TinCan.Utils.getSHA1String(d.responseText)+'"',"undefined"!=typeof d.contentType?e.contentType=d.contentType:"undefined"!=typeof d.getResponseHeader&&null!==d.getResponseHeader("Content-Type")&&""!==d.getResponseHeader("Content-Type")&&(e.contentType=d.getResponseHeader("Content-Type")),TinCan.Utils.isApplicationJSON(e.contentType))try{e.contents=JSON.parse(e.contents)}catch(f){k.log("retrieveAgentProfile - failed to deserialize JSON: "+
f)}b.callback(c,e)},g.callback=d),c=this.sendRequest(g),!d&&(c.profile=null,null===c.err&&404!==c.xhr.status&&(c.profile=new TinCan.AgentProfile({id:a,agent:b.agent,contents:c.xhr.responseText}),"undefined"!=typeof c.xhr.getResponseHeader&&null!==c.xhr.getResponseHeader("ETag")&&""!==c.xhr.getResponseHeader("ETag")?c.profile.etag=c.xhr.getResponseHeader("ETag"):c.profile.etag='"'+TinCan.Utils.getSHA1String(c.xhr.responseText)+'"',"undefined"!=typeof c.xhr.contentType?c.profile.contentType=c.xhr.contentType:
"undefined"!=typeof c.xhr.getResponseHeader&&null!==c.xhr.getResponseHeader("Content-Type")&&""!==c.xhr.getResponseHeader("Content-Type")&&(c.profile.contentType=c.xhr.getResponseHeader("Content-Type")),TinCan.Utils.isApplicationJSON(c.profile.contentType))))try{c.profile.contents=JSON.parse(c.profile.contents)}catch(l){this.log("retrieveAgentProfile - failed to deserialize JSON: "+l)}return c},retrieveAgentProfileIds:function(a){this.log("retrieveAgentProfileIds");var b,c,d,e;d={};if(a=a||{},c=a.requestHeaders||
{},b={method:"GET",params:d,headers:c,ignore404:!0},"0.9"===this.version?(b.url="actors/profile",d.actor=JSON.stringify(a.agent.asVersion(this.version))):(b.url="agents/profile",d.agent=JSON.stringify(a.agent.asVersion(this.version))),"undefined"!=typeof a.callback&&(e=function(b,c){var d=c;if(null!==b)return void a.callback(b,d);if(404===c.status)d=[];else try{d=JSON.parse(c.responseText)}catch(e){b="Response JSON parse error: "+e}a.callback(b,d)},b.callback=e),"undefined"!=typeof a.since&&(b.params.since=
a.since),d=this.sendRequest(b),!e){if(d.profileIds=null,null!==d.err)return d;if(404===d.xhr.status)d.profileIds=[];else try{d.profileIds=JSON.parse(d.xhr.responseText)}catch(g){d.err="retrieveAgentProfileIds - JSON parse error: "+g}}return d},saveAgentProfile:function(a,b,c){this.log("saveAgentProfile");var d,e;return e=c.requestHeaders||{},"undefined"==typeof c.contentType&&(c.contentType="application/octet-stream"),e["Content-Type"]=c.contentType,"undefined"!=typeof c.method&&"POST"===c.method||
(c.method="PUT"),"object"==typeof b&&TinCan.Utils.isApplicationJSON(c.contentType)&&(b=JSON.stringify(b)),d={method:c.method,params:{profileId:a},data:b,headers:e},"0.9"===this.version?(d.url="actors/profile",d.params.actor=JSON.stringify(c.agent.asVersion(this.version))):(d.url="agents/profile",d.params.agent=JSON.stringify(c.agent.asVersion(this.version))),"undefined"!=typeof c.callback&&(d.callback=c.callback),"undefined"!=typeof c.lastSHA1&&null!==c.lastSHA1?d.headers["If-Match"]=c.lastSHA1:d.headers["If-None-Match"]=
"*",this.sendRequest(d)},dropAgentProfile:function(a,b){this.log("dropAgentProfile");var c,d,e;return e=b.requestHeaders||{},c={profileId:a},d={method:"DELETE",params:c,headers:e},"0.9"===this.version?(d.url="actors/profile",c.actor=JSON.stringify(b.agent.asVersion(this.version))):(d.url="agents/profile",c.agent=JSON.stringify(b.agent.asVersion(this.version))),"undefined"!=typeof b.callback&&(d.callback=b.callback),this.sendRequest(d)}};e.syncEnabled=null})();
(function(){var e=TinCan.AgentAccount=function(a){this.log("constructor");this.name=this.homePage=null;this.init(a)};e.prototype={LOG_SRC:"AgentAccount",log:TinCan.prototype.log,init:function(a){this.log("init");var b,c=["name","homePage"];a=a||{};"undefined"!=typeof a.accountServiceHomePage&&(a.homePage=a.accountServiceHomePage);"undefined"!=typeof a.accountName&&(a.name=a.accountName);for(b=0;b<c.length;b+=1)a.hasOwnProperty(c[b])&&null!==a[c[b]]&&(this[c[b]]=a[c[b]])},toString:function(){this.log("toString");
var a="";return null!==this.name||null!==this.homePage?(a+=null!==this.name?this.name:"-",a+=":",a+=null!==this.homePage?this.homePage:"-"):a="AgentAccount: unidentified",a},asVersion:function(a){this.log("asVersion: "+a);var b={};return a=a||TinCan.versions()[0],"0.9"===a?(b.accountName=this.name,b.accountServiceHomePage=this.homePage):(b.name=this.name,b.homePage=this.homePage),b}};e.fromJSON=function(a){e.prototype.log("fromJSON");a=JSON.parse(a);return new e(a)}})();
(function(){var e=TinCan.Agent=function(a){this.log("constructor");this.account=this.openid=this.mbox_sha1sum=this.mbox=this.name=null;this.degraded=!1;this.init(a)};e.prototype={objectType:"Agent",LOG_SRC:"Agent",log:TinCan.prototype.log,init:function(a){this.log("init");var b,c,d=["name","mbox","mbox_sha1sum","openid"];a=a||{};"undefined"!=typeof a.lastName||"undefined"!=typeof a.firstName?(a.name="","undefined"!=typeof a.firstName&&0<a.firstName.length&&(a.name=a.firstName[0],1<a.firstName.length&&
(this.degraded=!0)),""!==a.name&&(a.name+=" "),"undefined"!=typeof a.lastName&&0<a.lastName.length&&(a.name+=a.lastName[0],1<a.lastName.length&&(this.degraded=!0))):"undefined"==typeof a.familyName&&"undefined"==typeof a.givenName||(a.name="","undefined"!=typeof a.givenName&&0<a.givenName.length&&(a.name=a.givenName[0],1<a.givenName.length&&(this.degraded=!0)),""!==a.name&&(a.name+=" "),"undefined"!=typeof a.familyName&&0<a.familyName.length&&(a.name+=a.familyName[0],1<a.familyName.length&&(this.degraded=
!0)));"object"==typeof a.name&&null!==a.name&&(1<a.name.length&&(this.degraded=!0),a.name=a.name[0]);"object"==typeof a.mbox&&null!==a.mbox&&(1<a.mbox.length&&(this.degraded=!0),a.mbox=a.mbox[0]);"object"==typeof a.mbox_sha1sum&&null!==a.mbox_sha1sum&&(1<a.mbox_sha1sum.length&&(this.degraded=!0),a.mbox_sha1sum=a.mbox_sha1sum[0]);"object"==typeof a.openid&&null!==a.openid&&(1<a.openid.length&&(this.degraded=!0),a.openid=a.openid[0]);"object"==typeof a.account&&null!==a.account&&"undefined"==typeof a.account.homePage&&
"undefined"==typeof a.account.name&&(0===a.account.length?delete a.account:(1<a.account.length&&(this.degraded=!0),a.account=a.account[0]));a.hasOwnProperty("account")&&(a.account instanceof TinCan.AgentAccount?this.account=a.account:this.account=new TinCan.AgentAccount(a.account));for(b=0;b<d.length;b+=1)a.hasOwnProperty(d[b])&&null!==a[d[b]]&&(c=a[d[b]],"mbox"===d[b]&&-1===c.indexOf("mailto:")&&(c="mailto:"+c),this[d[b]]=c)},toString:function(){return this.log("toString"),null!==this.name?this.name:
null!==this.mbox?this.mbox.replace("mailto:",""):null!==this.mbox_sha1sum?this.mbox_sha1sum:null!==this.openid?this.openid:null!==this.account?this.account.toString():this.objectType+": unidentified"},asVersion:function(a){this.log("asVersion: "+a);var b={objectType:this.objectType};return a=a||TinCan.versions()[0],"0.9"===a?(null!==this.mbox?b.mbox=[this.mbox]:null!==this.mbox_sha1sum?b.mbox_sha1sum=[this.mbox_sha1sum]:null!==this.openid?b.openid=[this.openid]:null!==this.account&&(b.account=[this.account.asVersion(a)]),
null!==this.name&&(b.name=[this.name])):(null!==this.mbox?b.mbox=this.mbox:null!==this.mbox_sha1sum?b.mbox_sha1sum=this.mbox_sha1sum:null!==this.openid?b.openid=this.openid:null!==this.account&&(b.account=this.account.asVersion(a)),null!==this.name&&(b.name=this.name)),b}};e.fromJSON=function(a){e.prototype.log("fromJSON");a=JSON.parse(a);return new e(a)}})();
(function(){var e=TinCan.Group=function(a){this.log("constructor");this.account=this.openid=this.mbox_sha1sum=this.mbox=this.name=null;this.member=[];this.init(a)};e.prototype={objectType:"Group",LOG_SRC:"Group",log:TinCan.prototype.log,init:function(a){this.log("init");var b;if(a=a||{},TinCan.Agent.prototype.init.call(this,a),"undefined"!=typeof a.member)for(b=0;b<a.member.length;b+=1)a.member[b]instanceof TinCan.Agent?this.member.push(a.member[b]):this.member.push(new TinCan.Agent(a.member[b]))},
toString:function(a){this.log("toString");a=TinCan.Agent.prototype.toString.call(this,a);return a!==this.objectType+": unidentified"&&(a=this.objectType+": "+a),a},asVersion:function(a){this.log("asVersion: "+a);var b,c;if(a=a||TinCan.versions()[0],b=TinCan.Agent.prototype.asVersion.call(this,a),0<this.member.length)for(b.member=[],c=0;c<this.member.length;c+=1)b.member.push(this.member[c].asVersion(a));return b}};e.fromJSON=function(a){e.prototype.log("fromJSON");a=JSON.parse(a);return new e(a)}})();
(function(){var e={"http://adlnet.gov/expapi/verbs/experienced":"experienced","http://adlnet.gov/expapi/verbs/attended":"attended","http://adlnet.gov/expapi/verbs/attempted":"attempted","http://adlnet.gov/expapi/verbs/completed":"completed","http://adlnet.gov/expapi/verbs/passed":"passed","http://adlnet.gov/expapi/verbs/failed":"failed","http://adlnet.gov/expapi/verbs/answered":"answered","http://adlnet.gov/expapi/verbs/interacted":"interacted","http://adlnet.gov/expapi/verbs/imported":"imported",
"http://adlnet.gov/expapi/verbs/created":"created","http://adlnet.gov/expapi/verbs/shared":"shared","http://adlnet.gov/expapi/verbs/voided":"voided"},a=TinCan.Verb=function(a){this.log("constructor");this.display=this.id=null;this.init(a)};a.prototype={LOG_SRC:"Verb",log:TinCan.prototype.log,init:function(a){this.log("init");var c,d=["id","display"];if("string"==typeof a)for(c in this.id=a,this.display={und:this.id},e){if(e.hasOwnProperty(c)&&e[c]===a){this.id=c;break}}else{a=a||{};for(c=0;c<d.length;c+=
1)a.hasOwnProperty(d[c])&&null!==a[d[c]]&&(this[d[c]]=a[d[c]]);null===this.display&&"undefined"!=typeof e[this.id]&&(this.display={und:e[this.id]})}},toString:function(a){return this.log("toString"),null!==this.display?this.getLangDictionaryValue("display",a):this.id},asVersion:function(a){this.log("asVersion");var c;return a=a||TinCan.versions()[0],"0.9"===a?c=e[this.id]:(c={id:this.id},null!==this.display&&(c.display=this.display)),c},getLangDictionaryValue:TinCan.Utils.getLangDictionaryValue};
a.fromJSON=function(b){a.prototype.log("fromJSON");b=JSON.parse(b);return new a(b)}})();
(function(){var e=TinCan.Result=function(a){this.log("constructor");this.extensions=this.response=this.duration=this.completion=this.success=this.score=null;this.init(a)};e.prototype={LOG_SRC:"Result",log:TinCan.prototype.log,init:function(a){this.log("init");var b,c=["completion","duration","extensions","response","success"];a=a||{};a.hasOwnProperty("score")&&null!==a.score&&(a.score instanceof TinCan.Score?this.score=a.score:this.score=new TinCan.Score(a.score));for(b=0;b<c.length;b+=1)a.hasOwnProperty(c[b])&&
null!==a[c[b]]&&(this[c[b]]=a[c[b]]);"Completed"===this.completion&&(this.completion=!0)},asVersion:function(a){this.log("asVersion");var b,c={},d=["success","duration","response","extensions"],e=["score"];a=a||TinCan.versions()[0];for(b=0;b<d.length;b+=1)null!==this[d[b]]&&(c[d[b]]=this[d[b]]);for(b=0;b<e.length;b+=1)null!==this[e[b]]&&(c[e[b]]=this[e[b]].asVersion(a));return null!==this.completion&&("0.9"===a?this.completion&&(c.completion="Completed"):c.completion=this.completion),c}};e.fromJSON=
function(a){e.prototype.log("fromJSON");a=JSON.parse(a);return new e(a)}})();
(function(){var e=TinCan.Score=function(a){this.log("constructor");this.max=this.min=this.raw=this.scaled=null;this.init(a)};e.prototype={LOG_SRC:"Score",log:TinCan.prototype.log,init:function(a){this.log("init");var b,c=["scaled","raw","min","max"];a=a||{};for(b=0;b<c.length;b+=1)a.hasOwnProperty(c[b])&&null!==a[c[b]]&&(this[c[b]]=a[c[b]])},asVersion:function(a){this.log("asVersion");var b={},c=["scaled","raw","min","max"];a||TinCan.versions();for(a=0;a<c.length;a+=1)null!==this[c[a]]&&(b[c[a]]=
this[c[a]]);return b}};e.fromJSON=function(a){e.prototype.log("fromJSON");a=JSON.parse(a);return new e(a)}})();
(function(){var e=TinCan.InteractionComponent=function(a){this.log("constructor");this.description=this.id=null;this.init(a)};e.prototype={LOG_SRC:"InteractionComponent",log:TinCan.prototype.log,init:function(a){this.log("init");var b,c=["id","description"];a=a||{};for(b=0;b<c.length;b+=1)a.hasOwnProperty(c[b])&&null!==a[c[b]]&&(this[c[b]]=a[c[b]])},asVersion:function(a){this.log("asVersion");var b,c={id:this.id},d=["description"];a||TinCan.versions();for(a=0;a<d.length;a+=1)b=d[a],null!==this[b]&&
(c[b]=this[b]);return c},getLangDictionaryValue:TinCan.Utils.getLangDictionaryValue};e.fromJSON=function(a){e.prototype.log("fromJSON");a=JSON.parse(a);return new e(a)}})();
(function(){var e={"http://adlnet.gov/expapi/activities/course":"course","http://adlnet.gov/expapi/activities/module":"module","http://adlnet.gov/expapi/activities/meeting":"meeting","http://adlnet.gov/expapi/activities/media":"media","http://adlnet.gov/expapi/activities/performance":"performance","http://adlnet.gov/expapi/activities/simulation":"simulation","http://adlnet.gov/expapi/activities/assessment":"assessment","http://adlnet.gov/expapi/activities/interaction":"interaction","http://adlnet.gov/expapi/activities/cmi.interaction":"cmi.interaction",
"http://adlnet.gov/expapi/activities/question":"question","http://adlnet.gov/expapi/activities/objective":"objective","http://adlnet.gov/expapi/activities/link":"link"},a=TinCan.ActivityDefinition=function(a){this.log("constructor");this.steps=this.target=this.source=this.scale=this.choices=this.correctResponsesPattern=this.interactionType=this.extensions=this.moreInfo=this.type=this.description=this.name=null;this.init(a)};a.prototype={LOG_SRC:"ActivityDefinition",log:TinCan.prototype.log,init:function(a){this.log("init");
var c,d,f,g=["name","description","moreInfo","extensions","correctResponsesPattern"],k=[];if(a=a||{},a.hasOwnProperty("type")&&null!==a.type){for(f in e)e.hasOwnProperty(f)&&e[f]===a.type&&(a.type=e[f]);this.type=a.type}if(a.hasOwnProperty("interactionType")&&null!==a.interactionType&&(this.interactionType=a.interactionType,"choice"===a.interactionType||"sequencing"===a.interactionType?k.push("choices"):"likert"===a.interactionType?k.push("scale"):"matching"===a.interactionType?(k.push("source"),
k.push("target")):"performance"===a.interactionType&&k.push("steps"),0<k.length))for(c=0;c<k.length;c+=1)if(f=k[c],a.hasOwnProperty(f)&&null!==a[f])for(this[f]=[],d=0;d<a[f].length;d+=1)a[f][d]instanceof TinCan.InteractionComponent?this[f].push(a[f][d]):this[f].push(new TinCan.InteractionComponent(a[f][d]));for(c=0;c<g.length;c+=1)a.hasOwnProperty(g[c])&&null!==a[g[c]]&&(this[g[c]]=a[g[c]])},toString:function(a){return this.log("toString"),null!==this.name?this.getLangDictionaryValue("name",a):null!==
this.description?this.getLangDictionaryValue("description",a):""},asVersion:function(a){this.log("asVersion");var c,d,f,g={};d=["name","description","interactionType","correctResponsesPattern","extensions"];var k=["choices","scale","source","target","steps"];a=a||TinCan.versions()[0];null!==this.type&&("0.9"===a?g.type=e[this.type]:g.type=this.type);for(c=0;c<d.length;c+=1)f=d[c],null!==this[f]&&(g[f]=this[f]);for(c=0;c<k.length;c+=1)if(f=k[c],null!==this[f])for(g[f]=[],d=0;d<this[f].length;d+=1)g[f].push(this[f][d].asVersion(a));
return 0!==a.indexOf("0.9")&&null!==this.moreInfo&&(g.moreInfo=this.moreInfo),g},getLangDictionaryValue:TinCan.Utils.getLangDictionaryValue};a.fromJSON=function(b){a.prototype.log("fromJSON");b=JSON.parse(b);return new a(b)}})();
(function(){var e=TinCan.Activity=function(a){this.log("constructor");this.objectType="Activity";this.definition=this.id=null;this.init(a)};e.prototype={LOG_SRC:"Activity",log:TinCan.prototype.log,init:function(a){this.log("init");var b,c=["id"];a=a||{};a.hasOwnProperty("definition")&&(a.definition instanceof TinCan.ActivityDefinition?this.definition=a.definition:this.definition=new TinCan.ActivityDefinition(a.definition));for(b=0;b<c.length;b+=1)a.hasOwnProperty(c[b])&&null!==a[c[b]]&&(this[c[b]]=
a[c[b]])},toString:function(a){this.log("toString");var b="";return null!==this.definition&&(b=this.definition.toString(a),""!==b)?b:null!==this.id?this.id:"Activity: unidentified"},asVersion:function(a){this.log("asVersion");var b={id:this.id,objectType:this.objectType};return a=a||TinCan.versions()[0],null!==this.definition&&(b.definition=this.definition.asVersion(a)),b}};e.fromJSON=function(a){e.prototype.log("fromJSON");a=JSON.parse(a);return new e(a)}})();
(function(){var e=TinCan.ContextActivities=function(a){this.log("constructor");this.other=this.grouping=this.parent=this.category=null;this.init(a)};e.prototype={LOG_SRC:"ContextActivities",log:TinCan.prototype.log,init:function(a){this.log("init");var b,c,d,e=["category","parent","grouping","other"];a=a||{};for(b=0;b<e.length;b+=1)if(d=e[b],a.hasOwnProperty(d)&&null!==a[d])if("[object Array]"===Object.prototype.toString.call(a[d]))for(c=0;c<a[d].length;c+=1)this.add(d,a[d][c]);else c=a[d],this.add(d,
c)},add:function(a,b){if("category"===a||"parent"===a||"grouping"===a||"other"===a)return null===this[a]&&(this[a]=[]),b instanceof TinCan.Activity||(b="string"==typeof b?{id:b}:b,b=new TinCan.Activity(b)),this[a].push(b),this[a].length-1},asVersion:function(a){this.log("asVersion");var b,c,d={},e=["parent","grouping","other"];a=a||TinCan.versions()[0];for(b=0;b<e.length;b+=1)if(null!==this[e[b]]&&0<this[e[b]].length)if("0.9"===a||"0.95"===a)1<this[e[b]].length&&this.log("[warning] version does not support multiple values in: "+
e[b]),d[e[b]]=this[e[b]][0].asVersion(a);else for(d[e[b]]=[],c=0;c<this[e[b]].length;c+=1)d[e[b]].push(this[e[b]][c].asVersion(a));if(null!==this.category&&0<this.category.length){if("0.9"===a||"0.95"===a)throw this.log("[error] version does not support the 'category' property: "+a),Error(a+" does not support the 'category' property");d.category=[];for(b=0;b<this.category.length;b+=1)d.category.push(this.category[b].asVersion(a))}return d}};e.fromJSON=function(a){e.prototype.log("fromJSON");a=JSON.parse(a);
return new e(a)}})();
(function(){var e=TinCan.Context=function(a){this.log("constructor");this.extensions=this.statement=this.language=this.platform=this.revision=this.contextActivities=this.team=this.instructor=this.registration=null;this.init(a)};e.prototype={LOG_SRC:"Context",log:TinCan.prototype.log,init:function(a){this.log("init");var b,c,d,e=["registration","revision","platform","language","extensions"],g=["instructor","team"];a=a||{};for(b=0;b<e.length;b+=1)c=e[b],a.hasOwnProperty(c)&&null!==a[c]&&(this[c]=a[c]);
for(b=0;b<g.length;b+=1)c=g[b],a.hasOwnProperty(c)&&null!==a[c]&&(d=a[c],"undefined"!=typeof d.objectType&&"Person"!==d.objectType||(d.objectType="Agent"),"Agent"!==d.objectType||d instanceof TinCan.Agent?"Group"!==d.objectType||d instanceof TinCan.Group||(d=new TinCan.Group(d)):d=new TinCan.Agent(d),this[c]=d);a.hasOwnProperty("contextActivities")&&null!==a.contextActivities&&(a.contextActivities instanceof TinCan.ContextActivities?this.contextActivities=a.contextActivities:this.contextActivities=
new TinCan.ContextActivities(a.contextActivities));a.hasOwnProperty("statement")&&null!==a.statement&&(a.statement instanceof TinCan.StatementRef?this.statement=a.statement:a.statement instanceof TinCan.SubStatement?this.statement=a.statement:"StatementRef"===a.statement.objectType?this.statement=new TinCan.StatementRef(a.statement):"SubStatement"===a.statement.objectType?this.statement=new TinCan.SubStatement(a.statement):this.log("Unable to parse statement.context.statement property."))},asVersion:function(a){this.log("asVersion");
var b,c={},d=["registration","revision","platform","language","extensions"],e=["instructor","team","contextActivities","statement"];if(a=a||TinCan.versions()[0],this.statement instanceof TinCan.SubStatement&&"0.9"!==a&&"0.95"!==a)throw this.log("[error] version does not support SubStatements in the 'statement' property: "+a),Error(a+" does not support SubStatements in the 'statement' property");for(b=0;b<d.length;b+=1)null!==this[d[b]]&&(c[d[b]]=this[d[b]]);for(b=0;b<e.length;b+=1)null!==this[e[b]]&&
(c[e[b]]=this[e[b]].asVersion(a));return c}};e.fromJSON=function(a){e.prototype.log("fromJSON");a=JSON.parse(a);return new e(a)}})();
(function(){var e=TinCan.StatementRef=function(a){this.log("constructor");this.id=null;this.init(a)};e.prototype={objectType:"StatementRef",LOG_SRC:"StatementRef",log:TinCan.prototype.log,init:function(a){this.log("init");var b,c=["id"];a=a||{};for(b=0;b<c.length;b+=1)a.hasOwnProperty(c[b])&&null!==a[c[b]]&&(this[c[b]]=a[c[b]])},toString:function(){return this.log("toString"),this.id},asVersion:function(a){this.log("asVersion");var b={objectType:this.objectType,id:this.id};return"0.9"===a&&(b.objectType=
"Statement"),b}};e.fromJSON=function(a){e.prototype.log("fromJSON");a=JSON.parse(a);return new e(a)}})();
(function(){var e=TinCan.SubStatement=function(a){this.log("constructor");this.timestamp=this.context=this.result=this.target=this.verb=this.actor=null;this.init(a)};e.prototype={objectType:"SubStatement",LOG_SRC:"SubStatement",log:TinCan.prototype.log,init:function(a){this.log("init");var b,c=["timestamp"];a=a||{};a.hasOwnProperty("object")&&(a.target=a.object);a.hasOwnProperty("actor")&&("undefined"!=typeof a.actor.objectType&&"Person"!==a.actor.objectType||(a.actor.objectType="Agent"),"Agent"===
a.actor.objectType?a.actor instanceof TinCan.Agent?this.actor=a.actor:this.actor=new TinCan.Agent(a.actor):"Group"===a.actor.objectType&&(a.actor instanceof TinCan.Group?this.actor=a.actor:this.actor=new TinCan.Group(a.actor)));a.hasOwnProperty("verb")&&(a.verb instanceof TinCan.Verb?this.verb=a.verb:this.verb=new TinCan.Verb(a.verb));a.hasOwnProperty("target")&&(a.target instanceof TinCan.Activity||a.target instanceof TinCan.Agent||a.target instanceof TinCan.Group||a.target instanceof TinCan.SubStatement||
a.target instanceof TinCan.StatementRef?this.target=a.target:("undefined"==typeof a.target.objectType&&(a.target.objectType="Activity"),"Activity"===a.target.objectType?this.target=new TinCan.Activity(a.target):"Agent"===a.target.objectType?this.target=new TinCan.Agent(a.target):"Group"===a.target.objectType?this.target=new TinCan.Group(a.target):"SubStatement"===a.target.objectType?this.target=new TinCan.SubStatement(a.target):"StatementRef"===a.target.objectType?this.target=new TinCan.StatementRef(a.target):
this.log("Unrecognized target type: "+a.target.objectType)));a.hasOwnProperty("result")&&(a.result instanceof TinCan.Result?this.result=a.result:this.result=new TinCan.Result(a.result));a.hasOwnProperty("context")&&(a.context instanceof TinCan.Context?this.context=a.context:this.context=new TinCan.Context(a.context));for(b=0;b<c.length;b+=1)a.hasOwnProperty(c[b])&&null!==a[c[b]]&&(this[c[b]]=a[c[b]])},toString:function(a){return this.log("toString"),(null!==this.actor?this.actor.toString(a):"")+" "+
(null!==this.verb?this.verb.toString(a):"")+" "+(null!==this.target?this.target.toString(a):"")},asVersion:function(a){this.log("asVersion");var b,c,d=["timestamp"],e=["actor","verb","result","context"];b={objectType:this.objectType};a=a||TinCan.versions()[0];for(c=0;c<d.length;c+=1)null!==this[d[c]]&&(b[d[c]]=this[d[c]]);for(c=0;c<e.length;c+=1)null!==this[e[c]]&&(b[e[c]]=this[e[c]].asVersion(a));return null!==this.target&&(b.object=this.target.asVersion(a)),"0.9"===a&&(b.objectType="Statement"),
b}};e.fromJSON=function(a){e.prototype.log("fromJSON");a=JSON.parse(a);return new e(a)}})();
(function(){var e=TinCan.Statement=function(a,b){this.log("constructor");b="number"==typeof b?{storeOriginal:b}:b||{};"undefined"==typeof b.storeOriginal&&(b.storeOriginal=null);"undefined"==typeof b.doStamp&&(b.doStamp=!0);this.version=this.attachments=this.authority=this.stored=this.timestamp=this.context=this.result=this.target=this.verb=this.actor=this.id=null;this.degraded=!1;this.originalJSON=this.inProgress=this.voided=null;this.init(a,b)};e.prototype={LOG_SRC:"Statement",log:TinCan.prototype.log,
init:function(a,b){this.log("init");var c,d="id stored timestamp version inProgress voided".split(" ");if(a=a||{},b.storeOriginal&&(this.originalJSON=JSON.stringify(a,null,b.storeOriginal)),a.hasOwnProperty("object")&&(a.target=a.object),a.hasOwnProperty("actor")&&("undefined"!=typeof a.actor.objectType&&"Person"!==a.actor.objectType||(a.actor.objectType="Agent"),"Agent"===a.actor.objectType?a.actor instanceof TinCan.Agent?this.actor=a.actor:this.actor=new TinCan.Agent(a.actor):"Group"===a.actor.objectType&&
(a.actor instanceof TinCan.Group?this.actor=a.actor:this.actor=new TinCan.Group(a.actor))),a.hasOwnProperty("authority")&&("undefined"!=typeof a.authority.objectType&&"Person"!==a.authority.objectType||(a.authority.objectType="Agent"),"Agent"===a.authority.objectType?a.authority instanceof TinCan.Agent?this.authority=a.authority:this.authority=new TinCan.Agent(a.authority):"Group"===a.authority.objectType&&(a.actor instanceof TinCan.Group?this.authority=a.authority:this.authority=new TinCan.Group(a.authority))),
a.hasOwnProperty("verb")&&(a.verb instanceof TinCan.Verb?this.verb=a.verb:this.verb=new TinCan.Verb(a.verb)),a.hasOwnProperty("target")&&(a.target instanceof TinCan.Activity||a.target instanceof TinCan.Agent||a.target instanceof TinCan.Group||a.target instanceof TinCan.SubStatement||a.target instanceof TinCan.StatementRef?this.target=a.target:("undefined"==typeof a.target.objectType&&(a.target.objectType="Activity"),"Activity"===a.target.objectType?this.target=new TinCan.Activity(a.target):"Agent"===
a.target.objectType?this.target=new TinCan.Agent(a.target):"Group"===a.target.objectType?this.target=new TinCan.Group(a.target):"SubStatement"===a.target.objectType?this.target=new TinCan.SubStatement(a.target):"StatementRef"===a.target.objectType?this.target=new TinCan.StatementRef(a.target):this.log("Unrecognized target type: "+a.target.objectType))),a.hasOwnProperty("result")&&(a.result instanceof TinCan.Result?this.result=a.result:this.result=new TinCan.Result(a.result)),a.hasOwnProperty("context")&&
(a.context instanceof TinCan.Context?this.context=a.context:this.context=new TinCan.Context(a.context)),a.hasOwnProperty("attachments")&&null!==a.attachments)for(this.attachments=[],c=0;c<a.attachments.length;c+=1)a.attachments[c]instanceof TinCan.Attachment?this.attachments.push(a.attachments[c]):this.attachments.push(new TinCan.Attachment(a.attachments[c]));for(c=0;c<d.length;c+=1)a.hasOwnProperty(d[c])&&null!==a[d[c]]&&(this[d[c]]=a[d[c]]);b.doStamp&&this.stamp()},toString:function(a){return this.log("toString"),
(null!==this.actor?this.actor.toString(a):"")+" "+(null!==this.verb?this.verb.toString(a):"")+" "+(null!==this.target?this.target.toString(a):"")},asVersion:function(a){this.log("asVersion");var b,c={},d=["id","timestamp"],e=["actor","verb","result","context","authority"];a=a||TinCan.versions()[0];for(b=0;b<d.length;b+=1)null!==this[d[b]]&&(c[d[b]]=this[d[b]]);for(b=0;b<e.length;b+=1)null!==this[e[b]]&&(c[e[b]]=this[e[b]].asVersion(a));if(null!==this.target&&(c.object=this.target.asVersion(a)),"0.9"!==
a&&"0.95"!==a||null!==this.voided&&(c.voided=this.voided),"0.9"===a&&null!==this.inProgress&&(c.inProgress=this.inProgress),null!==this.attachments&&"0.9"!==a&&"0.95"!==a)for(c.attachments=[],b=0;b<this.attachments.length;b+=1)this.attachments[b]instanceof TinCan.Attachment?c.attachments.push(this.attachments[b].asVersion(a)):c.attachments.push((new TinCan.Attachment(this.attachments[b])).asVersion(a));return c},stamp:function(){this.log("stamp");null===this.id&&(this.id=TinCan.Utils.getUUID());null===
this.timestamp&&(this.timestamp=TinCan.Utils.getISODateString(new Date))},hasAttachmentWithContent:function(){this.log("hasAttachmentWithContent");var a;if(null===this.attachments)return!1;for(a=0;a<this.attachments.length;a+=1)if(null!==this.attachments[a].content)return!0;return!1}};e.fromJSON=function(a){e.prototype.log("fromJSON");a=JSON.parse(a);return new e(a)}})();
(function(){var e=TinCan.StatementsResult=function(a){this.log("constructor");this.more=this.statements=null;this.init(a)};e.prototype={LOG_SRC:"StatementsResult",log:TinCan.prototype.log,init:function(a){this.log("init");a=a||{};a.hasOwnProperty("statements")&&(this.statements=a.statements);a.hasOwnProperty("more")&&(this.more=a.more)}};e.fromJSON=function(a){e.prototype.log("fromJSON");var b,c,d=[];try{b=JSON.parse(a)}catch(f){e.prototype.log("fromJSON - JSON.parse error: "+f)}if(b){for(a=0;a<b.statements.length;a+=
1){try{c=new TinCan.Statement(b.statements[a],4)}catch(f){e.prototype.log("fromJSON - statement instantiation failed: "+f+" ("+JSON.stringify(b.statements[a])+")"),c=new TinCan.Statement({id:b.statements[a].id},4)}d.push(c)}b.statements=d}return new e(b)}})();
(function(){var e=TinCan.State=function(a){this.log("constructor");this.contentType=this.etag=this.contents=this.updated=this.id=null;this.init(a)};e.prototype={LOG_SRC:"State",log:TinCan.prototype.log,init:function(a){this.log("init");var b,c=["id","contents","etag","contentType"];a=a||{};for(b=0;b<c.length;b+=1)a.hasOwnProperty(c[b])&&null!==a[c[b]]&&(this[c[b]]=a[c[b]]);this.updated=!1}};e.fromJSON=function(a){e.prototype.log("fromJSON");a=JSON.parse(a);return new e(a)}})();
(function(){var e=TinCan.ActivityProfile=function(a){this.log("constructor");this.contentType=this.etag=this.contents=this.updated=this.activity=this.id=null;this.init(a)};e.prototype={LOG_SRC:"ActivityProfile",log:TinCan.prototype.log,init:function(a){this.log("init");var b,c=["id","contents","etag","contentType"];a=a||{};a.hasOwnProperty("activity")&&(a.activity instanceof TinCan.Activity?this.activity=a.activity:this.activity=new TinCan.Activity(a.activity));for(b=0;b<c.length;b+=1)a.hasOwnProperty(c[b])&&
null!==a[c[b]]&&(this[c[b]]=a[c[b]]);this.updated=!1}};e.fromJSON=function(a){e.prototype.log("fromJSON");a=JSON.parse(a);return new e(a)}})();
(function(){var e=TinCan.AgentProfile=function(a){this.log("constructor");this.contentType=this.etag=this.contents=this.updated=this.agent=this.id=null;this.init(a)};e.prototype={LOG_SRC:"AgentProfile",log:TinCan.prototype.log,init:function(a){this.log("init");var b,c=["id","contents","etag","contentType"];a=a||{};a.hasOwnProperty("agent")&&(a.agent instanceof TinCan.Agent?this.agent=a.agent:this.agent=new TinCan.Agent(a.agent));for(b=0;b<c.length;b+=1)a.hasOwnProperty(c[b])&&null!==a[c[b]]&&(this[c[b]]=
a[c[b]]);this.updated=!1}};e.fromJSON=function(a){e.prototype.log("fromJSON");a=JSON.parse(a);return new e(a)}})();(function(){var e=TinCan.About=function(a){this.log("constructor");this.version=null;this.init(a)};e.prototype={LOG_SRC:"About",log:TinCan.prototype.log,init:function(a){this.log("init");var b,c=["version"];a=a||{};for(b=0;b<c.length;b+=1)a.hasOwnProperty(c[b])&&null!==a[c[b]]&&(this[c[b]]=a[c[b]])}};e.fromJSON=function(a){e.prototype.log("fromJSON");a=JSON.parse(a);return new e(a)}})();
(function(){var e=TinCan.Attachment=function(a){this.log("constructor");this.content=this.fileUrl=this.description=this.sha2=this.length=this.contentType=this.display=this.usageType=null;this.init(a)};e.prototype={LOG_SRC:"Attachment",log:TinCan.prototype.log,init:function(a){this.log("init");var b,c="contentType length sha2 usageType display description fileUrl".split(" ");a=a||{};for(b=0;b<c.length;b+=1)a.hasOwnProperty(c[b])&&null!==a[c[b]]&&(this[c[b]]=a[c[b]]);a.hasOwnProperty("content")&&null!==
a.content&&("string"==typeof a.content?this.setContentFromString(a.content):this.setContent(a.content))},asVersion:function(a){this.log("asVersion");var b;return a=a||TinCan.versions()[0],"0.9"===a||"0.95"===a?b=null:(b={contentType:this.contentType,display:this.display,length:this.length,sha2:this.sha2,usageType:this.usageType},null!==this.fileUrl&&(b.fileUrl=this.fileUrl),null!==this.description&&(b.description=this.description)),b},getLangDictionaryValue:TinCan.Utils.getLangDictionaryValue,setContent:function(a){this.content=
a;this.length=a.byteLength;this.sha2=TinCan.Utils.getSHA256String(a)},setContentFromString:function(a){a=TinCan.Utils.stringToArrayBuffer(a);this.setContent(a)},getContentAsString:function(){return TinCan.Utils.stringFromArrayBuffer(this.content)}};e.fromJSON=function(a){e.prototype.log("fromJSON");a=JSON.parse(a);return new e(a)};e._defaultEncoding="utf-8"})();
(function(){var e,a,b,c,d,f,g,k,l,m=TinCan.prototype.log;return"undefined"==typeof window?void m("'window' not defined","Environment.Browser"):(window.JSON||(window.JSON={parse:function(a){return eval("("+a+")")},stringify:function(a){var b,c="";if(a instanceof Object){if(a.constructor===Array){for(b=0;b<a.length;b+=1)c+=this.stringify(a[b])+",";return"["+c.substr(0,c.length-1)+"]"}if(a.toString!==Object.prototype.toString)return'"'+a.toString().replace(/"/g,"\\$\x26")+'"';for(b in a)a.hasOwnProperty(b)&&
(c+='"'+b.replace(/"/g,"\\$\x26")+'":'+this.stringify(a[b])+",");return"{"+c.substr(0,c.length-1)+"}"}return"string"==typeof a?'"'+a.replace(/"/g,"\\$\x26")+'"':String(a)}}),Date.now||(Date.now=function(){return+new Date}),Array.prototype.forEach||(Array.prototype.forEach=function(a,b){if(void 0===this||null===this)throw new TypeError;var c=Object(this),d=c.length>>>0;if("function"!=typeof a)throw new TypeError;var e;for(e=0;e<d;e+=1)e in c&&a.call(b,c[e],e,c)}),k=!1,l=!1,"undefined"!=typeof XMLHttpRequest&&
"undefined"!=typeof(new XMLHttpRequest).withCredentials?k=!0:"undefined"!=typeof XDomainRequest&&(k=!0,l=!0),e=function(a,b,c){m("requestComplete: "+c.finished+", xhr.status: "+a.status,"Environment.Browser");var d,e,h;return h="undefined"==typeof a.status?c.fakeStatus:1223===a.status?204:a.status,c.finished?d:(c.finished=!0,e=b.ignore404&&404===h,200<=h&&400>h||e?b.callback?void b.callback(null,a):{err:null,xhr:a}:(d={err:h,xhr:a},0===h?m("[warning] There was a problem communicating with the Learning Record Store. Aborted, offline, or invalid CORS endpoint ("+
h+")","Environment.Browser"):m("[warning] There was a problem communicating with the Learning Record Store. ("+h+" | "+a.responseText+")","Environment.Browser"),b.callback&&b.callback(h,a),d))},a=function(a,b,c,d){for(var e in b)b.hasOwnProperty(e)&&c.push(e+"\x3d"+encodeURIComponent(b[e]));return"undefined"!=typeof d.data&&c.push("content\x3d"+encodeURIComponent(d.data)),b["Content-Type"]="application/x-www-form-urlencoded",a+="?method\x3d"+d.method,d.method="POST",d.params={},0<c.length&&(d.data=
c.join("\x26")),a},b=function(b,c,d){m("sendRequest using XMLHttpRequest","Environment.Browser");var f,g,h,n=this,p=[],l={finished:!1,fakeStatus:null},k="undefined"!=typeof d.callback,F=b;m("sendRequest using XMLHttpRequest - async: "+k,"Environment.Browser");for(g in d.params)d.params.hasOwnProperty(g)&&p.push(g+"\x3d"+encodeURIComponent(d.params[g]));if(0<p.length&&(F+="?"+p.join("\x26")),2048<=F.length){if("undefined"==typeof d.method)return h=Error("method must not be undefined for an IE Mode Request conversion"),
"undefined"!=typeof d.callback&&d.callback(h,null),{err:h,xhr:null};b=a(b,c,p,d)}else b=F;if("undefined"!=typeof XMLHttpRequest)f=new XMLHttpRequest;else if(f=new ActiveXObject("Microsoft.XMLHTTP"),d.expectMultipart)return h=Error("Attachment support not available"),"undefined"!=typeof d.callback&&d.callback(h,null),{err:h,xhr:null};f.open(d.method,b,k);d.expectMultipart&&(f.responseType="arraybuffer");for(g in c)c.hasOwnProperty(g)&&f.setRequestHeader(g,c[g]);b=d.data;k&&(f.onreadystatechange=function(){m("xhr.onreadystatechange - xhr.readyState: "+
f.readyState,"Environment.Browser");4===f.readyState&&e.call(n,f,d,l)});try{f.send(b)}catch(J){m("sendRequest caught send exception: "+J,"Environment.Browser")}return k?f:e.call(this,f,d,l)},c=function(a,b,c){m("sendRequest using XDomainRequest","Environment.Browser");var d,f,h,n=this,p=[],l={finished:!1,fakeStatus:null};if(c.expectMultipart)return h=Error("Attachment support not available"),"undefined"!=typeof c.callback&&c.callback(h,null),{err:h,xhr:null};a+="?method\x3d"+c.method;for(f in c.params)c.params.hasOwnProperty(f)&&
p.push(f+"\x3d"+encodeURIComponent(c.params[f]));for(f in b)b.hasOwnProperty(f)&&p.push(f+"\x3d"+encodeURIComponent(b[f]));"undefined"!=typeof c.data&&p.push("content\x3d"+encodeURIComponent(c.data));b=p.join("\x26");d=new XDomainRequest;d.open("POST",a);c.callback?(d.onload=function(){l.fakeStatus=200;e.call(n,d,c,l)},d.onerror=function(){l.fakeStatus=400;e.call(n,d,c,l)},d.ontimeout=function(){l.fakeStatus=0;e.call(n,d,c,l)}):(d.onload=function(){l.fakeStatus=200},d.onerror=function(){l.fakeStatus=
400},d.ontimeout=function(){l.fakeStatus=0});d.onprogress=function(){};d.timeout=0;try{d.send(b)}catch(k){m("sendRequest caught send exception: "+k,"Environment.Browser")}if(!c.callback){a=1E4+Date.now();for(m("sendRequest - until: "+a+", finished: "+l.finished,"Environment.Browser");Date.now()<a&&null===l.fakeStatus;)g();return e.call(n,d,c,l)}return d},TinCan.LRS.prototype._initByEnvironment=function(d){m("_initByEnvironment","Environment.Browser");var e,f,g;if(d=d||{},this._makeRequest=b,this._IEModeConversion=
a,e=this.endpoint.toLowerCase().match(/([A-Za-z]+:)\/\/([^:\/]+):?(\d+)?(\/.*)?$/),null===e)throw m("[error] LRS invalid: failed to divide URL parts","Environment.Browser"),{code:4,mesg:"LRS invalid: failed to divide URL parts"};if(g=location.port,f=location.protocol.toLowerCase()===e[1],""===g&&(g="http:"===location.protocol.toLowerCase()?"80":"https:"===location.protocol.toLowerCase()?"443":""),!f||location.hostname.toLowerCase()!==e[2]||g!==(null!==e[3]&&"undefined"!=typeof e[3]&&""!==e[3]?e[3]:
"http:"===e[1]?"80":"https:"===e[1]?"443":""))if(k)if(l&&f)this._makeRequest=c;else{if(l&&!f){if(!d.allowFail)throw m("[error] LRS invalid: cross domain request for differing scheme in IE with XDR","Environment.Browser"),{code:2,mesg:"LRS invalid: cross domain request for differing scheme in IE with XDR"};m("[warning] LRS invalid: cross domain request for differing scheme in IE with XDR (allowed to fail)","Environment.Browser")}}else{if(!d.allowFail)throw m("[error] LRS invalid: cross domain requests not supported in this browser",
"Environment.Browser"),{code:1,mesg:"LRS invalid: cross domain requests not supported in this browser"};m("[warning] LRS invalid: cross domain requests not supported in this browser (allowed to fail)","Environment.Browser")}},g=function(){var a=new XMLHttpRequest,b=window.location+"?forcenocache\x3d"+TinCan.Utils.getUUID();a.open("GET",b,!1);a.send(null)},TinCan.LRS.syncEnabled=!0,TinCan.LRS.prototype._getMultipartRequestData=function(a,b,c){var e=[];e.push(d(a,b));for(b=0;b<c.length;b+=1)null!==
c[b].content&&e.push(f(a,c[b].content,c[b].sha2,c[b].contentType));return e.push("\r\n--"+a+"--\r\n"),new Blob(e)},d=function(a,b){return["--"+a,"Content-Type: application/json","",JSON.stringify(b)].join("\r\n")+"\r\n"},f=function(a,b,c,d){var e=[];a=["--"+a,"Content-Type: "+d,"Content-Transfer-Encoding: binary","X-Experience-API-Hash: "+c].join("\r\n");return a+="\r\n\r\n",e.push(a),e.push(b),new Blob(e)},TinCan.Utils.stringToArrayBuffer=function(a,b){var c;return b||(b=TinCan.Utils.defaultEncoding),
c=new TextEncoder(b),c.encode(a).buffer},void(TinCan.Utils.stringFromArrayBuffer=function(a,b){var c;return b||(b=TinCan.Utils.defaultEncoding),c=new TextDecoder(b),c.decode(a)}))})();
(function(e){function a(a){switch(typeof a){case "undefined":return"undefined";case "boolean":return"boolean";case "number":return"number";case "string":return"string";default:return null===a?"null":"object"}}function b(a){return Object.prototype.toString.call(a).replace(/^\[object *|\]$/g,"")}function c(a){return"function"==typeof a}function d(a){if(null===a||a===v)throw TypeError();return Object(a)}function f(a){function b(c){Object.defineProperty(a,c,{get:function(){return a._getter(c)},set:function(b){a._setter(c,
b)},enumerable:!0,configurable:!1})}if(!("TYPED_ARRAY_POLYFILL_NO_ARRAY_ACCESSORS"in e)){if(a.length>S)throw RangeError("Array too large for polyfill");var c;for(c=0;c<a.length;c+=1)b(c)}}function g(a,b){b=32-b;return a<<b>>b}function k(a,b){b=32-b;return a<<b>>>b}function l(a){return[255&a]}function m(a){return g(a[0],8)}function q(a){return[255&a]}function u(a){return k(a[0],8)}function t(a){return a=r(Number(a)),[0>a?0:255<a?255:255&a]}function w(a){return[255&a,a>>8&255]}function A(a){return g(a[1]<<
8|a[0],16)}function h(a){return[255&a,a>>8&255]}function n(a){return k(a[1]<<8|a[0],16)}function p(a){return[255&a,a>>8&255,a>>16&255,a>>24&255]}function I(a){return g(a[3]<<24|a[2]<<16|a[1]<<8|a[0],32)}function O(a){return[255&a,a>>8&255,a>>16&255,a>>24&255]}function F(a){return k(a[3]<<24|a[2]<<16|a[1]<<8|a[0],32)}function J(a,b,c){function d(a){var b=G(a);a-=b;return.5>a?b:.5<a?b+1:b%2?b+1:b}var e,h,f,g=(1<<b-1)-1;a!==a?(h=(1<<b)-1,f=y(2,c-1),e=0):a===1/0||a===-(1/0)?(h=(1<<b)-1,f=0,e=0>a?1:0):
0===a?(f=h=0,e=1/a===-(1/0)?1:0):(e=0>a,a=H(a),a>=y(2,1-g))?(h=z(G(U(a)/L),1023),f=a/y(2,h),1>f&&(--h,f*=2),2<=f&&(h+=1,f/=2),a=y(2,c),f=d(f*a)-a,h+=g,1<=f/a&&(h+=1,f=0),h>2*g&&(h=(1<<b)-1,f=0)):(h=0,f=d(a/y(2,1-g-c)));for(g=[];c;--c)g.push(f%2?1:0),f=G(f/2);for(c=b;c;--c)g.push(h%2?1:0),h=G(h/2);g.push(e?1:0);g.reverse();b=g.join("");for(e=[];b.length;)e.unshift(parseInt(b.substring(0,8),2)),b=b.substring(8);return e}function M(a,b,c){var d,e,h,f,g,n,p,l,k=[];for(d=0;d<a.length;++d)for(h=a[d],e=
8;e;--e)k.push(h%2?1:0),h>>=1;return k.reverse(),f=k.join(""),g=(1<<b-1)-1,n=parseInt(f.substring(0,1),2)?-1:1,p=parseInt(f.substring(1,1+b),2),l=parseInt(f.substring(1+b),2),p===(1<<b)-1?0!==l?NaN:1/0*n:0<p?n*y(2,p-g)*(1+l/y(2,c)):0!==l?n*y(2,-(g-1))*(l/y(2,c)):0>n?-0:0}function P(a){return M(a,11,52)}function Q(a){return J(a,11,52)}function R(a){return M(a,8,23)}function D(a){return J(a,8,23)}var v=void 0,S=1E5,L=Math.LN2,H=Math.abs,G=Math.floor,U=Math.log,E=Math.max,z=Math.min,y=Math.pow,r=Math.round;
!function(){var a=Object.defineProperty,b;try{b=Object.defineProperty({},"x",{})}catch(c){b=!1}a&&b||(Object.defineProperty=function(b,c,d){if(a)try{return a(b,c,d)}catch(e){}if(b!==Object(b))throw TypeError("Object.defineProperty called on non-object");return Object.prototype.__defineGetter__&&"get"in d&&Object.prototype.__defineGetter__.call(b,c,d.get),Object.prototype.__defineSetter__&&"set"in d&&Object.prototype.__defineSetter__.call(b,c,d.set),"value"in d&&(b[c]=d.value),b})}();(function(){function g(a){if(a>>=
0,0>a)throw RangeError("ArrayBuffer size is not a small enough positive integer.");Object.defineProperty(this,"byteLength",{value:a});Object.defineProperty(this,"_bytes",{value:Array(a)});for(var b=0;b<a;b+=1)this._bytes[b]=0}function k(){if(!arguments.length||"object"!=typeof arguments[0])return function(a){if(a>>=0,0>a)throw RangeError("length is not a small enough positive integer.");Object.defineProperty(this,"length",{value:a});Object.defineProperty(this,"byteLength",{value:a*this.BYTES_PER_ELEMENT});
Object.defineProperty(this,"buffer",{value:new g(this.byteLength)});Object.defineProperty(this,"byteOffset",{value:0})}.apply(this,arguments);if(1<=arguments.length&&"object"===a(arguments[0])&&arguments[0]instanceof k)return function(a){if(this.constructor!==a.constructor)throw TypeError();var b=a.length*this.BYTES_PER_ELEMENT;Object.defineProperty(this,"buffer",{value:new g(b)});Object.defineProperty(this,"byteLength",{value:b});Object.defineProperty(this,"byteOffset",{value:0});Object.defineProperty(this,
"length",{value:a.length});for(b=0;b<this.length;b+=1)this._setter(b,a._getter(b))}.apply(this,arguments);if(1<=arguments.length&&"object"===a(arguments[0])&&!(arguments[0]instanceof k)&&!(arguments[0]instanceof g||"ArrayBuffer"===b(arguments[0])))return function(a){var b=a.length*this.BYTES_PER_ELEMENT;Object.defineProperty(this,"buffer",{value:new g(b)});Object.defineProperty(this,"byteLength",{value:b});Object.defineProperty(this,"byteOffset",{value:0});Object.defineProperty(this,"length",{value:a.length});
for(b=0;b<this.length;b+=1)this._setter(b,Number(a[b]))}.apply(this,arguments);if(1<=arguments.length&&"object"===a(arguments[0])&&(arguments[0]instanceof g||"ArrayBuffer"===b(arguments[0])))return function(a,b,c){if(b>>>=0,b>a.byteLength)throw RangeError("byteOffset out of range");if(b%this.BYTES_PER_ELEMENT)throw RangeError("buffer length minus the byteOffset is not a multiple of the element size.");if(c===v){var d=a.byteLength-b;if(d%this.BYTES_PER_ELEMENT)throw RangeError("length of buffer minus byteOffset not a multiple of the element size");
c=d/this.BYTES_PER_ELEMENT}else c>>>=0,d=c*this.BYTES_PER_ELEMENT;if(b+d>a.byteLength)throw RangeError("byteOffset and length reference an area beyond the end of the buffer");Object.defineProperty(this,"buffer",{value:a});Object.defineProperty(this,"byteLength",{value:d});Object.defineProperty(this,"byteOffset",{value:b});Object.defineProperty(this,"length",{value:c})}.apply(this,arguments);throw TypeError();}function r(a,b,c){var d=function(){Object.defineProperty(this,"constructor",{value:d});k.apply(this,
arguments);f(this)};"__proto__"in d?d.__proto__=k:(d.from=k.from,d.of=k.of);d.BYTES_PER_ELEMENT=a;var e=function(){};return e.prototype=B,d.prototype=new e,Object.defineProperty(d.prototype,"BYTES_PER_ELEMENT",{value:a}),Object.defineProperty(d.prototype,"_pack",{value:b}),Object.defineProperty(d.prototype,"_unpack",{value:c}),d}e.ArrayBuffer=e.ArrayBuffer||g;Object.defineProperty(k,"from",{value:function(a){return new this(a)}});Object.defineProperty(k,"of",{value:function(){return new this(arguments)}});
var B={};k.prototype=B;Object.defineProperty(k.prototype,"_getter",{value:function(a){if(1>arguments.length)throw SyntaxError("Not enough arguments");if(a>>>=0,a>=this.length)return v;var b,c,d=[];b=0;for(c=this.byteOffset+a*this.BYTES_PER_ELEMENT;b<this.BYTES_PER_ELEMENT;b+=1,c+=1)d.push(this.buffer._bytes[c]);return this._unpack(d)}});Object.defineProperty(k.prototype,"get",{value:k.prototype._getter});Object.defineProperty(k.prototype,"_setter",{value:function(a,b){if(2>arguments.length)throw SyntaxError("Not enough arguments");
if(a>>>=0,!(a>=this.length)){var c,d,e=this._pack(b);c=0;for(d=this.byteOffset+a*this.BYTES_PER_ELEMENT;c<this.BYTES_PER_ELEMENT;c+=1,d+=1)this.buffer._bytes[d]=e[c]}}});Object.defineProperty(k.prototype,"constructor",{value:k});Object.defineProperty(k.prototype,"copyWithin",{value:function(a,b,c){var e=d(this),h=e.length>>>0,h=E(h,0);a>>=0;a=0>a?E(h+a,0):z(a,h);b>>=0;b=0>b?E(h+b,0):z(b,h);c=c===v?h:c>>0;c=0>c?E(h+c,0):z(c,h);var f,h=z(c-b,h-a);for(b<a&&a<b+h?(f=-1,b=b+h-1,a=a+h-1):f=1;0<h;)e._setter(a,
e._getter(b)),b+=f,a+=f,--h;return e}});Object.defineProperty(k.prototype,"every",{value:function(a,b){if(this===v||null===this)throw TypeError();var d=Object(this),e=d.length>>>0;if(!c(a))throw TypeError();for(var h=0;h<e;h++)if(!a.call(b,d._getter(h),h,d))return!1;return!0}});Object.defineProperty(k.prototype,"fill",{value:function(a,b,c){var e=d(this),h=e.length>>>0,h=E(h,0);b>>=0;b=0>b?E(h+b,0):z(b,h);c=c===v?h:c>>0;for(h=0>c?E(h+c,0):z(c,h);b<h;)e._setter(b,a),b+=1;return e}});Object.defineProperty(k.prototype,
"filter",{value:function(a,b){if(this===v||null===this)throw TypeError();var d=Object(this),e=d.length>>>0;if(!c(a))throw TypeError();for(var h=[],f=0;f<e;f++){var g=d._getter(f);a.call(b,g,f,d)&&h.push(g)}return new this.constructor(h)}});Object.defineProperty(k.prototype,"find",{value:function(a){var b=d(this),e=b.length>>>0;if(!c(a))throw TypeError();for(var h=1<arguments.length?arguments[1]:v,f=0;f<e;){var g=b._getter(f);if(a.call(h,g,f,b))return g;++f}return v}});Object.defineProperty(k.prototype,
"findIndex",{value:function(a){var b=d(this),e=b.length>>>0;if(!c(a))throw TypeError();for(var h=1<arguments.length?arguments[1]:v,f=0;f<e;){var g=b._getter(f);if(a.call(h,g,f,b))return f;++f}return-1}});Object.defineProperty(k.prototype,"forEach",{value:function(a,b){if(this===v||null===this)throw TypeError();var d=Object(this),e=d.length>>>0;if(!c(a))throw TypeError();for(var h=0;h<e;h++)a.call(b,d._getter(h),h,d)}});Object.defineProperty(k.prototype,"indexOf",{value:function(a){if(this===v||null===
this)throw TypeError();var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=0;if(0<arguments.length&&(d=Number(arguments[1]),d!==d?d=0:0!==d&&d!==1/0&&d!==-(1/0)&&(d=(0<d||-1)*G(H(d)))),d>=c)return-1;for(d=0<=d?d:E(c-H(d),0);d<c;d++)if(b._getter(d)===a)return d;return-1}});Object.defineProperty(k.prototype,"join",{value:function(a){if(this===v||null===this)throw TypeError();for(var b=Object(this),c=b.length>>>0,d=Array(c),e=0;e<c;++e)d[e]=b._getter(e);return d.join(a===v?",":a)}});Object.defineProperty(k.prototype,
"lastIndexOf",{value:function(a){if(this===v||null===this)throw TypeError();var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=c;1<arguments.length&&(d=Number(arguments[1]),d!==d?d=0:0!==d&&d!==1/0&&d!==-(1/0)&&(d=(0<d||-1)*G(H(d))));for(c=0<=d?z(d,c-1):c-H(d);0<=c;c--)if(b._getter(c)===a)return c;return-1}});Object.defineProperty(k.prototype,"map",{value:function(a,b){if(this===v||null===this)throw TypeError();var d=Object(this),e=d.length>>>0;if(!c(a))throw TypeError();var h=[];h.length=
e;for(var f=0;f<e;f++)h[f]=a.call(b,d._getter(f),f,d);return new this.constructor(h)}});Object.defineProperty(k.prototype,"reduce",{value:function(a){if(this===v||null===this)throw TypeError();var b=Object(this),d=b.length>>>0;if(!c(a))throw TypeError();if(0===d&&1===arguments.length)throw TypeError();var e,h=0;for(e=2<=arguments.length?arguments[1]:b._getter(h++);h<d;)e=a.call(v,e,b._getter(h),h,b),h++;return e}});Object.defineProperty(k.prototype,"reduceRight",{value:function(a){if(this===v||null===
this)throw TypeError();var b=Object(this),d=b.length>>>0;if(!c(a))throw TypeError();if(0===d&&1===arguments.length)throw TypeError();for(var e=d-1,d=2<=arguments.length?arguments[1]:b._getter(e--);0<=e;)d=a.call(v,d,b._getter(e),e,b),e--;return d}});Object.defineProperty(k.prototype,"reverse",{value:function(){if(this===v||null===this)throw TypeError();for(var a=Object(this),b=a.length>>>0,c=G(b/2),d=0,b=b-1;d<c;++d,--b){var e=a._getter(d);a._setter(d,a._getter(b));a._setter(b,e)}return a}});Object.defineProperty(k.prototype,
"set",{value:function(a,b){if(1>arguments.length)throw SyntaxError("Not enough arguments");var c,d,e,h,f,g;if("object"==typeof arguments[0]&&arguments[0].constructor===this.constructor){if(c=arguments[0],e=arguments[1]>>>0,e+c.length>this.length)throw RangeError("Offset plus length of array is out of range");if(h=this.byteOffset+e*this.BYTES_PER_ELEMENT,d=c.length*this.BYTES_PER_ELEMENT,c.buffer===this.buffer){e=[];f=0;for(g=c.byteOffset;f<d;f+=1,g+=1)e[f]=c.buffer._bytes[g];for(f=0;f<d;f+=1,h+=1)this.buffer._bytes[h]=
e[f]}else for(f=0,g=c.byteOffset;f<d;f+=1,g+=1,h+=1)this.buffer._bytes[h]=c.buffer._bytes[g]}else{if("object"!=typeof arguments[0]||"undefined"==typeof arguments[0].length)throw TypeError("Unexpected argument type(s)");if(d=arguments[0],h=d.length>>>0,e=arguments[1]>>>0,e+h>this.length)throw RangeError("Offset plus length of array is out of range");for(f=0;f<h;f+=1)g=d[f],this._setter(e+f,Number(g))}}});Object.defineProperty(k.prototype,"slice",{value:function(a,b){var c=d(this),e=c.length>>>0;a>>=
0;a=0>a?E(e+a,0):z(a,e);b=b===v?e:b>>0;e=0>b?E(e+b,0):z(b,e);b=new c.constructor(e-a);for(var h=0;a<e;){var f=c._getter(a);b._setter(h,f);++a;++h}return b}});Object.defineProperty(k.prototype,"some",{value:function(a,b){if(this===v||null===this)throw TypeError();var d=Object(this),e=d.length>>>0;if(!c(a))throw TypeError();for(var h=0;h<e;h++)if(a.call(b,d._getter(h),h,d))return!0;return!1}});Object.defineProperty(k.prototype,"sort",{value:function(a){if(this===v||null===this)throw TypeError();for(var b=
Object(this),c=b.length>>>0,d=Array(c),e=0;e<c;++e)d[e]=b._getter(e);a?d.sort(a):d.sort();for(e=0;e<c;++e)b._setter(e,d[e]);return b}});Object.defineProperty(k.prototype,"subarray",{value:function(a,b){a>>=0;b>>=0;1>arguments.length&&(a=0);2>arguments.length&&(b=this.length);0>a&&(a=this.length+a);0>b&&(b=this.length+b);var c=this.length;a=0>a?0:a>c?c:a;c=this.length;c=(0>b?0:b>c?c:b)-a;return 0>c&&(c=0),new this.constructor(this.buffer,this.byteOffset+a*this.BYTES_PER_ELEMENT,c)}});var y=r(1,l,m),
N=r(1,q,u),K=r(1,t,u),Y=r(2,w,A),W=r(2,h,n),X=r(4,p,I),Z=r(4,O,F),aa=r(4,D,R),ba=r(8,Q,P);e.Int8Array=e.Int8Array||y;e.Uint8Array=e.Uint8Array||N;e.Uint8ClampedArray=e.Uint8ClampedArray||K;e.Int16Array=e.Int16Array||Y;e.Uint16Array=e.Uint16Array||W;e.Int32Array=e.Int32Array||X;e.Uint32Array=e.Uint32Array||Z;e.Float32Array=e.Float32Array||aa;e.Float64Array=e.Float64Array||ba})();(function(){function a(b,d){return c(b.get)?b.get(d):b[d]}function d(a,c,e){if(!(a instanceof ArrayBuffer||"ArrayBuffer"===
b(a)))throw TypeError();if(c>>>=0,c>a.byteLength)throw RangeError("byteOffset out of range");if(e=e===v?a.byteLength-c:e>>>0,c+e>a.byteLength)throw RangeError("byteOffset and length reference an area beyond the end of the buffer");Object.defineProperty(this,"buffer",{value:a});Object.defineProperty(this,"byteLength",{value:e});Object.defineProperty(this,"byteOffset",{value:c})}function h(b){return function(c,d){if(c>>>=0,c+b.BYTES_PER_ELEMENT>this.byteLength)throw RangeError("Array index out of range");
c+=this.byteOffset;c=new Uint8Array(this.buffer,c,b.BYTES_PER_ELEMENT);for(var e=[],h=0;h<b.BYTES_PER_ELEMENT;h+=1)e.push(a(c,h));return!!d===!!g&&e.reverse(),a(new b((new Uint8Array(e)).buffer),0)}}function f(b){return function(c,d,e){if(c>>>=0,c+b.BYTES_PER_ELEMENT>this.byteLength)throw RangeError("Array index out of range");d=new b([d]);var h=new Uint8Array(d.buffer),f=[];for(d=0;d<b.BYTES_PER_ELEMENT;d+=1)f.push(a(h,d));!!e===!!g&&f.reverse();(new Uint8Array(this.buffer,c,b.BYTES_PER_ELEMENT)).set(f)}}
var g=function(){var b=new Uint16Array([4660]),b=new Uint8Array(b.buffer);return 18===a(b,0)}();Object.defineProperty(d.prototype,"getUint8",{value:h(Uint8Array)});Object.defineProperty(d.prototype,"getInt8",{value:h(Int8Array)});Object.defineProperty(d.prototype,"getUint16",{value:h(Uint16Array)});Object.defineProperty(d.prototype,"getInt16",{value:h(Int16Array)});Object.defineProperty(d.prototype,"getUint32",{value:h(Uint32Array)});Object.defineProperty(d.prototype,"getInt32",{value:h(Int32Array)});
Object.defineProperty(d.prototype,"getFloat32",{value:h(Float32Array)});Object.defineProperty(d.prototype,"getFloat64",{value:h(Float64Array)});Object.defineProperty(d.prototype,"setUint8",{value:f(Uint8Array)});Object.defineProperty(d.prototype,"setInt8",{value:f(Int8Array)});Object.defineProperty(d.prototype,"setUint16",{value:f(Uint16Array)});Object.defineProperty(d.prototype,"setInt16",{value:f(Int16Array)});Object.defineProperty(d.prototype,"setUint32",{value:f(Uint32Array)});Object.defineProperty(d.prototype,
"setInt32",{value:f(Int32Array)});Object.defineProperty(d.prototype,"setFloat32",{value:f(Float32Array)});Object.defineProperty(d.prototype,"setFloat64",{value:f(Float64Array)});e.DataView=e.DataView||d})()})(self);
(function(e){function a(a,c){return a=0|a||0,0>a?Math.max(a+c,0):Math.min(a,c)}ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=function(b,c){var d=this.byteLength;b=a(b,d);var f=d;if(c!==e&&(f=a(c,d)),b>f)return new ArrayBuffer(0);f-=b;c=new ArrayBuffer(f);d=new Uint8Array(c);b=new Uint8Array(this,b,f);return d.set(b),c})})();"undefined"!=typeof module&&module.exports&&(this["encoding-indexes"]=require("./encoding-indexes.js")["encoding-indexes"]);
(function(e){function a(a,b,c){return b<=a&&a<=c}function b(a){if(void 0===a)return{};if(a===Object(a))return a;throw TypeError("Could not convert argument to dictionary");}function c(a){return 0<=a&&127>=a}function d(a){this.tokens=[].slice.call(a);this.tokens.reverse()}function f(a,b){if(a)throw TypeError("Decoder error");return b||65533}function g(a){throw TypeError("The code point "+a+" could not be encoded.");}function k(a){return a=String(a).trim().toLowerCase(),Object.prototype.hasOwnProperty.call(T,
a)?T[a]:null}function l(a,b){return b?b[a]||null:null}function m(a,b){a=b.indexOf(a);return-1===a?null:a}function q(a){if(!("encoding-indexes"in e))throw Error("Indexes missing. Did you forget to include encoding-indexes.js?");return e["encoding-indexes"][a]}function u(a,c){if(!(this instanceof u))throw TypeError("Called as a function. Did you forget 'new'?");a=void 0!==a?String(a):N;c=b(c);this._decoder=this._encoding=null;this._BOMseen=this._ignoreBOM=!1;this._error_mode="replacement";this._do_not_flush=
!1;var d=k(a);if(null===d||"replacement"===d.name)throw RangeError("Unknown encoding: "+a);if(!C[d.name])throw Error("Decoder not present. Did you forget to include encoding-indexes.js?");return this._encoding=d,!!c.fatal&&(this._error_mode="fatal"),!!c.ignoreBOM&&(this._ignoreBOM=!0),Object.defineProperty||(this.encoding=this._encoding.name.toLowerCase(),this.fatal="fatal"===this._error_mode,this.ignoreBOM=this._ignoreBOM),this}function t(a,c){if(!(this instanceof t))throw TypeError("Called as a function. Did you forget 'new'?");
c=b(c);this._encoder=this._encoding=null;this._do_not_flush=!1;this._fatal=c.fatal?"fatal":"replacement";if(c.NONSTANDARD_allowLegacyEncoding){a=void 0!==a?String(a):N;c=k(a);if(null===c||"replacement"===c.name)throw RangeError("Unknown encoding: "+a);if(!B[c.name])throw Error("Encoder not present. Did you forget to include encoding-indexes.js?");this._encoding=c}else this._encoding=k("utf-8");return Object.defineProperty||(this.encoding=this._encoding.name.toLowerCase()),this}function w(b){var c=
b.fatal,d=0,e=0,h=0,g=128,n=191;this.handler=function(b,p){if(p===r&&0!==h)return h=0,f(c);if(p===r)return x;if(0===h){if(a(p,0,127))return p;if(a(p,194,223))h=1,d=p-192;else if(a(p,224,239))224===p&&(g=160),237===p&&(n=159),h=2,d=p-224;else{if(!a(p,240,244))return f(c);240===p&&(g=144);244===p&&(n=143);h=3;d=p-240}return d<<=6*h,null}if(!a(p,g,n))return d=h=e=0,g=128,n=191,b.prepend(p),f(c);if(g=128,n=191,e+=1,d+=p-128<<6*(h-e),e!==h)return null;b=d;return d=h=e=0,b}}function A(b){b.fatal;this.handler=
function(b,c){if(c===r)return x;if(a(c,0,127))return c;var d,e;a(c,128,2047)?(d=1,e=192):a(c,2048,65535)?(d=2,e=224):a(c,65536,1114111)&&(d=3,e=240);for(b=[(c>>6*d)+e];0<d;)b.push(128|63&c>>6*(d-1)),--d;return b}}function h(a,b){var d=b.fatal;this.handler=function(b,e){if(e===r)return x;if(c(e))return e;b=a[e-128];return null===b?f(d):b}}function n(a,b){b.fatal;this.handler=function(b,c){if(c===r)return x;if(y(c))return c;b=m(c,a);return null===b&&g(c),b+128}}function p(b){var d=b.fatal,e=0,h=0,g=
0;this.handler=function(b,n){if(n===r&&0===e&&0===h&&0===g)return x;n!==r||0===e&&0===h&&0===g||(e=0,h=0,g=0,f(d));var p;if(0!==g){p=null;if(a(n,48,57))if(p=10*(126*(10*(e-129)+(h-48))+(g-129))+n-48,39419<p&&189E3>p||1237575<p)p=null;else if(7457===p)p=59335;else{var k,m=0,K=0,I=q("gb18030");for(k=0;k<I.length;++k){var F=I[k];if(!(F[0]<=p))break;m=F[0];K=F[1]}p=K+p-m}n=[h,g,n];return e=0,h=0,g=0,null===p?(b.prepend(n),f(d)):p}if(0!==h)return a(n,129,254)?(g=n,null):(b.prepend([h,n]),e=0,h=0,f(d));
if(0!==e){if(a(n,48,57))return h=n,null;k=e;m=null;e=0;K=127>n?64:65;return(a(n,64,126)||a(n,128,254))&&(m=190*(k-129)+(n-K)),p=null===m?null:l(m,q("gb18030")),null===p&&c(n)&&b.prepend(n),null===p?f(d):p}return c(n)?n:128===n?8364:a(n,129,254)?(e=n,null):f(d)}}function I(a,b){a.fatal;this.handler=function(a,c){if(c===r)return x;if(y(c))return c;if(58853===c)return g(c);if(b&&8364===c)return 128;a=m(c,q("gb18030"));if(null!==a)return c=z(a/190)+129,a%=190,[c,a+(63>a?64:65)];if(b)return g(c);if(59335===
c)a=7457;else{var d=0,e=0,h=q("gb18030");for(a=0;a<h.length;++a){var f=h[a];if(!(f[1]<=c))break;d=f[1];e=f[0]}a=e+c-d}c=z(a/10/126/10);a-=12600*c;d=z(a/10/126);a-=1260*d;e=z(a/10);return[c+129,d+48,e+129,a-10*e+48]}}function O(b){var d=b.fatal,e=0;this.handler=function(b,h){if(h===r&&0!==e)return e=0,f(d);if(h===r&&0===e)return x;if(0!==e){var g=e,n=null;e=0;var p=127>h?64:98;switch((a(h,64,126)||a(h,161,254))&&(n=157*(g-129)+(h-p)),n){case 1133:return[202,772];case 1135:return[202,780];case 1164:return[234,
772];case 1166:return[234,780]}g=null===n?null:l(n,q("big5"));return null===g&&c(h)&&b.prepend(h),null===g?f(d):g}return c(h)?h:a(h,129,254)?(e=h,null):f(d)}}function F(a){a.fatal;this.handler=function(a,b){if(b===r)return x;if(y(b))return b;var c;a=q("big5");c=9552===b||9566===b||9569===b||9578===b||21313===b||21317===b?a.lastIndexOf(b):m(b,a);if(null===c)return g(b);a=z(c/157)+129;if(161>a)return g(b);b=c%157;return[a,b+(63>b?64:98)]}}function J(b){var d=b.fatal,e=!1,h=0;this.handler=function(b,
g){if(g===r&&0!==h)return h=0,f(d);if(g===r&&0===h)return x;if(142===h&&a(g,161,223))return h=0,65377+g-161;if(143===h&&a(g,161,254))return e=!0,h=g,null;if(0!==h){var n=h;h=0;var p=null;return a(n,161,254)&&a(g,161,254)&&(p=l(94*(n-161)+(g-161),q(e?"jis0212":"jis0208"))),e=!1,a(g,161,254)||b.prepend(g),null===p?f(d):p}return c(g)?g:142===g||143===g||a(g,161,254)?(h=g,null):f(d)}}function M(b){b.fatal;this.handler=function(b,c){if(c===r)return x;if(y(c))return c;if(165===c)return 92;if(8254===c)return 126;
if(a(c,65377,65439))return[142,c-65377+161];8722===c&&(c=65293);b=m(c,q("jis0208"));return null===b?g(c):[z(b/94)+161,b%94+161]}}function P(b){var c=b.fatal,d=0,e=0,h=!1;this.handler=function(b,g){switch(d){default:case 0:return 27===g?(d=5,null):a(g,0,127)&&14!==g&&15!==g&&27!==g?(h=!1,g):g===r?x:(h=!1,f(c));case 1:return 27===g?(d=5,null):92===g?(h=!1,165):126===g?(h=!1,8254):a(g,0,127)&&14!==g&&15!==g&&27!==g&&92!==g&&126!==g?(h=!1,g):g===r?x:(h=!1,f(c));case 2:return 27===g?(d=5,null):a(g,33,
95)?(h=!1,65377+g-33):g===r?x:(h=!1,f(c));case 3:return 27===g?(d=5,null):a(g,33,126)?(h=!1,e=g,d=4,null):g===r?x:(h=!1,f(c));case 4:return 27===g?(d=5,f(c)):a(g,33,126)?(d=3,b=l(94*(e-33)+g-33,q("jis0208")),null===b?f(c):b):g===r?(d=3,b.prepend(g),f(c)):(d=3,f(c));case 5:return 36===g||40===g?(e=g,d=6,null):(b.prepend(g),h=!1,d=0,f(c));case 6:var n=e;e=0;var p=null;return(40===n&&66===g&&(p=0),40===n&&74===g&&(p=1),40===n&&73===g&&(p=2),36!==n||64!==g&&66!==g||(p=3),null!==p)?(d=d=p,b=h,h=!0,b?f(c):
null):(b.prepend([n,g]),h=!1,d=0,f(c))}}}function Q(a){var b=(a.fatal,{ASCII:0,Roman:1,jis0208:2}),c=b.ASCII;this.handler=function(a,d){if(d===r&&c!==b.ASCII)return a.prepend(d),c=b.ASCII,[27,40,66];if(d===r&&c===b.ASCII)return x;if(!(c!==b.ASCII&&c!==b.Roman||14!==d&&15!==d&&27!==d))return g(65533);if(c===b.ASCII&&y(d))return d;if(c===b.Roman&&(y(d)&&92!==d&&126!==d||165==d||8254==d)){if(y(d))return d;if(165===d)return 92;if(8254===d)return 126}if(y(d)&&c!==b.ASCII)return a.prepend(d),c=b.ASCII,
[27,40,66];if((165===d||8254===d)&&c!==b.Roman)return a.prepend(d),c=b.Roman,[27,40,74];8722===d&&(d=65293);var e=m(d,q("jis0208"));return null===e?g(d):c!==b.jis0208?(a.prepend(d),c=b.jis0208,[27,36,66]):[z(e/94)+33,e%94+33]}}function R(b){var d=b.fatal,e=0;this.handler=function(b,h){if(h===r&&0!==e)return e=0,f(d);if(h===r&&0===e)return x;if(0!==e){var g=e,n=null;e=0;var p=127>h?64:65,k=160>g?129:193;(a(h,64,126)||a(h,128,252))&&(n=188*(g-k)+h-p);g=null===n?null:l(n,q("jis0208"));return null===
g&&null!==n&&a(n,8836,10528)?57344+n-8836:(null===g&&c(h)&&b.prepend(h),null===g?f(d):g)}return c(h)||128===h?h:a(h,161,223)?65377+h-161:a(h,129,159)||a(h,224,252)?(e=h,null):f(d)}}function D(b){b.fatal;this.handler=function(b,c){if(c===r)return x;if(y(c)||128===c)return c;if(165===c)return 92;if(8254===c)return 126;if(a(c,65377,65439))return c-65377+161;8722===c&&(c=65293);b=m(c,q("jis0208"));b=null===b||a(b,8272,8835)?null:b;if(null===b)return g(c);c=z(b/188);b%=188;return[c+(31>c?129:193),b+(63>
b?64:65)]}}function v(b){var d=b.fatal,e=0;this.handler=function(b,h){if(h===r&&0!==e)return e=0,f(d);if(h===r&&0===e)return x;if(0!==e){var g=e,n=null;e=0;a(h,65,254)&&(n=190*(g-129)+(h-65));g=null===n?null:l(n,q("euc-kr"));return null===n&&c(h)&&b.prepend(h),null===g?f(d):g}return c(h)?h:a(h,129,254)?(e=h,null):f(d)}}function S(a){a.fatal;this.handler=function(a,b){if(b===r)return x;if(y(b))return b;a=m(b,q("euc-kr"));return null===a?g(b):[z(a/190)+129,a%190+65]}}function L(a,b){var c=a>>8;a&=255;
return b?[c,a]:[a,c]}function H(b,c){var d=c.fatal,e=null,h=null;this.handler=function(c,g){if(g===r&&(null!==e||null!==h))return f(d);if(g===r&&null===e&&null===h)return x;if(null===e)return e=g,null;if(g=b?(e<<8)+g:(g<<8)+e,e=null,null!==h){var n=h;return h=null,a(g,56320,57343)?65536+1024*(n-55296)+(g-56320):(c.prepend(L(g,b)),f(d))}return a(g,55296,56319)?(h=g,null):a(g,56320,57343)?f(d):g}}function G(b,c){c.fatal;this.handler=function(c,d){if(d===r)return x;if(a(d,0,65535))return L(d,b);c=L((d-
65536>>10)+55296,b);d=L((d-65536&1023)+56320,b);return c.concat(d)}}function U(a){a.fatal;this.handler=function(a,b){return b===r?x:c(b)?b:63360+b-128}}function E(b){b.fatal;this.handler=function(b,c){return c===r?x:y(c)?c:a(c,63360,63487)?c-63360+128:g(c)}}var z=Math.floor,y=c,r=-1;d.prototype={endOfStream:function(){return!this.tokens.length},read:function(){return this.tokens.length?this.tokens.pop():r},prepend:function(a){if(Array.isArray(a))for(;a.length;)this.tokens.push(a.pop());else this.tokens.push(a)},
push:function(a){if(Array.isArray(a))for(;a.length;)this.tokens.unshift(a.shift());else this.tokens.unshift(a)}};var x=-1,V=[{encodings:[{labels:["unicode-1-1-utf-8","utf-8","utf8"],name:"UTF-8"}],heading:"The Encoding"},{encodings:[{labels:["866","cp866","csibm866","ibm866"],name:"IBM866"},{labels:"csisolatin2 iso-8859-2 iso-ir-101 iso8859-2 iso88592 iso_8859-2 iso_8859-2:1987 l2 latin2".split(" "),name:"ISO-8859-2"},{labels:"csisolatin3 iso-8859-3 iso-ir-109 iso8859-3 iso88593 iso_8859-3 iso_8859-3:1988 l3 latin3".split(" "),
name:"ISO-8859-3"},{labels:"csisolatin4 iso-8859-4 iso-ir-110 iso8859-4 iso88594 iso_8859-4 iso_8859-4:1988 l4 latin4".split(" "),name:"ISO-8859-4"},{labels:"csisolatincyrillic cyrillic iso-8859-5 iso-ir-144 iso8859-5 iso88595 iso_8859-5 iso_8859-5:1988".split(" "),name:"ISO-8859-5"},{labels:"arabic asmo-708 csiso88596e csiso88596i csisolatinarabic ecma-114 iso-8859-6 iso-8859-6-e iso-8859-6-i iso-ir-127 iso8859-6 iso88596 iso_8859-6 iso_8859-6:1987".split(" "),name:"ISO-8859-6"},{labels:"csisolatingreek ecma-118 elot_928 greek greek8 iso-8859-7 iso-ir-126 iso8859-7 iso88597 iso_8859-7 iso_8859-7:1987 sun_eu_greek".split(" "),
name:"ISO-8859-7"},{labels:"csiso88598e csisolatinhebrew hebrew iso-8859-8 iso-8859-8-e iso-ir-138 iso8859-8 iso88598 iso_8859-8 iso_8859-8:1988 visual".split(" "),name:"ISO-8859-8"},{labels:["csiso88598i","iso-8859-8-i","logical"],name:"ISO-8859-8-I"},{labels:"csisolatin6 iso-8859-10 iso-ir-157 iso8859-10 iso885910 l6 latin6".split(" "),name:"ISO-8859-10"},{labels:["iso-8859-13","iso8859-13","iso885913"],name:"ISO-8859-13"},{labels:["iso-8859-14","iso8859-14","iso885914"],name:"ISO-8859-14"},{labels:"csisolatin9 iso-8859-15 iso8859-15 iso885915 iso_8859-15 l9".split(" "),
name:"ISO-8859-15"},{labels:["iso-8859-16"],name:"ISO-8859-16"},{labels:["cskoi8r","koi","koi8","koi8-r","koi8_r"],name:"KOI8-R"},{labels:["koi8-ru","koi8-u"],name:"KOI8-U"},{labels:["csmacintosh","mac","macintosh","x-mac-roman"],name:"macintosh"},{labels:"dos-874 iso-8859-11 iso8859-11 iso885911 tis-620 windows-874".split(" "),name:"windows-874"},{labels:["cp1250","windows-1250","x-cp1250"],name:"windows-1250"},{labels:["cp1251","windows-1251","x-cp1251"],name:"windows-1251"},{labels:"ansi_x3.4-1968 ascii cp1252 cp819 csisolatin1 ibm819 iso-8859-1 iso-ir-100 iso8859-1 iso88591 iso_8859-1 iso_8859-1:1987 l1 latin1 us-ascii windows-1252 x-cp1252".split(" "),
name:"windows-1252"},{labels:["cp1253","windows-1253","x-cp1253"],name:"windows-1253"},{labels:"cp1254 csisolatin5 iso-8859-9 iso-ir-148 iso8859-9 iso88599 iso_8859-9 iso_8859-9:1989 l5 latin5 windows-1254 x-cp1254".split(" "),name:"windows-1254"},{labels:["cp1255","windows-1255","x-cp1255"],name:"windows-1255"},{labels:["cp1256","windows-1256","x-cp1256"],name:"windows-1256"},{labels:["cp1257","windows-1257","x-cp1257"],name:"windows-1257"},{labels:["cp1258","windows-1258","x-cp1258"],name:"windows-1258"},
{labels:["x-mac-cyrillic","x-mac-ukrainian"],name:"x-mac-cyrillic"}],heading:"Legacy single-byte encodings"},{encodings:[{labels:"chinese csgb2312 csiso58gb231280 gb2312 gb_2312 gb_2312-80 gbk iso-ir-58 x-gbk".split(" "),name:"GBK"},{labels:["gb18030"],name:"gb18030"}],heading:"Legacy multi-byte Chinese (simplified) encodings"},{encodings:[{labels:["big5","big5-hkscs","cn-big5","csbig5","x-x-big5"],name:"Big5"}],heading:"Legacy multi-byte Chinese (traditional) encodings"},{encodings:[{labels:["cseucpkdfmtjapanese",
"euc-jp","x-euc-jp"],name:"EUC-JP"},{labels:["csiso2022jp","iso-2022-jp"],name:"ISO-2022-JP"},{labels:"csshiftjis ms932 ms_kanji shift-jis shift_jis sjis windows-31j x-sjis".split(" "),name:"Shift_JIS"}],heading:"Legacy multi-byte Japanese encodings"},{encodings:[{labels:"cseuckr csksc56011987 euc-kr iso-ir-149 korean ks_c_5601-1987 ks_c_5601-1989 ksc5601 ksc_5601 windows-949".split(" "),name:"EUC-KR"}],heading:"Legacy multi-byte Korean encodings"},{encodings:[{labels:["csiso2022kr","hz-gb-2312",
"iso-2022-cn","iso-2022-cn-ext","iso-2022-kr"],name:"replacement"},{labels:["utf-16be"],name:"UTF-16BE"},{labels:["utf-16","utf-16le"],name:"UTF-16LE"},{labels:["x-user-defined"],name:"x-user-defined"}],heading:"Legacy miscellaneous encodings"}],T={};V.forEach(function(a){a.encodings.forEach(function(a){a.labels.forEach(function(b){T[b]=a})})});var B={},C={},N="utf-8";Object.defineProperty&&(Object.defineProperty(u.prototype,"encoding",{get:function(){return this._encoding.name.toLowerCase()}}),Object.defineProperty(u.prototype,
"fatal",{get:function(){return"fatal"===this._error_mode}}),Object.defineProperty(u.prototype,"ignoreBOM",{get:function(){return this._ignoreBOM}}));u.prototype.decode=function(a,c){a="object"==typeof a&&a instanceof ArrayBuffer?new Uint8Array(a):"object"==typeof a&&"buffer"in a&&a.buffer instanceof ArrayBuffer?new Uint8Array(a.buffer,a.byteOffset,a.byteLength):new Uint8Array(0);c=b(c);this._do_not_flush||(this._decoder=C[this._encoding.name]({fatal:"fatal"===this._error_mode}),this._BOMseen=!1);
this._do_not_flush=!!c.stream;var e;a=new d(a);for(c=[];;){var h=a.read();if(h===r)break;if(e=this._decoder.handler(a,h),e===x)break;null!==e&&(Array.isArray(e)?c.push.apply(c,e):c.push(e))}if(!this._do_not_flush){do{if(e=this._decoder.handler(a,a.read()),e===x)break;null!==e&&(Array.isArray(e)?c.push.apply(c,e):c.push(e))}while(!a.endOfStream());this._decoder=null}-1===["UTF-8","UTF-16LE","UTF-16BE"].indexOf(this._encoding.name)||this._ignoreBOM||this._BOMseen||(0<c.length&&65279===c[0]?(this._BOMseen=
!0,c.shift()):0<c.length&&(this._BOMseen=!0));e="";for(a=0;a<c.length;++a)h=c[a],65535>=h?e+=String.fromCharCode(h):(h-=65536,e+=String.fromCharCode((h>>10)+55296,(1023&h)+56320));return e};Object.defineProperty&&Object.defineProperty(t.prototype,"encoding",{get:function(){return this._encoding.name.toLowerCase()}});t.prototype.encode=function(a,c){a=a?String(a):"";c=b(c);this._do_not_flush||(this._encoder=B[this._encoding.name]({fatal:"fatal"===this._fatal}));this._do_not_flush=!!c.stream;var e;
c=String(a);for(var h=c.length,f=0,g=[];f<h;){var n=c.charCodeAt(f);if(55296>n||57343<n)g.push(n);else if(56320<=n&&57343>=n)g.push(65533);else if(55296<=n&&56319>=n)if(f===h-1)g.push(65533);else{var p=a.charCodeAt(f+1);56320<=p&&57343>=p?(g.push(65536+((1023&n)<<10)+(1023&p)),f+=1):g.push(65533)}f+=1}a=new d(g);for(c=[];;){h=a.read();if(h===r)break;if(e=this._encoder.handler(a,h),e===x)break;Array.isArray(e)?c.push.apply(c,e):c.push(e)}if(!this._do_not_flush){for(;e=this._encoder.handler(a,a.read()),
e!==x;)Array.isArray(e)?c.push.apply(c,e):c.push(e);this._encoder=null}return new Uint8Array(c)};B["UTF-8"]=function(a){return new A(a)};C["UTF-8"]=function(a){return new w(a)};(function(){"encoding-indexes"in e&&V.forEach(function(a){"Legacy single-byte encodings"===a.heading&&a.encodings.forEach(function(a){a=a.name;var b=q(a.toLowerCase());C[a]=function(a){return new h(b,a)};B[a]=function(a){return new n(b,a)}})})})();C.GBK=function(a){return new p(a)};B.GBK=function(a){return new I(a,!0)};B.gb18030=
function(a){return new I(a)};C.gb18030=function(a){return new p(a)};B.Big5=function(a){return new F(a)};C.Big5=function(a){return new O(a)};B["EUC-JP"]=function(a){return new M(a)};C["EUC-JP"]=function(a){return new J(a)};B["ISO-2022-JP"]=function(a){return new Q(a)};C["ISO-2022-JP"]=function(a){return new P(a)};B.Shift_JIS=function(a){return new D(a)};C.Shift_JIS=function(a){return new R(a)};B["EUC-KR"]=function(a){return new S(a)};C["EUC-KR"]=function(a){return new v(a)};B["UTF-16BE"]=function(a){return new G(!0,
a)};C["UTF-16BE"]=function(a){return new H(!0,a)};B["UTF-16LE"]=function(a){return new G(!1,a)};C["UTF-16LE"]=function(a){return new H(!1,a)};B["x-user-defined"]=function(a){return new E(a)};C["x-user-defined"]=function(a){return new U(a)};e.TextEncoder||(e.TextEncoder=t);e.TextDecoder||(e.TextDecoder=u);"undefined"!=typeof module&&module.exports&&(module.exports={TextEncoder:e.TextEncoder,TextDecoder:e.TextDecoder,EncodingIndexes:e["encoding-indexes"]})})(this);
var xapiActivity={id:ANALYTICS_COURSE_ID,definition:{name:ANALYTICS_COURSE_NAME,description:ANALYTICS_COURSE_DESC}},verbMap={experienced:{id:"http://adlnet.gov/expapi/verbs/experienced",display:{"en-US":"experienced"}},attended:{id:"http://adlnet.gov/expapi/verbs/attended",display:{"en-US":"attended"}},attempted:{id:"http://adlnet.gov/expapi/verbs/attempted",display:{"en-US":"attempted"}},completed:{id:"http://adlnet.gov/expapi/verbs/completed",display:{"en-US":"completed"}},passed:{id:"http://adlnet.gov/expapi/verbs/passed",
display:{"en-US":"passed"}},failed:{id:"http://adlnet.gov/expapi/verbs/failed",display:{"en-US":"failed"}},answered:{id:"http://adlnet.gov/expapi/verbs/answered",display:{"en-US":"answered"}},interacted:{id:"http://adlnet.gov/expapi/verbs/interacted",display:{"en-US":"interacted"}},imported:{id:"http://adlnet.gov/expapi/verbs/imported",display:{"en-US":"imported"}},created:{id:"http://adlnet.gov/expapi/verbs/created",display:{"en-US":"created"}},shared:{id:"http://adlnet.gov/expapi/verbs/shared",
display:{"en-US":"shared"}},voided:{id:"http://adlnet.gov/expapi/verbs/voided",display:{"en-US":"voided"}},objectiveCompleted:{id:"http://www.dominknow.com/xapi/verbs/objective_complete",display:{"en-US":"completed the objective"}}};
$(document).ready(function(){$(document).on(DKI.DataStorage.events.beforeReady,function(){if("undefined"!=typeof ANALYTICS_RECORD_STORES&&ANALYTICS_RECORD_STORES){var e=!1;if("undefined"!=typeof ANALYTICS_USE_QUERY_STRING_ENDPOINT&&ANALYTICS_USE_QUERY_STRING_ENDPOINT){var a=DKI.getURLParameters();a.endpoint&&a.auth&&ANALYTICS_RECORD_STORES.push({endpoint:decodeURIComponent(a.endpoint),auth:decodeURIComponent(a.auth)});if(a.actor)try{e=TinCan.Agent.fromJSON(decodeURIComponent(a.actor))}catch(b){e=
!1}}if(0<ANALYTICS_RECORD_STORES.length&&(e||(e=dataStorage.getUserID(),e=xAPIFunctions.getActor(e)),courseStructure&&courseStructure.model_id))switch(courseStructure.model_id){case 5:xapiActivity.definition.type="http://adlnet.gov/expapi/activities/assessment";break;case 7:xapiActivity.definition.type="http://id.tincanapi.com/activitytype/scenario";break;case 8:xapiActivity.definition.type="http://adlnet.gov/expapi/activities/simulation";break;case 20:xapiActivity.definition.type="https://w3id.org/xapi/acrossx/activities/video";
break;case 21:xapiActivity.definition.type="http://activitystrea.ms/schema/1.0/game";break;default:xapiActivity.definition.type="http://adlnet.gov/expapi/activities/course"}tc=new TinCan({url:location.href,recordStores:ANALYTICS_RECORD_STORES,activity:xapiActivity,actor:e});setupAnalyticsTriggers()}setupXAPITriggers()})});
var setupAnalyticsTriggers=function(){var e=!1,a="";contentApi.sendAnalyticsStatement({verb:verbMap.attempted,inProgress:!0});$(dataStorage).on(DKI.DataStorage.events.pageSelected,function(a,b){c(b.page)});$(dataStorage).bind(DKI.DataStorage.events.courseCompleted,function(){e=!0;setTimeout(d,10)});$(dataStorage).bind(DKI.DataStorage.events.assessmentCompleted,function(){e=!0;dataStorage.courseStructure.testonly&&((nextModule=dataStorage.getNextModule(dataStorage.assessment.module))?f(settings.useExternalIdsForScorm?
nextModule.external_id:nextModule.loid,nextModule.name,"module"):f("",""));c()});$(dataStorage).bind(DKI.DataStorage.events.questionScored,function(a,b){if(playerBehaviour.recordInteractions){a=b.question;var c=b.questionObject,d=b.score;b=b.test;c.questionOptions=a.options;c.id=settings.useExternalIdsForScorm?a.id:a.external_id;c.score=d;c.weight=a.weight;c.question=a;c.title=a.title;switch(c.type){case 1:xapiFunctions.recordTrueFalse(c);break;case 2:xapiFunctions.recordMultipleChoice(c);break;case 3:xapiFunctions.recordFreeForm(c);
break;case 4:xapiFunctions.recordFillBlanks(c);break;case 5:xapiFunctions.recordPulldown(c);break;case 6:xapiFunctions.recordDragDrop(c);break;case 8:xapiFunctions.recordCapture(c);break;case 9:xapiFunctions.recordImageMap(c,b);break;case 10:xapiFunctions.recordScenario(c,b);break;case 11:xapiFunctions.recordMatchingQuestion(c,b);break;case 12:xapiFunctions.recordSequencing(c,b);break;case 13:xapiFunctions.recordMultipleChoice(c);break;case 14:xapiFunctions.recordFillInTheBlanksWidget(c,b)}}});var b=
function(){for(var a,b,c={i:[],m:[],o:[],s:[],t:[]},d=0;d<dataStorage.courseStructure.modules.length;d++){a=dataStorage.courseStructure.modules[d];dataStorage.courseStructure.modules[d].invalidated&&(c.i[c.i.length]=a.loid);if(a.complete)c.m[c.m.length]=a.loid;else for(var e=0;e<a.objects.length;e++)if(b=a.objects[e],b.complete)c.o[c.o.length]=b.objectid;else for(var f=0;f<b.subeos.length;f++)b.subeos[f].complete&&(c.s[c.s.length]=b.subeos[f].subeoid);if(a.pre||a.post)b={id:settings.useExternalIdsForScorm?
a.external_id:a.loid},a.pre&&(b.pre=a.pre),a.post&&(b.post=a.post),c.t[c.t.length]=b}a={completion:c};a.contentVariables=dataStorage.storedContentVariables;return JSON.stringify(a)},c=function(a){dataStorage.getCourseCompletion(!0);var c=b();a&&f(settings.useExternalIdsForScorm?a.external_id:a.id,a.title,"page");tc.setState("suspend_data",c,{callback:function(){}});d()},d=function(){if(e){var b=dataStorage.lessonStatus,c=!1,d=dataStorage.getCourseScoringDetails();"incomplete"==b?(b="attempted",c=
!0):"complete"==b&&(b="completed");if(b!=a){a=b;var f={},q={verb:verbMap[b],inProgress:c};if("completed"==b||"failed"==b||"passed"==b||!c){f.duration=scormTimeFn.ConvertMilliSecondsIntoSCORM2004Time(scormTimeFn.GetSessionAccumulatedTime());f.completion=!0;if("failed"==b||"passed"==b)f.score={scaled:d.score/100,min:0,max:100,raw:d.score};q.result=f}e=!1;contentApi.sendAnalyticsStatement(q)}}},f=function(a,b,c){tc.setState("bookmark",a,{callback:function(){}});if(c&&("page"==c||"module"==c)){var d=
"",e=settings.activityRootURL+"page/"+a,f=[];"page"==c?(d="http://activitystrea.ms/schema/1.0/page",e=settings.activityRootURL+"page/"+a,a=isNaN(a)&&settings.useExternalIdsForScorm?dataStorage.getSubeoFromPage(dataStorage.getPageFromExternalId(a).pageid):dataStorage.getSubeoFromPage(a),a=dataStorage.findObject(a.objectid),c=dataStorage.findModule(a.loid),f.push({id:settings.activityRootURL+"object/"+(settings.useExternalIdsForScorm?a.object_external_id:a.objectid)}),f.push({id:settings.activityRootURL+
"module/"+(settings.useExternalIdsForScorm?c.external_id:c.loid)})):"module"==c&&(d="http://adlnet.gov/expapi/activities/module",e=settings.activityRootURL+"module/"+a);contentApi.sendAnalyticsStatement({verb:verbMap.experienced,object:{id:e,definition:{name:{"en-US":b},type:d}},context:{contextActivities:{parent:f}}})}}},setupXAPITriggers=function(){function e(a){dataStorage.findPage(a.pageid);var b=dataStorage.findObject(dataStorage.currentPage.objectid),c=dataStorage.findModule(b.loid);player.inAssessment&&
(b=dataStorage.findObject(dataStorage.findQuestionForPage(a.pageid).objectid));b=[{id:settings.activityRootURL+"page/"+(settings.useExternalIdsForScorm?a.external_id:a.pageid)},{id:settings.activityRootURL+"object/"+(settings.useExternalIdsForScorm?b.external_id:b.objectid)},{id:settings.activityRootURL+"module/"+(settings.useExternalIdsForScorm?c.external_id:b.loid)}];a.parent_element_id&&(c=dataStorage.getElement(a.parent_element_id),b.unshift({id:settings.activityRootURL+"element/"+(settings.useExternalIdsForScorm?
c.external_id:a.parent_element_id)}));return{extensions:{"http://dominknow.com/elementTypes":a.elementtype},contextActivities:{parent:b}}}var a={id:"http://adlnet.gov/expapi/verbs/interacted",display:{"en-US":"interacted"}},b={id:"http://adlnet.gov/expapi/verbs/experienced",display:{"en-US":"experienced"}},c={id:"http://activitystrea.ms/schema/1.0/consume",display:{"en-US":"consumed"}},d={id:"http://id.tincanapi.com/verb/viewed",display:{"en-US":"viewed"}},f={id:"http://id.tincanapi.com/verb/selected",
display:{"en-US":"selected"}},g={id:"https://w3id.org/xapi/dod-isd/verbs/relocated",display:{"en-US":"relocated"}},k={id:"http://activitystrea.ms/schema/1.0/play",display:{"en-US":"played"}},l={id:"http://id.tincanapi.com/verb/paused",display:{"en-US":"paused"}},m={id:"http://activitystrea.ms/schema/1.0/start",display:{"en-US":"started"}},q={id:"http://activitystrea.ms/schema/1.0/consume",display:{"en-US":"consumed"}},u={id:"http://activitystrea.ms/schema/1.0/complete",display:{"en-US":"completed"}},
t={click:{"en-US":"clicked"},dblClick:{"en-US":"double clicked"},rightClick:{"en-US":"right clicked"},mouseenter:{"en-US":"moused over"},mouseleave:{"en-US":"moused out of"},ELEMENT_DRAG_STARTED:{"en-US":"started dragging"},ELEMENT_DRAG_DROPPED:{"en-US":"dropped"},ELEMENT_DROP_OVER:{"en-US":"dragged over"},ELEMENT_DROP_OUT:{"en-US":"dragged out of"}},w=function(a){for(var b=0;b<a.objects.length;b++)for(var c=a.objects[b],d=0;d<c.objectives.length;d++){var e=c.objectives[d];contentApi.sendAnalyticsStatement({verb:verbMap.objectiveCompleted,
object:{id:settings.activityRootURL+"objective/"+(settings.useExternalIdsForScorm?e.external_id:e.id),definition:{type:"http://adlnet.gov/expapi/activities/objective",name:{"en-US":e.title},description:{"en-US":e.description}}},context:{contextActivities:{parent:[{id:settings.activityRootURL+"module/"+(settings.useExternalIdsForScorm?a.external_id:a.loid)}]},extensions:{"http://www.dominknow.com/xapi/extensions/learning_object_iri":settings.activityRootURL+"object/"+(settings.useExternalIdsForScorm?
c.object_external_id:c.objectid),"http://www.dominknow.com/xapi/extensions/objective_client_id":e.client_id}}})}};$(dataStorage).bind(DKI.DataStorage.events.moduleStarted,function(a,b){a=dataStorage.findModule(b);contentApi.sendAnalyticsStatement({verb:m,object:{id:settings.activityRootURL+"module/"+(settings.useExternalIdsForScorm?a.external_id:b),definition:{type:"http://adlnet.gov/expapi/activities/module",name:{"en-US":a.name},description:{"en-US":a.description}}}})});$(dataStorage).bind(DKI.DataStorage.events.objectStarted,
function(a,b){a=dataStorage.findObject(b);var c=dataStorage.findModule(a.loid);contentApi.sendAnalyticsStatement({verb:m,object:{id:settings.activityRootURL+"object/"+(settings.useExternalIdsForScorm?a.object_external_id:b),definition:{type:"http://adlnet.gov/expapi/activities/objective",name:{"en-US":a.title},description:{"en-US":a.description}}},context:{contextActivities:{parent:[{id:settings.activityRootURL+"module/"+(settings.useExternalIdsForScorm?c.external_id:c.loid)}]}}})});$(dataStorage).bind(DKI.DataStorage.events.moduleCompleted,
function(a,b){a=dataStorage.findModule(b);contentApi.sendAnalyticsStatement({verb:u,object:{id:settings.activityRootURL+"module/"+(settings.useExternalIdsForScorm?a.external_id:a.loid),definition:{type:"http://adlnet.gov/expapi/activities/module",name:{"en-US":a.name},description:{"en-US":a.description}}},result:{completion:!0}});dataStorage.moduleHasTest(a)||w(a)});$(dataStorage).bind(DKI.DataStorage.events.objectCompleted,function(a,b){a=dataStorage.findObject(b);var c=dataStorage.findModule(a.loid);
contentApi.sendAnalyticsStatement({verb:u,object:{id:settings.activityRootURL+"object/"+(settings.useExternalIdsForScorm?a.object_external_id:b),definition:{type:"http://adlnet.gov/expapi/activities/objective",name:{"en-US":a.title},description:{"en-US":a.description}}},context:{contextActivities:{parent:[{id:settings.activityRootURL+"module/"+(settings.useExternalIdsForScorm?c.external_id:c.loid)}]}},result:{completion:!0}})});$(dataStorage).bind(DKI.DataStorage.events.assessmentCompleted,function(a){a=
dataStorage.assessment;this.getModuleScoringDetails(a.module).passed&&w(a.module)});playerBehaviour.xapi_includeSearchStatements&&($(document).on(DKI.search.events.show,function(b,c){b=xapiActivity.id+"/search/opened";var d=DKI.clone(a);playerBehaviour.useExtendedVerbDisplayForAnalytics&&(d.display["en-US"]="opened");b={verb:d,object:{id:b,definition:{type:"http://adlnet.gov/expapi/activities/interaction",name:{"en-US":"Search Window"}}},context:{contextActivities:{grouping:{id:xapiActivity.id+"/courseSearch"}}}};
c&&""!=c&&(b.context.extensions={"http://dominknow.com/xapi/extensions/searchTerm":c});contentApi.sendAnalyticsStatement(b)}),$(document).on(DKI.search.events.search,function(b,c,d){b=xapiActivity.id+"/search/searched";var e=DKI.clone(a);playerBehaviour.useExtendedVerbDisplayForAnalytics&&(e.display["en-US"]="searched");for(var f=[],g=0;g<d.length;g++)f.push({ref:d[g].ref,score:d[g].score,obj:{smSearchType:d[g].obj.smSearchType||"",id:d[g].obj.id||"",meta:d[g].obj.meta||"",title:d[g].obj.title||""}});
contentApi.sendAnalyticsStatement({verb:e,object:{id:b,definition:{type:"http://adlnet.gov/expapi/activities/interaction",name:{"en-US":"Search Window"}}},context:{contextActivities:{grouping:{id:xapiActivity.id+"/courseSearch"}},extensions:{"http://dominknow.com/xapi/extensions/searchTerm":c,"http://dominknow.com/xapi/extensions/searchResults":f}}})}),$(document).on(DKI.search.events.hide,function(b){b=xapiActivity.id+"/search/closed";var c=DKI.clone(a);playerBehaviour.useExtendedVerbDisplayForAnalytics&&
(c.display["en-US"]="closed");contentApi.sendAnalyticsStatement({verb:c,object:{id:b,definition:{type:"http://adlnet.gov/expapi/activities/interaction",name:{"en-US":"Search Window"}}},context:{contextActivities:{grouping:{id:xapiActivity.id+"/courseSearch"}}}})}),$(document).on(DKI.search.events.filterClicked,function(b,c){b=xapiActivity.id+"/search/filter";var d=DKI.clone(a);playerBehaviour.useExtendedVerbDisplayForAnalytics&&(d.display["en-US"]="filtered");contentApi.sendAnalyticsStatement({verb:d,
object:{id:b,definition:{type:"http://adlnet.gov/expapi/activities/interaction",name:{"en-US":"Search Window"}}},context:{contextActivities:{grouping:{id:xapiActivity.id+"/courseSearch"}},extensions:{"http://dominknow.com/xapi/extensions/selectedFilter":c}}})}),$(document).on(DKI.search.events.loadedProperties,function(b,c,d){b=xapiActivity.id+"/search/properties";var e=DKI.clone(a);playerBehaviour.useExtendedVerbDisplayForAnalytics&&(e.display["en-US"]="loaded properties");c={verb:e,object:{id:b,
definition:{type:"http://adlnet.gov/expapi/activities/interaction",name:{"en-US":"Search Window"}}},context:{contextActivities:{grouping:{id:xapiActivity.id+"/courseSearch"}},extensions:{"http://dominknow.com/xapi/extensions/searchType":d,"http://dominknow.com/xapi/extensions/searchItem":DKI.search.Window.parseToBasic(c)}}};contentApi.sendAnalyticsStatement(c)}));playerBehaviour.xapi_includePlayerControlStatements&&($(player.navigation).on(DKI.PlayerNavigation.events.forward,function(a){contentApi.sendAnalyticsStatement({verb:{id:"http://adlnet.gov/expapi/verbs/interacted",
display:t.click},object:{id:xapiActivity.id+"/navigation/forward",definition:{type:"http://adlnet.gov/expapi/activities/interaction",name:{"en-US":"Forward Button"}}}})}),$(player.navigation).on(DKI.PlayerNavigation.events.back,function(a){contentApi.sendAnalyticsStatement({verb:{id:"http://adlnet.gov/expapi/verbs/interacted",display:t.click},object:{id:xapiActivity.id+"/navigation/back",definition:{type:"http://adlnet.gov/expapi/activities/interaction",name:{"en-US":"Back Button"}}}})}),$(player).on(player.events.playerTranscriptShown,
function(){contentApi.sendAnalyticsStatement({verb:d,object:{id:xapiActivity.id+"/player/transcript/"+dataStorage.currentPage.page.id,definition:{type:"http://adlnet.gov/expapi/activities/interaction",name:{"en-US":"Player Transcript"}}}})}),$(player.navigation).on(DKI.PlayerNavigation.events.reload,function(){var a=xapiActivity.id+"/navigation/reload",c=DKI.clone(b),d=DKI.clone(b);d.display["en-US"]="Reloaded Page";playerBehaviour.useExtendedVerbDisplayForAnalytics&&(c=d);contentApi.sendAnalyticsStatement({verb:c,
object:{id:a+(settings.useExternalIdsForScorm?dataStorage.currentPage.page.external_id:dataStorage.currentPage.page.id),definition:{name:{"en-US":dataStorage.currentPage.page.title}}},context:{extensions:{"http://dominknow.com/xapi/extensions/verbs":d}}})}),$(document).on(contentApi.events.jumpToPage,function(a,b,c){if(c){a=xapiActivity.id+"/"+(settings.useExternalIdsForScorm?c.page.external_id:b);c={type:"http://adlnet.gov/expapi/activities/link",name:{"en-US":c.title}};b=DKI.clone(g);var d=DKI.clone(g);
d.display["en-US"]="Jumped To Page";playerBehaviour.useExtendedVerbDisplayForAnalytics&&(b=d);contentApi.sendAnalyticsStatement({verb:b,object:{id:a,definition:c},context:{extensions:{"http://dominknow.com/xapi/extensions/verbs":d}}})}}));playerBehaviour.xapi_includeOutlineStatements&&($(document).on(DKI.outline.events.pageSelected,function(b,c){b=dataStorage.findPage(c);c=xapiActivity.id+"/outline/page/"+(settings.useExternalIdsForScorm?b.external_id:c);b={type:"http://adlnet.gov/expapi/activities/interaction",
name:{"en-US":b.title}};var d=DKI.clone(a),e=DKI.clone(a);e.display["en-US"]="Outline Page Selected";playerBehaviour.useExtendedVerbDisplayForAnalytics&&(d=e);contentApi.sendAnalyticsStatement({verb:d,object:{id:c,definition:b},context:{extensions:{"http://dominknow.com/xapi/extensions/verbs":e}}})}),$(document).on(DKI.outline.events.objectSelected,function(b,c){b=$(c).data("objectid");c=dataStorage.findObject(b);b=xapiActivity.id+"/outline/object/"+(settings.useExternalIdsForScorm?c.object_external_id:
b);c={type:"http://adlnet.gov/expapi/activities/interaction",name:{"en-US":c.name}};var d=DKI.clone(a),e=DKI.clone(a);e.display["en-US"]="Outline Object Selected";playerBehaviour.useExtendedVerbDisplayForAnalytics&&(d=e);contentApi.sendAnalyticsStatement({verb:d,object:{id:b,definition:c},context:{extensions:{"http://dominknow.com/xapi/extensions/verbs":e}}})}));if(theme.events&&playerBehaviour.xapi_includePlayerControlStatements){if(theme.events.themeTranscriptShown)$(theme).on(theme.events.themeTranscriptShown,
function(){var a=xapiActivity.id+"/theme/transcript/";dataStorage&&dataStorage.currentPage&&dataStorage.currentPage.page.id&&(a+=settings.useExternalIdsForScorm?dataStorage.currentPage.page.external_id:dataStorage.currentPage.page.id);var b=DKI.clone(d);contentApi.sendAnalyticsStatement({verb:b,object:{id:a,definition:{type:"http://adlnet.gov/expapi/activities/interaction",name:{"en-US":"Theme Transcript"}}}})});if(theme.events.menuOpened)$(theme).on(theme.events.menuOpened,function(){var a=xapiActivity.id+
"/theme/menu",b=DKI.clone(d);contentApi.sendAnalyticsStatement({verb:b,object:{id:a,definition:{type:"http://adlnet.gov/expapi/activities/interaction",name:{"en-US":"Theme Menu"}}}})});if(theme.events.outlineOpened)$(theme).on(theme.events.outlineOpened,function(){var a=xapiActivity.id+"/theme/outline",b=DKI.clone(d);contentApi.sendAnalyticsStatement({verb:b,object:{id:a,definition:{type:"http://adlnet.gov/expapi/activities/interaction",name:{"en-US":"Theme Outline"}}}})})}playerBehaviour.xapi_includeResourceStatements&&
($(document).on(DKI.resourceBrowser.events.resourceOpened,function(a,b){a=xapiActivity.id+"/resource/"+(settings.useExternalIdsForScorm?b.external_id:b.id);b={type:"http://adlnet.gov/expapi/activities/interaction",name:{"en-US":b.title}};var c=DKI.clone(d);contentApi.sendAnalyticsStatement({verb:c,object:{id:a,definition:b}})}),$(document).on(DKI.resourceBrowser.events.resourceDownloaded,function(a,b){a=xapiActivity.id+"/resource/download/"+(settings.useExternalIdsForScorm?b.external_id:b.id);b={type:"http://adlnet.gov/expapi/activities/interaction",
name:{"en-US":b.title}};var c=DKI.clone(d),e=DKI.clone(d);e.display["en-US"]="Downloaded";playerBehaviour.useExtendedVerbDisplayForAnalytics&&(c=e);contentApi.sendAnalyticsStatement({verb:c,object:{id:a,definition:b},context:{extensions:{"http://dominknow.com/xapi/extensions/verbs":e}}})}));playerBehaviour.xapi_includeGlossaryStatements&&($(player).on(DKI.glossary.events.definitionShown,function(a,b){a=xapiActivity.id+"/glossary/definition/"+(settings.useExternalIdsForScorm?b.glossary_external_id:
b.glossaryid);b={type:"http://adlnet.gov/expapi/activities/interaction",name:{"en-US":b.term}};contentApi.sendAnalyticsStatement({verb:DKI.clone(d),object:{id:a,definition:b}})}),$(player).on(DKI.glossary.events.popupShown,function(a,b){a=xapiActivity.id+"/glossary/popup/"+(settings.useExternalIdsForScorm?b.glossary_external_id:b.glossaryid);b={type:"http://adlnet.gov/expapi/activities/interaction",name:{"en-US":b.term}};contentApi.sendAnalyticsStatement({verb:DKI.clone(d),object:{id:a,definition:b}})}));
playerBehaviour.xapi_includeCitationStatements&&($(document).on(DKI.Reference.playerReferenceUIInterface.events.referenceShown,function(a,b){a=xapiActivity.id+"/citation/show/"+(settings.useExternalIdsForScorm?b.external_id:b.id);b={type:"http://adlnet.gov/expapi/activities/interaction",name:{"en-US":b.label}};contentApi.sendAnalyticsStatement({verb:DKI.clone(d),object:{id:a,definition:b}})}),$(document).on(DKI.Reference.playerReferenceUIInterface.events.referenceHovered,function(a,b){a=xapiActivity.id+
"/citation/hover/"+(settings.useExternalIdsForScorm?b.external_id:b.id);b={type:"http://adlnet.gov/expapi/activities/interaction",name:{"en-US":b.label}};contentApi.sendAnalyticsStatement({verb:DKI.clone(d),object:{id:a,definition:b}})}),$(document).on(DKI.Reference.playerReferenceUIInterface.events.bibliographyShown,function(){var a=xapiActivity.id+"/bibliography";contentApi.sendAnalyticsStatement({verb:DKI.clone(d),object:{id:a,definition:{type:"http://adlnet.gov/expapi/activities/interaction",
name:{"en-US":"Bibliography"}}}})}));if(playerBehaviour.xapi_includeDragDropStatements)$(document).on(DKI.ContentPage.events.elementDragStarted+" "+DKI.ContentPage.events.elementDragDropped+" "+DKI.ContentPage.events.elementDropOut+" "+DKI.ContentPage.events.elementDropOver+" ",function(b){var c=dataStorage.getElement($(b.target).data("id")),d=c.title,f=c.description,g=settings.activityRootURL+"element/"+(settings.useExternalIdsForScorm?c.external_id:c.elementid);c.upload_id&&""!=c.upload_id&&(g=
settings.activityRootURL+"asset/"+(settings.useExternalIdsForScorm?c.asset_external_id:c.upload_id),d=c.asset_title,f=c.asset_description);b=t[b.type];var k={type:"http://adlnet.gov/expapi/activities/interaction"};""!=d&&(k.name={"en-US":d});""!=f&&(k.description={"en-US":f});f=DKI.clone(a);d=DKI.clone(a);d.display=b;playerBehaviour.useExtendedVerbDisplayForAnalytics&&(f=d);c={verb:f,object:{id:g,definition:k,objectType:"Activity"},context:e(c)};DKI.applyIf(c,{context:{extensions:{"http://dominknow.com/xapi/extensions/verbs":d}}},
!0);contentApi.sendAnalyticsStatement(c)});if(playerBehaviour.xapi_includeActionStatements)$(document).on(DKI.ContentPage.events.actionFired,function(b,c){if(c.action.elementId&&t[c.action.trigger]){b=dataStorage.getElement(c.action.elementId);var d=b.title,f=b.description,g=settings.activityRootURL+"element/"+(settings.useExternalIdsForScorm?b.external_id:b.elementid);b.upload_id&&""!=b.upload_id&&(g=settings.activityRootURL+"asset/"+(settings.useExternalIdsForScorm?b.asset_external_id:b.upload_id),
d=b.asset_title,f=b.asset_description);c=t[c.action.trigger];var k={type:"http://adlnet.gov/expapi/activities/interaction"};""!=d&&(k.name={"en-US":d});""!=f&&(k.description={"en-US":f});f=DKI.clone(a);d=DKI.clone(a);d.display=c;playerBehaviour.useExtendedVerbDisplayForAnalytics&&(f=d);b={verb:f,object:{id:g,definition:k,objectType:"Activity"},context:e(b)};DKI.applyIf(b,{context:{extensions:{"http://dominknow.com/xapi/extensions/verbs":d}}},!0);contentApi.sendAnalyticsStatement(b)}});playerBehaviour.xapi_includeMediaStatements&&
($(document).on(DKI.ContentPage.events.media.started,function(a,b){a=dataStorage.getElement(b.elementId);if("videoembed"==a.elementtype)var c=settings.activityRootURL+"embed/"+(settings.useExternalIdsForScorm?a.external_id:a.id),d=a.title,f=a.description;else c=settings.activityRootURL+"asset/"+(settings.useExternalIdsForScorm?a.asset_external_id:a.upload_id),d=a.asset_title,f=a.asset_description;var g={type:"http://adlnet.gov/expapi/activities/media"};""!=d&&(g.name={"en-US":d});""!=f&&(g.description=
{"en-US":f});"videoembed"==a.elementtype&&(g.extensions={"http://id.tincanapi.com/extension/irl":b.url});contentApi.sendAnalyticsStatement({verb:DKI.clone(m),object:{id:c,definition:g,objectType:"Activity"},context:e(a)})}),$(document).on(DKI.ContentPage.events.media.paused,function(a,b){a=dataStorage.getElement(b.elementId);var c,d;if("videoembed"==a.elementtype){var f=settings.activityRootURL+"embed/"+(settings.useExternalIdsForScorm?a.external_id:a.id);c=a.title;d=a.description}else f=settings.activityRootURL+
"asset/"+(settings.useExternalIdsForScorm?a.asset_external_id:a.upload_id),c=a.asset_title,d=a.asset_description;var g={type:"http://adlnet.gov/expapi/activities/media"};""!=c&&(g.name={"en-US":c});""!=d&&(g.description={"en-US":d});"videoembed"==a.elementtype&&(g.extensions={"http://id.tincanapi.com/extension/irl":b.url});contentApi.sendAnalyticsStatement({verb:DKI.clone(l),object:{id:f,definition:g,objectType:"Activity"},context:e(a)})}),$(document).on(DKI.ContentPage.events.media.played,function(a,
b){a=dataStorage.getElement(b.elementId);var c,d;if("videoembed"==a.elementtype){var f=settings.activityRootURL+"embed/"+(settings.useExternalIdsForScorm?a.external_id:a.id);c=a.title;d=a.description}else f=settings.activityRootURL+"asset/"+(settings.useExternalIdsForScorm?a.asset_external_id:a.upload_id),c=a.asset_title,d=a.asset_description;var g={type:"http://adlnet.gov/expapi/activities/media"};""!=c&&(g.name={"en-US":c});""!=d&&(g.description={"en-US":d});"videoembed"==a.elementtype&&(g.extensions=
{"http://id.tincanapi.com/extension/irl":b.url});contentApi.sendAnalyticsStatement({verb:DKI.clone(k),object:{id:f,definition:g,objectType:"Activity"},context:e(a)})}),$(document).on(DKI.ContentPage.events.media.ended,function(a,b){a=dataStorage.getElement(b.elementId);var c,d;if("videoembed"==a.elementtype){var f=settings.activityRootURL+"embed/"+(settings.useExternalIdsForScorm?a.external_id:a.id);c=a.title;d=a.description}else f=settings.activityRootURL+"asset/"+(settings.useExternalIdsForScorm?
a.asset_external_id:a.upload_id),c=a.asset_title,d=a.asset_description;var g={type:"http://adlnet.gov/expapi/activities/media"};""!=c&&(g.name={"en-US":c});""!=d&&(g.description={"en-US":d});"videoembed"==a.elementtype&&(g.extensions={"http://id.tincanapi.com/extension/irl":b.url});contentApi.sendAnalyticsStatement({verb:DKI.clone(q),object:{id:f,definition:g,objectType:"Activity"},context:e(a)})}));playerBehaviour.xapi_includeElementContentStatements&&($(document).on(DKI.ContentPage.events.elementContentChanged,
function(b,c){var g=c.element,k=DKI.clone(a);b=DKI.clone(a);switch(g.elementtype){case "tabset":b.display["en-US"]="Tab clicked";break;case "flipCard":b=DKI.clone(d);b.display["en-US"]="Side viewed";break;case "timeline":b=DKI.clone(d);b.display["en-US"]="Timeline node viewed";break;case "contentCarousel":b=DKI.clone(d);b.display["en-US"]="Content viewed";break;case "radioGroup":b=DKI.clone(f);b.display["en-US"]="Radio button selected";break;case "input":case "textbox":b.display["en-US"]="Text typed";
break;case "selection":b=DKI.clone(f);b.display["en-US"]="Menu item selected";break;case "slider":b.display["en-US"]="Slider handle slid";break;case "toggle":b.display["en-US"]="Toggle changed"}playerBehaviour.useExtendedVerbDisplayForAnalytics&&(k=b);if(k&&!c.setAutomatically&&playerBehaviour.recordInteractions){c=g.title;var l=g.description,m=settings.activityRootURL+"element/"+(settings.useExternalIdsForScorm?g.external_id:g.elementid),q={type:"http://adlnet.gov/expapi/activities/interaction"};
""!=c&&(q.name={"en-US":c});""!=l&&(q.description={"en-US":l});g={verb:k,object:{id:m,definition:q,objectType:"Activity"},context:e(g)};DKI.applyIf(g,{context:{extensions:{"http://dominknow.com/xapi/extensions/verbs":b}}},!0);contentApi.sendAnalyticsStatement(g)}}),$(document).on(DKI.ContentPage.events.elementAllContentViewed,function(a,b){a=b.element;var d=DKI.clone(c);extendedVerb=DKI.clone(c);switch(a.elementtype){case "tabset":extendedVerb.display["en-US"]="All tabs seen";break;case "flipCard":extendedVerb.display["en-US"]=
"All sides seen";break;case "timeline":extendedVerb.display["en-US"]="All nodes viewed";break;case "contentCarousel":extendedVerb.display["en-US"]="All content viewed"}playerBehaviour.useExtendedVerbDisplayForAnalytics&&(d=extendedVerb);if(d&&!b.setAutomatically&&playerBehaviour.recordInteractions){b=a.title;var f=a.description,g=settings.activityRootURL+"element/"+(settings.useExternalIdsForScorm?a.external_id:a.elementid),k={type:"http://adlnet.gov/expapi/activities/interaction"};""!=b&&(k.name=
{"en-US":b});""!=f&&(k.description={"en-US":f});a={verb:d,object:{id:g,definition:k,objectType:"Activity"},context:e(a)};DKI.applyIf(a,{context:{extensions:{"http://dominknow.com/xapi/extensions/verbs":extendedVerb}}},!0);contentApi.sendAnalyticsStatement(a)}}),$(document).on(DKI.ContentPage.events.markerTriggered,function(a,b){a=b.element;b=DKI.clone(c);var d=a.title,f=a.description,g=settings.activityRootURL+"element/"+(settings.useExternalIdsForScorm?a.external_id:a.elementid),k={type:"http://adlnet.gov/expapi/activities/interaction"};
extendedVerb=DKI.clone(c);extendedVerb.display["en-US"]="Marker triggered";playerBehaviour.useExtendedVerbDisplayForAnalytics&&(b=extendedVerb);""!=d&&(k.name={"en-US":d});""!=f&&(k.description={"en-US":f});a={verb:b,object:{id:g,definition:k,objectType:"Activity"},context:e(a)};DKI.applyIf(a,{context:{extensions:{"http://dominknow.com/xapi/extensions/verbs":extendedVerb}}},!0);contentApi.sendAnalyticsStatement(a)}),$(document).on(DKI.ContentPage.events.flashCardSubmitted,function(a,b){a=b.outline;
var c=xapiFunctions.buildGenericInteractionStatement({activityId:settings.activityRootURL+"element/"+(settings.useExternalIdsForScorm?a.external_id:a.elementid),body:a.description,question:{title:a.title},context:e(a)});c.object.id=settings.activityRootURL+"element/"+(settings.useExternalIdsForScorm?a.external_id:a.elementid);c.object.definition.name["en-US"]=a.title;c.object.definition.description["en-US"]=a.description;c.object.definition.correctResponsesPattern=[b.correctResponse.join("[,]")];
c.object.definition.interactionType="fill-in";c.result={success:1==b.score,response:b.response,score:{scaled:b.score}};c=xapiFunctions.buildQuestionInteractionStatement(c);b=dataStorage.getElement(a.parent_element_id);c.getStatement().context.contextActivities.parent.unshift({id:settings.activityRootURL+"element/"+(settings.useExternalIdsForScorm?b.external_id:a.parent_element_id)});c.send()}));$(document).on(DKI.ContentPage.events.captureElementInteracted,function(b,c){b=c.el;var d=DKI.clone(a);
switch(c.event){case "start":d=DKI.clone(m);d.display["en-US"]="Started";break;case "play":d=DKI.clone(k);d.display["en-US"]="Played";break;case "pause":d=DKI.clone(l);d.display["en-US"]="Paused";break;case "restart":d=DKI.clone(m);d.display["en-US"]="Restarted";break;case "stepChanged":d=DKI.clone(a);d.display["en-US"]="Step Changed";break;case "ended":d=DKI.clone(q),d.display["en-US"]="Ended"}if(d&&playerBehaviour.recordInteractions){c=b.title;var f=b.description,g=settings.activityRootURL+"element/"+
(settings.useExternalIdsForScorm?b.external_id:b.elementid),t={type:"http://adlnet.gov/expapi/activities/simulation"};""!=c&&(t.name={"en-US":c});""!=f&&(t.description={"en-US":f});contentApi.sendAnalyticsStatement({verb:d,object:{id:g,definition:t,objectType:"Activity"},context:e(b)})}});var A=function(a){a.statement.result={score:{scaled:a.result.score/100},success:"undefined"!==typeof a.success?a.success:100==a.result.score};return A.types[a.type](a)};A.types={multipleChoiceQuestion:function(a){var b=
[],c=[],d=[];$.each(a.element.elements,function(){d.push({id:settings.useExternalIdsForScorm?this.external_id:this.id.toString(),description:{"en-US":this.meta}});this.parameters.config.correct&&b.push(settings.useExternalIdsForScorm?this.external_id:this.id)});$.each(a.result.selected,function(){c.push(settings.useExternalIdsForScorm?this.outline.external_id:this.outline.id)});a.statement.object.definition.correctResponsesPattern=[b.join("[,]")];a.statement.object.definition.choices=d;a.statement.object.definition.interactionType=
"choice";a.statement.result.response=c.join("[,]");a.statement.object.definition.name={"en-US":a.element.meta};a.statement.object.definition.description={"en-US":a.element.txt};return a.statement},trueFalseQuestion:function(a){a.statement.object.definition.correctResponsesPattern=["true"==a.result.correct[0].toString().toLowerCase()?"true":"false"];a.statement.object.definition.interactionType="true-false";a.statement.object.definition.name={"en-US":a.element.meta};a.statement.object.definition.description=
{"en-US":a.element.txt};a.statement.result.response=a.result.selected.length?"true"==a.result.selected[0].toString().toLowerCase()?"true":"false":"";return a.statement},multiplePulldownQuestion:function(a){a.statement.object.definition.correctResponsesPattern=[a.result.correct.join("[,]")];a.statement.object.definition.description["en-US"]=a.result.body;a.statement.object.definition.interactionType="fill-in";a.statement.result.response=a.result.selected.join("[,]");a.statement.object.definition.name=
{"en-US":a.element.txt};return a.statement},fillInTheBlanksQuestion:function(a){var b=[];$.each(a.result.correct,function(c,d){d=$.extend(!0,{},a.statement);var e=this.map(function(a){return a.trim()}),f=~$.inArray(a.result.selected[c],e)?1:0;d.object.definition.correctResponsesPattern=[e.join("[,]")];d.object.definition.description["en-US"]=a.result.body;d.object.definition.interactionType="fill-in";d.result.response=a.result.selected[c];d.result.score={scaled:f};d.result.success=1===f;b.push(d)});
a.statement.object.definition.name={"en-US":a.element.txt};return b},clickTheWordQuestion:function(a){delete a.statement.object.definition.interactionType;a.statement.object.definition.name={"en-US":a.element.txt};return a.statement},dragTheWordQuestion:function(a){delete a.statement.object.definition.interactionType;a.statement.object.definition.name={"en-US":a.element.txt};return a.statement},capture:function(a){var b=0,c=0;a.step.eventType===tryMe.CAPTURE_EVENT.TYPED?a.statement.object.definition.correctResponsesPattern=
[a.step.stringTyped]:a.hotspot&&(a.statement.object.definition.correctResponsesPattern=["("+[a.hotspot.left,a.hotspot.top,a.hotspot.left+a.hotspot.width,a.hotspot.top+a.hotspot.height].join()+")"],b=a.hotspot.left,c=a.hotspot.top);a.statement.object.definition.interactionType="other";a.statement.result.response=a.assessment.tries.map(function(d,e){if(d.value)return d.value;var f=(a.assessment.passed&&e===a.assessment.tries.length-1?d.x+b:d.x).toFixed(2);e=(a.assessment.passed&&e===a.assessment.tries.length-
1?d.x+c:d.y).toFixed(2);var g=[f,e];d.width&&d.height&&(g=g.cooncat([(f+d.width).toFixed(2),(e+d.height).toFixed(2)]));return"("+g.join(",")+")"},[]).join("[,]");return a.statement},imageMap:function(a){a.statement.object.definition.interactionType="other";a.statement.object.definition.correctResponsesPattern=a.element.elements.reduce(function(a,b){b.parameters.config.map.distractor||a.push("("+b.parameters.config.map.coords+")");return a},[]);a.statement.result.response=a.result.imageMapData.answers.map(function(a){return"("+
a.coords.map(function(a){return Math.round(a)}).join(",")+")"},[]).join("[,]");a.statement.object.id=settings.activityRootURL+"element/"+(settings.useExternalIdsForScorm?a.element.external_id:a.element.id);a.statement.object.definition.name["en-US"]=a.element.title;a.statement.object.definition.description["en-US"]=a.element.description;return a.statement},matchingQuestion:function(a){var b=a.result.matchingQuestionData.getxAPICompleteData(),c=[],d=[],e=function(a){a=a.meta?DKI.stripHTML(a.meta):
a.asset_title;return 100<a.length?a.substring(0,100)+"...":a};$.each(b.sources,function(){c.push({id:settings.useExternalIdsForScorm?this.external_id:this.id.toString(),description:{"en-US":e(this)}})});$.each(b.targets,function(){d.push({id:settings.useExternalIdsForScorm?this.outline.external_id:this.outline.id.toString(),description:{"en-US":e(this.outline)}})});a.statement.object.definition.interactionType="matching";a.statement.object.definition.source=c;a.statement.object.definition.target=
d;a.statement.object.definition.name={"en-US":a.element.meta};return a.statement},sequencingQuestion:function(a){var b=a.result.sequencingQuestionData.getxAPICompleteData();a.statement.object.definition.correctResponsesPattern=[b.correctOrder.join("[,]")];a.statement.object.definition.choices=b.choices.map(function(a){return{id:settings.useExternalIdsForScorm?a.external_id:a.id.toString(),description:{"en-US":a.upload_id?a.meta||a.txt||a.asset_title:DKI.stripHTML(a.meta)}}});a.statement.object.definition.interactionType=
"sequencing";a.statement.object.definition.name={"en-US":a.element.meta};return a.statement}};playerBehaviour.xapi_includeQuestionElementStatements&&($(document).on(DKI.ContentPage.events.questionElementSubmitted,function(a,b){a=function(){if(2==c.elements.length&&1==c.parameters.config.maxSelections){var a=!1;$.each(c.elements,function(){a=this.meta.toLowerCase()===DKI.strings.runtime.trueOptionLabel.toLowerCase()||this.meta.toLowerCase()===DKI.strings.runtime.falseOptionLabel.toLowerCase()?!0:!1});
return a}};if("ATTEMPT"==b.status){var c=b.element,d=xapiFunctions.buildGenericInteractionStatement({activityId:settings.activityRootURL+"element/"+(settings.useExternalIdsForScorm?c.external_id:c.elementid),body:c.meta,question:{title:c.txt},context:e(c)});b.statement=d;b.type=a(b.element)?"trueFalseQuestion":b.type;d=A(b);d=Array.isArray(d)?d:[d];$.each(d,function(){xapiFunctions.buildQuestionInteractionStatement(this).send()})}}),$(document).on(DKI.ContentPage.events.captureTestmeSubmitted,function(a,
b){a=b.outline;var c=xapiFunctions.buildGenericInteractionStatement({activityId:settings.activityRootURL+"element/"+(settings.useExternalIdsForScorm?a.external_id:a.elementid),extensions:{"http://dominknow.com/elementTypes":a.elementtype},body:a.description,question:{title:a.title},context:e(a)}),d=a.asset_parameters.config.description;a.asset_parameters.config.hasOwnProperty("sections")&&(""!=a.asset_parameters.config.sections[0].introText?d=a.asset_parameters.config.sections[0].introText:""!=a.asset_parameters.config.sections[0].introduction&&
(d=a.asset_parameters.config.sections[0].introduction));c.object.id=settings.activityRootURL+"element/"+(settings.useExternalIdsForScorm?a.external_id:a.elementid);c.object.definition.name["en-US"]=a.title;c.object.definition.description["en-US"]=$("\x3cdiv /\x3e").html(d).text().trim();c.object.definition.interactionType="other";c.result={success:100==b.score,score:{scaled:b.score/100}};xapiFunctions.buildQuestionInteractionStatement(c).send()}),$(document).on(DKI.ContentPage.events.categoryCard.answered,
function(b,c){c=c.dragged;var d=c.title,f=c.meta,g=settings.activityRootURL+"element/"+(settings.useExternalIdsForScorm?c.external_id:c.elementid);c.upload_id&&""!=c.upload_id&&(g=settings.activityRootURL+"asset/"+(settings.useExternalIdsForScorm?c.asset_external_id:c.upload_id),d=c.asset_title,f=c.asset_description);var k=DKI.clone(a);b=DKI.clone(a);b.display["en-us"]=t.ELEMENT_DRAG_DROPPED;playerBehaviour.useExtendedVerbDisplayForAnalytics&&(k=b);var l={type:"http://adlnet.gov/expapi/activities/interaction"};
""!=d&&(l.name={"en-US":d});""!=f&&(l.description={"en-US":f});playerBehaviour.recordInteractions&&(c={verb:k,object:{id:g,definition:l,objectType:"Activity"},context:e(c)},DKI.applyIf(c,{context:{extensions:{"http://dominknow.com/xapi/extensions/verbs":b}}},!0),contentApi.sendAnalyticsStatement(c))}),$(document).on(DKI.ContentPage.events.categoryCard.completed,function(a,b){a=b.score;b=b.xAPIData;var c=b.element,d=function(a){return{id:a[this].toString(),name:{"en-US":a.title},description:{"en-US":a.meta}}};
b.sources=b.sources.map(d,settings.useExternalIdsForScorm?"external_id":"id");b.targets=b.targets.map(d,"dragdrop_id");c=xapiFunctions.buildGenericInteractionStatement({activityId:settings.activityRootURL+"element/"+(settings.useExternalIdsForScorm?c.external_id:c.id),body:c.description,question:{title:c.title},context:e(c)});c.object.definition.interactionType="matching";c.object.definition.source=b.sources;c.object.definition.target=b.targets;c.object.definition.name={"en-US":b.element.meta};c.result=
{success:100==a,response:b.matches.join("[,]"),score:{scaled:a/100}};xapiFunctions.buildQuestionInteractionStatement(c).send()}));$(document).on(DKI.ContentPage.events.captureTestmeStepSubmitted,function(a,b){a=(a=dataStorage.getCurrentQuestion())?a&&8===a.type&&a.options[0].elementId==b.element.id:!1;if(playerBehaviour.recordInteractions){var c=b.element,c=xapiFunctions.buildGenericInteractionStatement({activityId:settings.activityRootURL+"captureStep/"+b.stepIdx,body:b.step.instructionalText||"",
question:{title:c.title},context:{extensions:{"http://dominknow.com/elementTypes":c.elementtype},contextActivities:{parent:[{id:settings.activityRootURL+"captureScene/"+b.section},{id:settings.activityRootURL+"element/"+(settings.useExternalIdsForScorm?c.external_id:c.id),definition:{name:{"en-US":c.title},description:{"en-US":c.description}}}]}}});b.statement=c;b.type="capture";b.success=b.assessment.passed;b.result={score:Math.round(b.assessment.getScore()/b.assessment.maxTries*100)};c=A(b);c.result.raw=
b.assessment.getScore();c.result.min=0;c.result.max=b.assessment.maxTries;c=xapiFunctions.buildQuestionInteractionStatement(c).getStatement();a&&contentApi.sendScormXAPIStatement(c);contentApi.sendAnalyticsStatement(c)}});playerBehaviour.xapi_includeScenarioStatements&&($(document).on(DKI.ContentPage.events.scenarioOptionSelected,function(a,b){a=b.scene;var c=xapiFunctions.buildGenericInteractionStatement({activityId:settings.activityRootURL+"element/"+(settings.useExternalIdsForScorm?a.external_id:
a.elementid),body:a.description,question:{title:a.title},context:e(a)});c.object.id=settings.activityRootURL+"element/"+(settings.useExternalIdsForScorm?a.external_id:a.elementid);c.object.definition.name["en-US"]=a.title;c.object.definition.description["en-US"]=a.description;c.object.definition.interactionType="choice";c.result={response:b.selectedOption.meta};c=xapiFunctions.buildQuestionInteractionStatement(c);a.parent_element_id&&(c.getStatement().context.contextActivities.parent[0]={id:settings.activityRootURL+
"element/"+(settings.useExternalIdsForScorm?b.scenario.external_id:b.scenario.id)});c.send()}),$(document).on(DKI.ContentPage.events.scenarioEnded,function(a,b){a=b.scene;var c=DKI.clone(q),d=DKI.clone(q);d.display["en-US"]="Ended";playerBehaviour.useExtendedVerbDisplayForAnalytics&&(c=d);var c={verb:c,object:{id:settings.activityRootURL+"element/"+(settings.useExternalIdsForScorm?a.external_id:a.elementid),definition:{name:{"en-US":a.title},description:{"en-US":a.description}},objectType:"Activity"},
context:e(a),result:{score:{scaled:a.parameters.config.weight}}},f=dataStorage.getElement(a.parent_element_id);c.context.contextActivities.parent.unshift({id:settings.activityRootURL+"element/"+(settings.useExternalIdsForScorm?f.external_id:a.parent_element_id)});c.context.extensions={"http://dominknow.com/elementTypes":a.elementtype,"http://dominknow.com/elementTypes/scenario/path":b.path,"http://dominknow.com/xapi/extensions/verbs":d};playerBehaviour.recordInteractions&&contentApi.sendAnalyticsStatement(c)}))},
xapiFunctions=function(){var e=function(a,c){c={verb:verbMap.answered,object:{id:a.activityId?a.activityId:settings.activityRootURL+"question/"+(settings.useExternalIdsForScorm?a.question.external_id:a.id),objectType:"Activity",definition:{name:{"en-US":a.title},description:{"en-US":a.body},type:"http://adlnet.gov/expapi/activities/cmi.interaction"}}};player.inAssessment&&(c.object.definition.extensions={"http://dominknow.com/testMode":dataStorage.assessment.prepost,"http://dominknow.com/attempt":dataStorage.assessment.module[dataStorage.assessment.prepost].attempts});
if(a.context)c.context=a.context;else{var d=dataStorage.findObject(a.question.objectid);""==a.question.objectid&&(d=dataStorage.getSubeoFromPage(a.question.page_id),d=dataStorage.findObject(d.objectid));var e=dataStorage.findModule(d.loid);c.context={contextActivities:{parent:[{id:settings.activityRootURL+"object/"+(settings.useExternalIdsForScorm?d.external_id:d.objectid),definition:{type:"http://adlnet.gov/expapi/activities/objective",name:{"en-US":d.title},description:{"en-US":d.description}}},
{id:settings.activityRootURL+"module/"+(settings.useExternalIdsForScorm?e.external_id:d.loid),definition:{type:"http://adlnet.gov/expapi/activities/module",name:{"en-US":e.name},description:{"en-US":e.description}}}]}}}a.latency&&(c.result={duration:scormTimeFn.ConvertMilliSecondsIntoSCORM2004Time(a.latency)});a.extensions&&(c.context.extensions=a.extensions);return c},a=function(a){return function(c){return{send:function(d){return c&&playerBehaviour.recordInteractions?d?contentApi.sendXAPIStatement(a):
contentApi.sendAnalyticsStatement(a):!1},getStatement:function(){return a}}}(null!==a.object.id)};return{buildGenericInteractionStatement:e,recordTrueFalse:function(b){var c=e(b);c.object.definition.correctResponsesPattern=[b.questionOptions[0].parameters.correct.toString()];c.object.definition.interactionType="true-false";c.result={success:100==b.score,response:1==b.options[0]?"true":"false",score:{scaled:b.score/100}};a(c).send()},recordMultipleChoice:function(b){for(var c=[],d=[],f=[],g=0;g<b.options.length;g++){var k=
dataStorage.getElement(b.questionOptions[g].element_id);f.push({id:settings.useExternalIdsForScorm?k.external_id:k.elementid.toString(),description:{"en-US":b.options[g].text}});1==b.options[g].checked&&c.push(settings.useExternalIdsForScorm?k.external_id:k.elementid.toString());b.questionOptions[g].parameters.correct&&d.push(settings.useExternalIdsForScorm?k.external_id:k.elementid.toString())}g=e(b);g.object.definition.correctResponsesPattern=[d.join("[,]")];g.object.definition.choices=f;g.object.definition.interactionType=
"choice";g.result={success:100==b.score,response:c.join("[,]"),score:{scaled:b.score/100}};a(g).send()},recordFillBlanks:function(b){for(var c=0;c<b.options.length;c++){for(var d=0,f=dataStorage.getElement(b.questionOptions[c].element_id),g=0;g<b.questionOptions[c].parameters.correctValues.length;g++){var k=$.trim(b.options[c].toString().toLowerCase()),l=$.trim(b.questionOptions[c].parameters.correctValues[g].toString().toLowerCase());$.isNumeric(k)&&(k=parseFloat(k),l=parseFloat(l.replace(/\,|\s/g,
"")));if(l===k){d=1;break}}g=e(b);g.object.id=settings.activityRootURL+"element/"+(settings.useExternalIdsForScorm?f.external_id:f.elementid);g.object.definition.name["en-US"]=f.title;g.object.definition.description["en-US"]=f.description;g.object.definition.correctResponsesPattern=[b.questionOptions[c].parameters.correctValues.join("[,]")];g.object.definition.interactionType="fill-in";g.result={success:1==d,response:b.options[c],score:{scaled:d}};g=a(g);g.getStatement().context.contextActivities.parent.unshift({id:settings.activityRootURL+
"question/"+(settings.useExternalIdsForScorm?b.question.external_id:b.id)});g.send()}},recordPulldown:function(b){for(var c=0;c<b.options.length;c++){var d=[],f=0,g=[],k=dataStorage.getElement(b.questionOptions[c].element_id),l="";g[0]=b.questionOptions[c].parameters.correctValue;for(var g=g.concat(b.questionOptions[c].parameters.incorrectValues),m=0;m<g.length;m++)d.push({id:(m+1).toString(),description:{"en-US":g[m].toString().trim()}}),b.options[c].toString().toLowerCase().trim()==g[m].toString().toLowerCase().trim()&&
(0==m&&(f=1),l=(m+1).toString());g=e(b);g.object.id=settings.activityRootURL+"element/"+(settings.useExternalIdsForScorm?k.external_id:k.elementid);g.object.definition.name["en-US"]=k.title;g.object.definition.description["en-US"]=k.description;g.object.definition.correctResponsesPattern=["1"];g.object.definition.choices=d;g.object.definition.interactionType="choice";g.result={success:1==f,response:l,score:{scaled:f}};g=a(g);g.getStatement().context.contextActivities.parent.unshift({id:settings.activityRootURL+
"question/"+(settings.useExternalIdsForScorm?b.question.external_id:b.id)});g.send()}},recordFreeForm:function(b){var c=e(b);c.object.definition.interactionType="long-fill-in";c.result={success:100==b.score,response:b.options[0],score:{scaled:b.score/100}};a(c).send()},recordDragDrop:function(b){var c=[],d={},f=[],g=[],k=b.question.page||dataStorage.findPage(b.question.page_id);$.each(k.groups,function(){$.each(this.elements,function(){if(this.droppable){var a=dataStorage.getElementByDragDropId(this.dragdrop_id);
d[this.dragdrop_id]={id:settings.useExternalIdsForScorm?a.external_id:a.id.toString(),description:{"en-US":a.title}}}})});for(k=0;k<b.options.length;k++){var l=dataStorage.getElement(b.questionOptions[k].element_id);c.push({id:settings.useExternalIdsForScorm?l.external_id:l.elementid.toString(),description:{"en-US":l.title}});if(b.options[k].target.id){var m=dataStorage.getElementByDragDropId(b.options[k].target.id);g.push(settings.useExternalIdsForScorm?l.external_id+"[.]"+m.external_id:l.elementid+
"[.]"+m.elementid)}}$.each(d,function(){f.push(this)});k=e(b);k.object.definition.interactionType="matching";k.object.definition.source=c;k.object.definition.target=f;k.result={success:100==b.score,response:g.join("[,]"),score:{scaled:b.score/100}};a(k).send()},recordCapture:function(b){var c=e(b),d=b.questionOptions[0];c.object.definition.interactionType="other";c.result={success:100==b.score,score:{scaled:b.score/100}};if(d){var d=dataStorage.getElement(d.element_id),f=d.asset_parameters.config.description;
d.asset_parameters.config.hasOwnProperty("sections")&&(""!=d.asset_parameters.config.sections[0].introText?f=d.asset_parameters.config.sections[0].introText:""!=d.asset_parameters.config.sections[0].introduction&&(f=d.asset_parameters.config.sections[0].introduction));c.object.id=settings.activityRootURL+"element/"+(settings.useExternalIdsForScorm?d.external_id:d.id);c.object.definition.name["en-US"]=d.title;c.object.definition.description["en-US"]=$("\x3cdiv /\x3e").html(f).text().trim()}c=a(c);
c.getStatement().context.contextActivities.parent.unshift({id:settings.activityRootURL+"question/"+(settings.useExternalIdsForScorm?b.question.external_id:b.id),definition:{name:{"en-US":b.question.title}}});c.send()},recordImageMap:function(b,c){var d=e(b),f=b.questionOptions[0];d.object.definition.interactionType="other";d.result={success:100==b.score,score:{scaled:b.score/100}};f&&(f=dataStorage.getElement(f.element_id),d.object.definition.correctResponsesPattern=f.elements.reduce(function(a,b){b.parameters.config.map.distractor||
a.push("("+b.parameters.config.map.coords+")");return a},[]),c=c.mapEl.data("dki.ImageMap").answers,d.result.response=c.map(function(a){return"("+a.coords.map(function(a){return Math.round(a)}).join(",")+")"},[]).join("[,]"),d.object.id=settings.activityRootURL+"element/"+(settings.useExternalIdsForScorm?f.external_id:f.id),d.object.definition.name["en-US"]=f.title,""==d.object.definition.description["en-US"]&&(c="",c=""!=f.txt?f.txt:""!=f.asset_description?f.asset_description:""!=f.description?f.description:
f.asset_filename,d.object.definition.description["en-US"]=c));d=a(d);d.getStatement().context.contextActivities.parent.unshift({id:settings.activityRootURL+"question/"+(settings.useExternalIdsForScorm?b.question.external_id:b.id),definition:{name:{"en-US":b.question.title}}});d.send()},recordScenario:function(b,c){var d=e(b),f=b.questionOptions[0];d.object.definition.interactionType="other";d.result={success:100==b.score,score:{scaled:b.score/100}};if(f){var f=dataStorage.getElement(f.element_id),
g="";""!=f.description?g=f.description:""!=f.txt&&(g=f.txt);d.object.id=settings.activityRootURL+"element/"+(settings.useExternalIdsForScorm?f.external_id:f.id);d.object.definition.name["en-US"]=f.title;d.object.definition.description["en-US"]=g;d.context.extensions={"http://dominknow.com/elementTypes":f.elementtype,"http://dominknow.com/elementTypes/scenario/path":c.scenarioEl.data("dki.Scenario").path}}d=a(d);d.getStatement().context.contextActivities.parent.unshift({id:settings.activityRootURL+
"question/"+(settings.useExternalIdsForScorm?b.question.external_id:b.id),definition:{name:{"en-US":b.question.title}}});d.send()},recordMatchingQuestion:function(b,c){var d=e(b);c=c.matchEl.data("dki.MatchingQuestion").getxAPICompleteData();var f=[],g=[],k=function(a){a=a.meta?DKI.stripHTML(a.meta):a.asset_title;return 100<a.length?a.substring(0,100)+"...":a};$.each(c.sources,function(){f.push({id:settings.useExternalIdsForScorm?this.external_id:this.id.toString(),description:{"en-US":k(this)}})});
$.each(c.targets,function(){g.push({id:settings.useExternalIdsForScorm?this.outline.external_id:this.outline.id.toString(),description:{"en-US":k(this.outline)}})});d.object.definition.interactionType="matching";d.object.definition.source=f;d.object.definition.target=g;d.result={success:100==b.score,response:c.givenAnswerPattern,score:{scaled:b.score/100}};a(d).send()},recordSequencing:function(b,c){c=c.sequenceEl.data("dki.SequencingQuestion").getxAPICompleteData();var d=e(b);d.object.definition.correctResponsesPattern=
[c.correctOrder.join("[,]")];d.object.definition.choices=c.choices.map(function(a){return{id:settings.useExternalIdsForScorm?a.external_id:a.id.toString(),description:{"en-US":a.upload_id?a.meta||a.txt||a.asset_title:DKI.stripHTML(a.meta)}}});d.object.definition.interactionType="sequencing";d.result={success:100==b.score,response:c.responseOrder.join("[,]"),score:{scaled:b.score/100}};d=a(d);d.getStatement().context.contextActivities.parent.unshift({id:settings.activityRootURL+"question/"+(settings.useExternalIdsForScorm?
b.question.external_id:b.id),definition:{name:{"en-US":b.question.title}}});d.send()},recordFillInTheBlanksWidget:function(b,c){var d=c.questionEl.data("dki.FillInTheBlanksQuestion").getScoringDetails(),f={};dataStorage.getElement(b.questionOptions[0].elementId).elements.forEach(function(a){f[a.elementid]=a});c=[];for(var g=[],k=[],l=0;l<d.optionEls.length;l++){var m=f[d.optionEls[l]],q=d.selected[l],u=d.correct[l];k.push({id:settings.useExternalIdsForScorm?m.external_id:m.elementid.toString(),description:{"en-US":m.meta}});
c.push(q);g.push(u)}d=e(b);d.object.definition.correctResponsesPattern=[g.join("[,]")];d.object.definition.choices=k;d.object.definition.interactionType="fill-in";d.result={success:100==b.score,response:c.join("[,]"),score:{scaled:b.score/100}};d=a(d);d.getStatement().context.contextActivities.parent.unshift({id:settings.activityRootURL+"question/"+(settings.useExternalIdsForScorm?b.question.external_id:b.id),definition:{name:{"en-US":b.question.title}}});d.send()},buildQuestionInteractionStatement:a}}(),
scormTimeFn=function(){var e=0,a=new Date,b=null;return{GetSessionAccumulatedTime:function(){b=new Date;null!=b&&null!=a&&(e+=b.getTime()-a.getTime());null!=a&&(a=new Date);b=null;return e},ConvertMilliSecondsIntoSCORM2004Time:function(a){var b="",e,g,k,l,m,q;a=Math.floor(a/10);q=Math.floor(a/315576E4);a-=315576E4*q;m=Math.floor(a/26298E4);a-=26298E4*m;l=Math.floor(a/864E4);a-=864E4*l;k=Math.floor(a/36E4);a-=36E4*k;g=Math.floor(a/6E3);a-=6E3*g;e=Math.floor(a/100);a-=100*e;0<q&&(b+=q+"Y");0<m&&(b+=
m+"M");0<l&&(b+=l+"D");0<a+e+g+k&&(b+="T",0<k&&(b+=k+"H"),0<g&&(b+=g+"M"),0<a+e&&(b+=e,0<a&&(b+="."+a),b+="S"));""==b&&(b="T0S");return"P"+b}}}();
xAPIFunctions={getActor:function(e){playerBehaviour.anonymizeAnalyticsUser||"N/A"==e?(e=Cookies.get("dki_xapiActor"),e||(e="actor_"+Math.random().toString(36).substring(6),Cookies.set("dki_xapiActor",e)),e={objectType:"Agent",account:{homePage:"http://www.dominknow.com",name:e}}):e=DKI.utility.isValidEmail(e)?{objectType:"Agent",mbox:e}:{objectType:"Agent",account:{homePage:window.location.protocol+"//"+document.domain,name:e}};return e}};